<!doctype html>
<html lang="zh-Hans" dir="ltr" class="blog-wrapper blog-list-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">Blog title | å°è½¦çš„å°ä¹¦å±‹</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://hbche.github.io/my-website/img/homepage-bg-main.png"><meta data-rh="true" name="twitter:image" content="https://hbche.github.io/my-website/img/homepage-bg-main.png"><meta data-rh="true" property="og:url" content="https://hbche.github.io/my-website/blog"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="keywords" content="hanbin, frontend, react, angular, javascript, css"><meta data-rh="true" property="og:title" content="Blog title | å°è½¦çš„å°ä¹¦å±‹"><meta data-rh="true" name="description" content="Blog"><meta data-rh="true" property="og:description" content="Blog"><meta data-rh="true" name="docusaurus_tag" content="blog_posts_list"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_posts_list"><link data-rh="true" rel="icon" href="/my-website/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://hbche.github.io/my-website/blog"><link data-rh="true" rel="alternate" href="https://hbche.github.io/my-website/blog" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://hbche.github.io/my-website/blog" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/my-website/blog/rss.xml" title="å°è½¦çš„å°ä¹¦å±‹ RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/my-website/blog/atom.xml" title="å°è½¦çš„å°ä¹¦å±‹ Atom Feed">



<link rel="alternate" type="application/rss+xml" href="/my-website/books/rss.xml" title="å°è½¦çš„å°ä¹¦å±‹ RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/my-website/books/atom.xml" title="å°è½¦çš„å°ä¹¦å±‹ Atom Feed"><link rel="stylesheet" href="/my-website/assets/css/styles.6b53b9c5.css">
<script src="/my-website/assets/js/runtime~main.255a81ca.js" defer="defer"></script>
<script src="/my-website/assets/js/main.dbb5613a.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="è·³åˆ°ä¸»è¦å†…å®¹"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">è·³åˆ°ä¸»è¦å†…å®¹</a></div><nav aria-label="ä¸»å¯¼èˆª" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="åˆ‡æ¢å¯¼èˆªæ " aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/my-website/"><div class="navbar__logo"><img src="/my-website/img/logo.svg" alt="å°è½¦çš„å°ä¹¦å±‹" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/my-website/img/logo.svg" alt="å°è½¦çš„å°ä¹¦å±‹" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">å°è½¦çš„å°ä¹¦å±‹</b></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">ğŸ“– å­¦ä¹ è®°å½•</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/my-website/zustand">Zustandå­¦ä¹ è®°å½•</a></li><li><a class="dropdown__link" href="/my-website/redux">Reduxå­¦ä¹ è®°å½•</a></li><li><a class="dropdown__link" href="/my-website/python">Pythonå­¦ä¹ è®°å½•</a></li></ul></div><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/my-website/blog">ğŸ“„ åšå®¢</a><a class="navbar__item navbar__link" href="/my-website/books">âœ è¯»ä¹¦</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">ğŸ“š ç»´åŸº</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/my-website/algorithm">ç®—æ³•</a></li><li><a class="dropdown__link" href="/my-website/frontend">å‰ç«¯</a></li><li><a class="dropdown__link" href="/my-website/backend">æœåŠ¡ç«¯</a></li><li><a class="dropdown__link" href="/my-website/database">æ•°æ®åº“</a></li><li><a class="dropdown__link" href="/my-website/embedded">åµŒå…¥å¼</a></li><li><a class="dropdown__link" href="/my-website/devops">DevOps</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">ğŸ‘¨â€ğŸ’» èŒä¸š</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/my-website/roadmap">æ±‚èŒä¹‹è·¯</a></li></ul></div><a class="navbar__item navbar__link" href="/my-website/journal">ğŸ“½ï¸ æ—¥å¿—</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/hbche/my-website/tree/main" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="åˆ‡æ¢æµ…è‰²/æš—é»‘æ¨¡å¼ï¼ˆå½“å‰ä¸ºæš—é»‘æ¨¡å¼ï¼‰" aria-label="åˆ‡æ¢æµ…è‰²/æš—é»‘æ¨¡å¼ï¼ˆå½“å‰ä¸ºæš—é»‘æ¨¡å¼ï¼‰" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="æœ€è¿‘åšæ–‡å¯¼èˆª"><div class="sidebarItemTitle_pO2u margin-bottom--md">è¿‘æœŸåšå®¢</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/my-website/blog/2025/06/06/image-to-base64">å¦‚ä½•å°†ä¸€ä¸ªImageèŠ‚ç‚¹è½¬æ¢æˆbase64ç¼–ç å­—ç¬¦ä¸²</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/my-website/blog/2025/06/06/markdown-syntax-guide">Markdown è¯­æ³•å®Œæ•´æŒ‡å—</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/my-website/blog/2025/06/05/prosemirror-primary-guide">ProseMirror å…¥é—¨æŒ‡å—</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/my-website/blog/2023/10/27/character-encoding">è®¡ç®—æœºä¸­çš„å­—ç¬¦ç¼–ç </a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/my-website/blog/2023/10/27/webpack-target">Webpack å­¦ä¹ è·¯çº¿å’Œç›®æ ‡</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/my-website/blog/2023/10/24/rust-generic-types_traits_lifetimes">Rust æ³›å‹traitä¸ç”Ÿå‘½å‘¨æœŸ</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/my-website/blog/2023/10/26/rust-package-crate-module">Rust ä½¿ç”¨åŒ…ã€Crateå’Œæ¨¡å—ç®¡ç†ä¸æ–­å¢é•¿çš„é¡¹ç›®</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/my-website/blog/2023/10/23/rust-collections">Rust å¸¸è§é›†åˆ</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/my-website/blog/2023/10/19/rust-enum-pattern-matching">Rust æšä¸¾å’Œæ¨¡å¼åŒ¹é…</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/my-website/blog/2023/10/18/rust-structure">Rust ä½¿ç”¨ç»“æ„ä½“ç»„ç»‡å…³è”æ•°æ®</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/my-website/blog/2023/10/09/rust-ownership">Rust è®¤è¯†æ‰€æœ‰æƒ</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/my-website/blog/2023/10/08/ieee-754">IEEE-754æ ‡å‡†</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/my-website/blog/2023/10/08/rust-basic">Rust é€šç”¨ç¼–ç¨‹æ¦‚å¿µ</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/my-website/blog/2023/09/26/rust-install">Rust ç¯å¢ƒå®‰è£…</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/my-website/blog/2023/09/08/deploy-docusaurus">é€šè¿‡ Github Actions éƒ¨ç½² docusaurus åˆ›å»ºçš„é™æ€ç½‘ç«™</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/my-website/blog/2023/09/04/nvm-tutorial">NVM æ•™ç¨‹</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/my-website/blog/2023/06/13/react-hooks-best-practices">React Hooks æœ€ä½³å®è·µï¼šé‡Šæ”¾æ•ˆç‡ä¸ä¼˜é›…</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="https://schema.org/Blog"><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="ç¼–ç¨‹å°æŠ€å·§"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/my-website/blog/2025/06/06/image-to-base64">å¦‚ä½•å°†ä¸€ä¸ªImageèŠ‚ç‚¹è½¬æ¢æˆbase64ç¼–ç å­—ç¬¦ä¸²</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2026-06-06T00:00:00.000Z" itemprop="datePublished">2026å¹´6æœˆ6æ—¥</time> Â· <!-- -->é˜…è¯»éœ€ 3 åˆ†é’Ÿ</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/hbche" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/hbche.png" alt="Hanbin Che" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/hbche" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Hanbin Che</span></a></div><small class="avatar__subtitle" itemprop="description">Front End Engineer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>æœ€è¿‘åœ¨å­¦ä¹  markwodn è¯­æ³•ï¼Œåœ¨ç¼–å†™ markdown è¯­æ³•æŒ‡å—æ—¶ï¼Œé‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘æƒ³å†™ä¸€ä¸ª
md æ•™ç¨‹ï¼Œå…¶ä¸­éœ€è¦æ¼”ç¤º image çš„è¯­æ³•ï¼ŒåŒæ—¶éœ€è¦å±•ç¤º markdown æ¸²æŸ“åçš„æ•ˆæœï¼Œä½†
æ˜¯<a href="https://commonmark.org/help/" target="_blank" rel="noopener noreferrer">commonmark</a>ç½‘ç«™ä¸­å±•ç¤º image çš„æ•ˆæœæ˜¯ä¸€å¼  png å›¾
ç‰‡ï¼Œæˆ‘æƒ³å°†å…¶è½¬æ¢æˆ base64 ç¼–ç å­—ç¬¦ä¸²ï¼Œä»¥ä¾¿åœ¨æˆ‘çš„ md ä¸­èƒ½å¤Ÿä½¿ç”¨ã€‚äºæ˜¯èŒç”Ÿäº†ä¸€ä¸ªæƒ³
æ³•ï¼š<code>å¦‚ä½•å°†ä¸€ä¸ªImageèŠ‚ç‚¹è½¬æ¢æˆbase64ç¼–ç å­—ç¬¦ä¸²ï¼Ÿ</code></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="å®ç°æ–¹æ¡ˆ">å®ç°æ–¹æ¡ˆ<a href="#å®ç°æ–¹æ¡ˆ" class="hash-link" aria-label="å®ç°æ–¹æ¡ˆçš„ç›´æ¥é“¾æ¥" title="å®ç°æ–¹æ¡ˆçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="åŸºäº-canvas-è½¬æ¢">åŸºäº Canvas è½¬æ¢<a href="#åŸºäº-canvas-è½¬æ¢" class="hash-link" aria-label="åŸºäº Canvas è½¬æ¢çš„ç›´æ¥é“¾æ¥" title="åŸºäº Canvas è½¬æ¢çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>å€ŸåŠ© <code>canvas</code> å®Œæˆè½¬æ¢ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">transformBase64ByCanvas</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">img</span><span class="token operator">:</span><span class="token plain"> HTMLImageElement</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> canvas </span><span class="token operator">=</span><span class="token plain"> document</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">createElement</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;canvas&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">canvas</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">width </span><span class="token operator">=</span><span class="token plain"> img</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">naturalWidth</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">canvas</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">height </span><span class="token operator">=</span><span class="token plain"> img</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">naturalHeight</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> ctx </span><span class="token operator">=</span><span class="token plain"> canvas</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">getContext</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;2d&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">drawImage</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">img</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> base64 </span><span class="token operator">=</span><span class="token plain"> canvas</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">toDataURL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;image/png&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> base64</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="åŸºäº-filereader-è½¬æ¢">åŸºäº FileReader è½¬æ¢<a href="#åŸºäº-filereader-è½¬æ¢" class="hash-link" aria-label="åŸºäº FileReader è½¬æ¢çš„ç›´æ¥é“¾æ¥" title="åŸºäº FileReader è½¬æ¢çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>å€ŸåŠ© <code>&lt;input type=&quot;file&quot; /&gt;</code> å’Œ <code>FileReader</code> è¿›è¡Œè½¬æ¢ã€‚</p>
<p>å°†å›¾ç‰‡èµ„æºä¸‹è½½åˆ°æœ¬åœ°ï¼Œåœ¨ç¼–å†™ä¸€ä¸ªä¸Šä¼  demoï¼Œåœ¨ä¸Šä¼ æ§ä»¶çš„ <code>onChange</code> å›è°ƒä¸­æ¥æ”¶å›¾
ç‰‡ï¼Œç„¶åå€ŸåŠ©å¦‚ä¸‹å‡½æ•°å®Œæˆè§£æã€‚</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">transformBase64ByInput</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">img</span><span class="token operator">:</span><span class="token plain"> File</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token operator">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">Promise</span><span class="token operator">&lt;</span><span class="token builtin" style="color:rgb(189, 147, 249)">string</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name builtin" style="color:rgb(189, 147, 249)">Promise</span><span class="token class-name operator">&lt;</span><span class="token class-name builtin" style="color:rgb(189, 147, 249)">string</span><span class="token class-name operator">&gt;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">resolve</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> reject</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// åˆ›å»ºä¸€ä¸ªreaderç”¨äºè¯»å–imgæ–‡ä»¶ï¼Œä¸ºåé¢è½¬æ¢åšå‡†å¤‡</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> reader </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">FileReader</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    reader</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function-variable function" style="color:rgb(80, 250, 123)">onload</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">e</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)">// è¿”å› base64 å­—ç¬¦ä¸²ï¼ˆå« data:image/... å‰ç¼€ï¼‰</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token function" style="color:rgb(80, 250, 123)">resolve</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">e</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">target</span><span class="token operator">?.</span><span class="token plain">result </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">as</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    reader</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function-variable function" style="color:rgb(80, 250, 123)">onerror</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">e</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token function" style="color:rgb(80, 250, 123)">reject</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">e</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    reader</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">readAsDataURL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">img</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="åŸºäº-nodejs-çš„-fs-æ¨¡å—è¿›è¡Œè½¬æ¢">åŸºäº nodejs çš„ fs æ¨¡å—è¿›è¡Œè½¬æ¢<a href="#åŸºäº-nodejs-çš„-fs-æ¨¡å—è¿›è¡Œè½¬æ¢" class="hash-link" aria-label="åŸºäº nodejs çš„ fs æ¨¡å—è¿›è¡Œè½¬æ¢çš„ç›´æ¥é“¾æ¥" title="åŸºäº nodejs çš„ fs æ¨¡å—è¿›è¡Œè½¬æ¢çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>å€ŸåŠ© nodejs çš„ fs æ¨¡å—ï¼Œåœ¨è¯»å–æ–‡ä»¶æ—¶ï¼Œå®Œæˆæ•°æ®è½¬æ¢</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> fs </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">require</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;fs/promises&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> path </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">require</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;path&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">transformBase64ByNode</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">imageName</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> imgPath </span><span class="token operator">=</span><span class="token plain"> path</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">join</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">__dirname</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> imageName</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> fs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">readFile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">imgPath</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;base64&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">then</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">base64</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:rgb(255, 121, 198)">`</span><span class="token template-string string" style="color:rgb(255, 121, 198)">data:image/png;base64,</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(248, 248, 242)">${</span><span class="token template-string interpolation">base64</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token template-string template-punctuation string" style="color:rgb(255, 121, 198)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">transformBase64ByNode</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;markdown.png&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">then</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token console class-name">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="é—®é¢˜å›é¡¾">é—®é¢˜å›é¡¾<a href="#é—®é¢˜å›é¡¾" class="hash-link" aria-label="é—®é¢˜å›é¡¾çš„ç›´æ¥é“¾æ¥" title="é—®é¢˜å›é¡¾çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>åœ¨å°è¯•å„ç§æ–¹æ¡ˆä¹‹åï¼Œå‘ç°æ–¹æ¡ˆ 1 æ— æ³•å®ç°ï¼Œæ–¹æ¡ˆ 1 çš„ demo å¦‚ä¸‹ï¼›</p>
<div class="language-tsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-tsx codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">ImagePick</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> imgRef </span><span class="token operator">=</span><span class="token plain"> </span><span class="token generic-function function" style="color:rgb(80, 250, 123)">useRef</span><span class="token generic-function generic class-name operator">&lt;</span><span class="token generic-function generic class-name">HTMLImageElement</span><span class="token generic-function generic class-name operator">&gt;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">null</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token function" style="color:rgb(80, 250, 123)">useEffect</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">imgRef</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">current</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> img </span><span class="token operator">=</span><span class="token plain"> imgRef</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">current</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> base64 </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">transformBase64ByCanvas</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">img</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token console class-name">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">base64</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">div</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain-text">      </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">img</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">src</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&#x27;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">https://commonmark.org/help/images/favicon.png</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&#x27;</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">ref</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token tag script language-javascript punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token tag script language-javascript" style="color:rgb(255, 121, 198)">imgRef</span><span class="token tag script language-javascript punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">/&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">div</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">default</span><span class="token plain"> </span><span class="token maybe-class-name">ImagePick</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å®é™…æ‹¿åˆ°çš„ base64 æ˜¯ä¸€ä¸ªç©ºå­—ç¬¦ä¸² <code>data:,</code>ï¼Œé€šè¿‡æŸ¥è¯¢å‘ç°æ˜¯å› ä¸ºæµè§ˆå™¨åŠ è½½ç½‘ç»œå›¾ç‰‡
å­˜åœ¨è·¨åŸŸé—®é¢˜ï¼Œæµè§ˆå™¨å¤„äºå®‰å…¨æ€§è€ƒè™‘ï¼Œé˜»æ­¢äº†è¯»å–ç”»å¸ƒçš„åƒç´ å†…å®¹ã€‚å¯æŒ‰ç…§å¦‚ä¸‹æ–¹å¼ä¿®æ”¹
ï¼š</p>
<div class="language-tsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-tsx codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token imports"> useEffect </span><span class="token imports punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;react&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">transformBase64ByCanvas</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">img</span><span class="token operator">:</span><span class="token plain"> </span><span class="token maybe-class-name">HTMLImageElement</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> canvas </span><span class="token operator">=</span><span class="token plain"> </span><span class="token dom variable" style="color:rgb(189, 147, 249);font-style:italic">document</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">createElement</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;canvas&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  canvas</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">width</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> img</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">naturalWidth</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  canvas</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">height</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> img</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">naturalHeight</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> ctx </span><span class="token operator">=</span><span class="token plain"> canvas</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">getContext</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;2d&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ctx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">drawImage</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">img</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> base64 </span><span class="token operator">=</span><span class="token plain"> canvas</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">toDataURL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;image/png&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> base64</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">ImagePick</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token function" style="color:rgb(80, 250, 123)">useEffect</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> image </span><span class="token operator">=</span><span class="token plain"> </span><span class="token dom variable" style="color:rgb(189, 147, 249);font-style:italic">document</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">getElementById</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;myImage&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">as</span><span class="token plain"> </span><span class="token maybe-class-name">HTMLImageElement</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    image</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">crossOrigin</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Anonymous&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    image</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">src</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;https://commonmark.org/help/images/favicon.png&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    image</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method-variable function-variable method function property-access" style="color:rgb(80, 250, 123)">onload</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> base64 </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">transformBase64ByCanvas</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">image</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token console class-name">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">base64</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">div</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain-text">      </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">img</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">id</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&#x27;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">myImage</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&#x27;</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">/&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">div</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">default</span><span class="token plain"> </span><span class="token maybe-class-name">ImagePick</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æŒ‰ç…§ä¸Šè¿°æ–¹æ³•è®¾ç½® img å…ƒç´ çš„ <code>crossOrigin</code> ä¸º <code>Anonymous</code> å³å¯è§£å†³è·¨åŸŸé—®é¢˜ï¼Œå°±èƒ½
æ­£å¸¸è§£æã€‚</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="æ³¨æ„äº‹é¡¹">æ³¨æ„äº‹é¡¹<a href="#æ³¨æ„äº‹é¡¹" class="hash-link" aria-label="æ³¨æ„äº‹é¡¹çš„ç›´æ¥é“¾æ¥" title="æ³¨æ„äº‹é¡¹çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<ul>
<li>
<p>è·¨åŸŸå›¾ç‰‡ï¼ˆå¦‚ CDN å›¾ï¼‰å¿…é¡»è®¾ç½® <code>img.crossOrigin = &#x27;anonymous&#x27;</code> ä¸”æœåŠ¡å™¨æ”¯æŒ
CORSï¼Œå¦åˆ™æ— æ³•ç”»è¿› canvasã€‚</p>
</li>
<li>
<p>å¤§å›¾è½¬æ¢ä¸º Base64 åä½“ç§¯è¾ƒå¤§ï¼Œä¸å»ºè®®åµŒå…¥å¤§å‹å›¾ç‰‡ã€‚</p>
</li>
<li>
<p>å¯ä»¥å°† <code>toDataURL()</code> ä¼ å…¥ä¸åŒç±»å‹å‚æ•°ç”Ÿæˆ <code>image/jpeg</code>ã€<code>image/webp</code> ç­‰æ ¼å¼ã€‚</p>
</li>
</ul></div><footer class="row docusaurus-mt-lg"><div class="col"><b>æ ‡ç­¾ï¼š</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/my-website/blog/tags/å‰ç«¯">å‰ç«¯</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/my-website/blog/tags/å·¥å…·">å·¥å…·</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="ç¼–ç¨‹å°æŠ€å·§"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/my-website/blog/2025/06/06/markdown-syntax-guide">Markdown è¯­æ³•å®Œæ•´æŒ‡å—</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2026-06-06T00:00:00.000Z" itemprop="datePublished">2026å¹´6æœˆ6æ—¥</time> Â· <!-- -->é˜…è¯»éœ€ 4 åˆ†é’Ÿ</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/hbche" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/hbche.png" alt="Hanbin Che" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/hbche" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Hanbin Che</span></a></div><small class="avatar__subtitle" itemprop="description">Front End Engineer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="ä»€ä¹ˆæ˜¯-markdown">ä»€ä¹ˆæ˜¯ Markdownï¼Ÿ<a href="#ä»€ä¹ˆæ˜¯-markdown" class="hash-link" aria-label="ä»€ä¹ˆæ˜¯ Markdownï¼Ÿçš„ç›´æ¥é“¾æ¥" title="ä»€ä¹ˆæ˜¯ Markdownï¼Ÿçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p><strong>Markdown</strong> æ˜¯ä¸€ç§ç®€å•çš„æ–‡æœ¬æ ¼å¼åŒ–æ–¹å¼ï¼Œåœ¨ä»»ä½•è®¾å¤‡ä¸Šéƒ½èƒ½å‘ˆç°å‡ºè‰²çš„æ•ˆæœã€‚å®ƒä¸ä¼š
åšä»»ä½•èŠ±å“¨çš„äº‹æƒ…ï¼Œæ¯”å¦‚æ”¹å˜å­—ä½“å¤§å°ã€é¢œè‰²æˆ–ç±»å‹â€”â€”åªæ˜¯ä½¿ç”¨ä½ å·²ç»çŸ¥é“çš„é”®ç›˜ç¬¦å·æ¥å¤„
ç†åŸºæœ¬æ ¼å¼ã€‚</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="åŸºç¡€è¯­æ³•">åŸºç¡€è¯­æ³•<a href="#åŸºç¡€è¯­æ³•" class="hash-link" aria-label="åŸºç¡€è¯­æ³•çš„ç›´æ¥é“¾æ¥" title="åŸºç¡€è¯­æ³•çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<table><thead><tr><th>ç±»å‹</th><th>æˆ–è€…</th><th>æ•ˆæœ</th></tr></thead><tbody><tr><td><code>*æ–œä½“*</code></td><td><code>_æ–œä½“_</code></td><td><em>æ–œä½“</em></td></tr><tr><td><code>**ç²—ä½“**</code></td><td><code>__ç²—ä½“__</code></td><td><strong>ç²—ä½“</strong></td></tr><tr><td><code># ä¸€çº§æ ‡é¢˜</code></td><td><code>ä¸€çº§æ ‡é¢˜</code><br><code>=========</code></td><td># ä¸€çº§æ ‡é¢˜</td></tr><tr><td><code>## äºŒçº§æ ‡é¢˜</code></td><td><code>äºŒçº§æ ‡é¢˜</code><br><code>---------</code></td><td>## äºŒçº§æ ‡é¢˜</td></tr><tr><td><code>[é“¾æ¥](http://a.com)</code></td><td><code>[é“¾æ¥][1]</code><br><code>â‹®</code><br><code>[1]: http://b.org</code></td><td><a href="http://a.com" target="_blank" rel="noopener noreferrer">é“¾æ¥</a></td></tr><tr><td><code>![å›¾ç‰‡](http://url/a.png)</code></td><td><code>![å›¾ç‰‡][1]</code><br><code>â‹®</code><br><code>[1]: http://url/b.jpg</code></td><td><img decoding="async" loading="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJAAAACQCAQAAABNTyozAAAEDklEQVR4Ae3cY3QDjRaG0V1e27Zt27Zt27Ztf7Zt27Zt10jOdZtZzbSN2q41533+tsFO4zRi0TKRJVACJdDiJVACJVACJVACZQmUQAmUQAmUQAmUQFkCJVACJVACJVACJVDWuD7P8icnGRcVbdyJ/uRZ+jTZYxwq/lN2qMcozvtMibmySe/TsPeqi0JZ3XsAHm1SZAua9CjgoMQo6UB4uiim5gbXV7Ab1EQxT+P3RRw/dHtV3e39UL3g8XuOEw39QNX3g4LHcYwU/n5uo+q7beGKNqLwJ3U1cteKuepEQ1cid03BJIESKIESKIESKIESaIkl0I3dv7Q7a293c//ShrWym7l/abdbGaCnidJGPFzre6opUdqDtLJXitJ+svpA4Uy30dru6hJRHaCws37L37CDRbWAwvctf38S1QOqe43l7f2iikDheg+x9J5ksqpA4TS3svju5CJRXaCwvX7lG3KAqDZQ+Jby/U4kUM0rNN+7hAQSrvNAC/c4Ewn0/052C8Xd0fkigebbRp/5DdpHJFCxr5nfr4QEUqzmJYC3iQRq1jXuj8cYT6CyTnAv54oEKm9EJFBnJVAC7eoS0XJn2r8qQP/wNFOipUY8wvbVAeIjooXq3ki1gPhHC0A/oWWgQZ/37ZI2FaUdVPpb33LHlQS6scPFstrDQBtAvEpNdLEfsZJA3N3lYsnOcTvaAuKzomttqW+lgXimabFoYx5N20D8SXSlw9yElQfiE0J5dW+lI6BBu4uOO8+dWB0g1hel/YIOgbiVE0VHXefhrB7QTRwtmra3gS4AcW+Xibab8SJWE4h7uaLpn/Ud6AoQTzIu2uzDrDYQzzUjCo17HF0D4g3qoo1+yWoCld8hv5OuAvFl0XLb6V8rQGws5votXQfqs45oqaPdjLUDdNO5f7Xa32APgBhu6b2SC92VtQTEfVwlXOhO9ASI2zhNLKsRj2atAfFCo55Iz4C4nyvFks16OWsRiPvQUyCeblIs0adYq0B6DsTb1EV5fk+1gfiWKG0XAwnUZyPRtOPdggTiRg4UC7rEPUkg4PbOFIXGPIEEmt+DCmeu5rUkUHHPaXj76Qsk0MK9R/ynv5FAzfdDYS9Da+n/xe6ovd2lS/8vVlyfH7o1vQLKJVACJVACJVACJVACIYGW/A6z/A6zG8RcNbdT9d1eTcx1A8eKhn6s6vtxweNYfisaqvupu+jXV8H63cXP1Asev+Wpopi6aVMVbFpdFPMUlP6jdrY/8AgTYkHZhEcAvFNdFMpq3qFh78y/okIT3qk4j8zborn290hN91S/c6zrzapVsFnXO9bvPFXjYtEykSVQAnVUAiVQAiVQAiVQAiVQlkAJlEAJlEAJlEAJlCVQAiVQAiVQAiVQAmX/BMHb3CdNrgcrAAAAAElFTkSuQmCC" alt="å›¾ç‰‡" title="markdown" class="img_ev3q"></td></tr><tr><td><code>&gt; å¼•ç”¨å—</code></td><td></td><td><blockquote>å¼•ç”¨å—</blockquote></td></tr><tr><td><code>* åˆ—è¡¨</code><br><code>* åˆ—è¡¨</code><br><code>* åˆ—è¡¨</code></td><td><code>- åˆ—è¡¨</code><br><code>- åˆ—è¡¨</code><br><code>- åˆ—è¡¨</code></td><td>â€¢ åˆ—è¡¨<br>â€¢ åˆ—è¡¨<br>â€¢ åˆ—è¡¨</td></tr><tr><td><code>1. ç¬¬ä¸€é¡¹</code><br><code>2. ç¬¬äºŒé¡¹</code><br><code>3. ç¬¬ä¸‰é¡¹</code></td><td><code>1) ç¬¬ä¸€é¡¹</code><br><code>2) ç¬¬äºŒé¡¹</code><br><code>3) ç¬¬ä¸‰é¡¹</code></td><td>1. ç¬¬ä¸€é¡¹<br>2. ç¬¬äºŒé¡¹<br>3. ç¬¬ä¸‰é¡¹</td></tr><tr><td><code>æ°´å¹³åˆ†å‰²çº¿:</code><br><code>---</code></td><td><code>æ°´å¹³åˆ†å‰²çº¿:</code><br><code>***</code></td><td>æ°´å¹³åˆ†å‰²çº¿:<br><hr></td></tr><tr><td><code> `å†…è”ä»£ç ` ä½¿ç”¨åå¼•å·</code></td><td></td><td><code>å†…è”ä»£ç </code> ä½¿ç”¨åå¼•å·</td></tr><tr><td><code>&lt;br /&gt;```&lt;br /&gt;# ä»£ç å—&lt;br /&gt;print &#x27;3ä¸ªåå¼•å·æˆ–&#x27;&lt;br /&gt;print &#x27;ç¼©è¿›4ä¸ªç©ºæ ¼&#x27;&lt;br /&gt;```&lt;br /&gt;</code></td><td><code>Â·Â·Â·Â·# ä»£ç å—</code><br><code>Â·Â·Â·Â·print &#x27;3ä¸ªåå¼•å·æˆ–&#x27;</code><br><code>Â·Â·Â·Â·print &#x27;ç¼©è¿›4ä¸ªç©ºæ ¼&#x27;</code></td><td><code>&lt;br /&gt;# ä»£ç å—&lt;br /&gt;print &#x27;3ä¸ªåå¼•å·æˆ–&#x27;&lt;br /&gt;print &#x27;ç¼©è¿›4ä¸ªç©ºæ ¼&#x27;&lt;br /&gt;</code></td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="æ‰©å±•è¯­æ³•">æ‰©å±•è¯­æ³•<a href="#æ‰©å±•è¯­æ³•" class="hash-link" aria-label="æ‰©å±•è¯­æ³•çš„ç›´æ¥é“¾æ¥" title="æ‰©å±•è¯­æ³•çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="è¡¨æ ¼">è¡¨æ ¼<a href="#è¡¨æ ¼" class="hash-link" aria-label="è¡¨æ ¼çš„ç›´æ¥é“¾æ¥" title="è¡¨æ ¼çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<div class="language-markdown codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-markdown codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token table table-header-row punctuation" style="color:rgb(248, 248, 242)">|</span><span class="token table table-header-row table-header important"> å·¦å¯¹é½ </span><span class="token table table-header-row punctuation" style="color:rgb(248, 248, 242)">|</span><span class="token table table-header-row table-header important"> å±…ä¸­å¯¹é½ </span><span class="token table table-header-row punctuation" style="color:rgb(248, 248, 242)">|</span><span class="token table table-header-row table-header important"> å³å¯¹é½ </span><span class="token table table-header-row punctuation" style="color:rgb(248, 248, 242)">|</span><span class="token table table-header-row"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token table table-header-row"></span><span class="token table table-line punctuation" style="color:rgb(248, 248, 242)">|</span><span class="token table table-line"> </span><span class="token table table-line punctuation" style="color:rgb(248, 248, 242)">:-----</span><span class="token table table-line"> </span><span class="token table table-line punctuation" style="color:rgb(248, 248, 242)">|</span><span class="token table table-line"> </span><span class="token table table-line punctuation" style="color:rgb(248, 248, 242)">:------:</span><span class="token table table-line"> </span><span class="token table table-line punctuation" style="color:rgb(248, 248, 242)">|</span><span class="token table table-line"> </span><span class="token table table-line punctuation" style="color:rgb(248, 248, 242)">-----:</span><span class="token table table-line"> </span><span class="token table table-line punctuation" style="color:rgb(248, 248, 242)">|</span><span class="token table table-line"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token table table-line"></span><span class="token table table-data-rows punctuation" style="color:rgb(248, 248, 242)">|</span><span class="token table table-data-rows table-data"> å†…å®¹   </span><span class="token table table-data-rows punctuation" style="color:rgb(248, 248, 242)">|</span><span class="token table table-data-rows table-data">   å†…å®¹   </span><span class="token table table-data-rows punctuation" style="color:rgb(248, 248, 242)">|</span><span class="token table table-data-rows table-data">   å†…å®¹ </span><span class="token table table-data-rows punctuation" style="color:rgb(248, 248, 242)">|</span><span class="token table table-data-rows"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token table table-data-rows"></span><span class="token table table-data-rows punctuation" style="color:rgb(248, 248, 242)">|</span><span class="token table table-data-rows table-data"> å†…å®¹   </span><span class="token table table-data-rows punctuation" style="color:rgb(248, 248, 242)">|</span><span class="token table table-data-rows table-data">   å†…å®¹   </span><span class="token table table-data-rows punctuation" style="color:rgb(248, 248, 242)">|</span><span class="token table table-data-rows table-data">   å†…å®¹ </span><span class="token table table-data-rows punctuation" style="color:rgb(248, 248, 242)">|</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æ•ˆæœï¼š</p>
<table><thead><tr><th style="text-align:left">å·¦å¯¹é½</th><th style="text-align:center">å±…ä¸­å¯¹é½</th><th style="text-align:right">å³å¯¹é½</th></tr></thead><tbody><tr><td style="text-align:left">å†…å®¹</td><td style="text-align:center">å†…å®¹</td><td style="text-align:right">å†…å®¹</td></tr><tr><td style="text-align:left">å†…å®¹</td><td style="text-align:center">å†…å®¹</td><td style="text-align:right">å†…å®¹</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="åˆ é™¤çº¿">åˆ é™¤çº¿<a href="#åˆ é™¤çº¿" class="hash-link" aria-label="åˆ é™¤çº¿çš„ç›´æ¥é“¾æ¥" title="åˆ é™¤çº¿çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<div class="language-markdown codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-markdown codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token strike punctuation" style="color:rgb(248, 248, 242)">~~</span><span class="token strike content">åˆ é™¤çš„æ–‡æœ¬</span><span class="token strike punctuation" style="color:rgb(248, 248, 242)">~~</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æ•ˆæœï¼š<del>åˆ é™¤çš„æ–‡æœ¬</del></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ä»»åŠ¡åˆ—è¡¨">ä»»åŠ¡åˆ—è¡¨<a href="#ä»»åŠ¡åˆ—è¡¨" class="hash-link" aria-label="ä»»åŠ¡åˆ—è¡¨çš„ç›´æ¥é“¾æ¥" title="ä»»åŠ¡åˆ—è¡¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<div class="language-markdown codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-markdown codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token list punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> [x] å·²å®Œæˆçš„ä»»åŠ¡</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token list punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> [ ] æœªå®Œæˆçš„ä»»åŠ¡</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token list punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> [ ] å¦ä¸€ä¸ªæœªå®Œæˆçš„ä»»åŠ¡</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æ•ˆæœï¼š</p>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled="" checked=""> <!-- -->å·²å®Œæˆçš„ä»»åŠ¡</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->æœªå®Œæˆçš„ä»»åŠ¡</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->å¦ä¸€ä¸ªæœªå®Œæˆçš„ä»»åŠ¡</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="è„šæ³¨">è„šæ³¨<a href="#è„šæ³¨" class="hash-link" aria-label="è„šæ³¨çš„ç›´æ¥é“¾æ¥" title="è„šæ³¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<div class="language-markdown codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-markdown codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">è¿™æ˜¯ä¸€ä¸ªå¸¦è„šæ³¨çš„æ–‡æœ¬[^1]ã€‚</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token url-reference url punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token url-reference url variable" style="color:rgb(189, 147, 249);font-style:italic">^1</span><span class="token url-reference url punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token url-reference url punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token url-reference url"> è¿™æ˜¯è„šæ³¨çš„å†…å®¹ã€‚</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="è½¬ä¹‰å­—ç¬¦">è½¬ä¹‰å­—ç¬¦<a href="#è½¬ä¹‰å­—ç¬¦" class="hash-link" aria-label="è½¬ä¹‰å­—ç¬¦çš„ç›´æ¥é“¾æ¥" title="è½¬ä¹‰å­—ç¬¦çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>å¦‚æœä½ æƒ³æ˜¾ç¤º Markdown è¯­æ³•å­—ç¬¦æœ¬  èº«ï¼Œå¯ä»¥ä½¿ç”¨åæ–œæ è¿›è¡Œè½¬ä¹‰ï¼š</p>
<div class="language-markdown codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-markdown codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">\*è¿™ä¸æ˜¯æ–œä½“\* \# è¿™ä¸æ˜¯æ ‡é¢˜ \[è¿™ä¸æ˜¯é“¾æ¥\]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å¸¸éœ€è¦è½¬ä¹‰çš„å­—ç¬¦ï¼š</p>
<ul>
<li><code>\</code> åæ–œæ </li>
<li><code>`</code> åå¼•å·</li>
<li><code>*</code> æ˜Ÿå·</li>
<li><code>_</code> ä¸‹åˆ’çº¿</li>
<li><code>{}</code> å¤§æ‹¬å·</li>
<li><code>[]</code> æ–¹æ‹¬å·</li>
<li><code>()</code> åœ†æ‹¬å·</li>
<li><code>#</code> äº•å·</li>
<li><code>+</code> åŠ å·</li>
<li><code>-</code> å‡å·</li>
<li><code>.</code> ç‚¹å·</li>
<li><code>!</code> æ„Ÿå¹å·</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="æœ€ä½³å®è·µ">æœ€ä½³å®è·µ<a href="#æœ€ä½³å®è·µ" class="hash-link" aria-label="æœ€ä½³å®è·µçš„ç›´æ¥é“¾æ¥" title="æœ€ä½³å®è·µçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-æ ‡é¢˜å±‚çº§">1. æ ‡é¢˜å±‚çº§<a href="#1-æ ‡é¢˜å±‚çº§" class="hash-link" aria-label="1. æ ‡é¢˜å±‚çº§çš„ç›´æ¥é“¾æ¥" title="1. æ ‡é¢˜å±‚çº§çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<ul>
<li>æ¯ä¸ªæ–‡æ¡£åªä½¿ç”¨ä¸€ä¸ªä¸€çº§æ ‡é¢˜</li>
<li>ä¸è¦è·³è¿‡æ ‡é¢˜å±‚çº§ï¼ˆå¦‚ä» # ç›´æ¥è·³åˆ° ###ï¼‰</li>
<li>æ ‡é¢˜å‰åç•™ç©ºè¡Œ</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-åˆ—è¡¨æ ¼å¼">2. åˆ—è¡¨æ ¼å¼<a href="#2-åˆ—è¡¨æ ¼å¼" class="hash-link" aria-label="2. åˆ—è¡¨æ ¼å¼çš„ç›´æ¥é“¾æ¥" title="2. åˆ—è¡¨æ ¼å¼çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<ul>
<li>åˆ—è¡¨é¡¹å‰åä¿æŒä¸€è‡´çš„ç¼©è¿›</li>
<li>åˆ—è¡¨å‰åç•™ç©ºè¡Œ</li>
<li>åµŒå¥—åˆ—è¡¨ä½¿ç”¨é€‚å½“çš„ç¼©è¿›</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-ä»£ç å—">3. ä»£ç å—<a href="#3-ä»£ç å—" class="hash-link" aria-label="3. ä»£ç å—çš„ç›´æ¥é“¾æ¥" title="3. ä»£ç å—çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<ul>
<li>ä¸ºä»£ç å—æŒ‡å®šè¯­è¨€ä»¥è·å¾—è¯­æ³•é«˜äº®</li>
<li>é•¿ä»£ç å—è€ƒè™‘åˆ†å‰²æˆ–æ·»åŠ æ³¨é‡Š</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-é“¾æ¥">4. é“¾æ¥<a href="#4-é“¾æ¥" class="hash-link" aria-label="4. é“¾æ¥çš„ç›´æ¥é“¾æ¥" title="4. é“¾æ¥çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<ul>
<li>ä½¿ç”¨æè¿°æ€§çš„é“¾æ¥æ–‡æœ¬</li>
<li>å¯¹äºé‡å¤ä½¿ç”¨çš„é“¾æ¥ï¼Œè€ƒè™‘ä½¿ç”¨å¼•ç”¨å¼é“¾æ¥</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-å›¾ç‰‡">5. å›¾ç‰‡<a href="#5-å›¾ç‰‡" class="hash-link" aria-label="5. å›¾ç‰‡çš„ç›´æ¥é“¾æ¥" title="5. å›¾ç‰‡çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<ul>
<li>å§‹ç»ˆæä¾›æœ‰æ„ä¹‰çš„æ›¿ä»£æ–‡æœ¬</li>
<li>è€ƒè™‘å›¾ç‰‡çš„åŠ è½½æ€§èƒ½</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="å·¥å…·æ¨è">å·¥å…·æ¨è<a href="#å·¥å…·æ¨è" class="hash-link" aria-label="å·¥å…·æ¨èçš„ç›´æ¥é“¾æ¥" title="å·¥å…·æ¨èçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="åœ¨çº¿ç¼–è¾‘å™¨">åœ¨çº¿ç¼–è¾‘å™¨<a href="#åœ¨çº¿ç¼–è¾‘å™¨" class="hash-link" aria-label="åœ¨çº¿ç¼–è¾‘å™¨çš„ç›´æ¥é“¾æ¥" title="åœ¨çº¿ç¼–è¾‘å™¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<ul>
<li><a href="https://dillinger.io/" target="_blank" rel="noopener noreferrer">Dillinger</a></li>
<li><a href="https://stackedit.io/" target="_blank" rel="noopener noreferrer">StackEdit</a></li>
<li><a href="https://typora.io/" target="_blank" rel="noopener noreferrer">Typora</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="æ¡Œé¢ç¼–è¾‘å™¨">æ¡Œé¢ç¼–è¾‘å™¨<a href="#æ¡Œé¢ç¼–è¾‘å™¨" class="hash-link" aria-label="æ¡Œé¢ç¼–è¾‘å™¨çš„ç›´æ¥é“¾æ¥" title="æ¡Œé¢ç¼–è¾‘å™¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<ul>
<li><a href="https://marktext.app/" target="_blank" rel="noopener noreferrer">Mark Text</a></li>
<li><a href="https://www.zettlr.com/" target="_blank" rel="noopener noreferrer">Zettlr</a></li>
<li><a href="https://obsidian.md/" target="_blank" rel="noopener noreferrer">Obsidian</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="æµè§ˆå™¨æ‰©å±•">æµè§ˆå™¨æ‰©å±•<a href="#æµè§ˆå™¨æ‰©å±•" class="hash-link" aria-label="æµè§ˆå™¨æ‰©å±•çš„ç›´æ¥é“¾æ¥" title="æµè§ˆå™¨æ‰©å±•çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<ul>
<li>Markdown Hereï¼ˆChrome/Firefoxï¼‰</li>
<li>Markdown Editorï¼ˆChromeï¼‰</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="å­¦ä¹ èµ„æº">å­¦ä¹ èµ„æº<a href="#å­¦ä¹ èµ„æº" class="hash-link" aria-label="å­¦ä¹ èµ„æºçš„ç›´æ¥é“¾æ¥" title="å­¦ä¹ èµ„æºçš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<ul>
<li><a href="https://commonmark.org/help/" target="_blank" rel="noopener noreferrer">CommonMark è§„èŒƒ</a> - å®˜æ–¹æ ‡å‡†è§„èŒƒ</li>
<li><a href="https://commonmark.org/help/tutorial/" target="_blank" rel="noopener noreferrer">Markdown 10 åˆ†é’Ÿæ•™ç¨‹</a> - äº¤äº’å¼å­¦ä¹ </li>
<li><a href="https://github.github.com/gfm/" target="_blank" rel="noopener noreferrer">GitHub Flavored Markdown</a> - GitHub æ‰©å±•è¯­æ³•</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="æ€»ç»“">æ€»ç»“<a href="#æ€»ç»“" class="hash-link" aria-label="æ€»ç»“çš„ç›´æ¥é“¾æ¥" title="æ€»ç»“çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>Markdown æ˜¯ä¸€ç§ç®€å•è€Œå¼ºå¤§çš„æ ‡è®°è¯­è¨€ï¼Œå®ƒè®©ä½ èƒ½å¤Ÿï¼š</p>
<ol>
<li><strong>å¿«é€Ÿæ ¼å¼åŒ–æ–‡æœ¬</strong> - ä½¿ç”¨ç®€å•çš„ç¬¦å·</li>
<li><strong>ä¿æŒå†…å®¹ä¸“æ³¨</strong> - ä¸è¢«å¤æ‚çš„æ ¼å¼åˆ†æ•£æ³¨æ„åŠ›</li>
<li><strong>è·¨å¹³å°å…¼å®¹</strong> - åœ¨ä»»ä½•æ”¯æŒ Markdown çš„å¹³å°ä¸Šéƒ½èƒ½æ­£ç¡®æ˜¾ç¤º</li>
<li><strong>æ˜“äºå­¦ä¹ </strong> - è¯­æ³•ç®€å•ç›´è§‚</li>
<li><strong>å¹¿æ³›æ”¯æŒ</strong> - è¢«ä¼—å¤šå¹³å°å’Œå·¥å…·æ”¯æŒ</li>
</ol>
<p>å¼€å§‹ä½¿ç”¨ Markdownï¼Œè®©ä½ çš„æ–‡æ¡£å†™ä½œæ›´åŠ é«˜æ•ˆå’Œä¸“ä¸šï¼</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>æ ‡ç­¾ï¼š</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/my-website/blog/tags/å‰ç«¯">å‰ç«¯</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/my-website/blog/tags/å·¥å…·">å·¥å…·</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/my-website/blog/tags/markdown">markdown</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="ç¼–ç¨‹å·¥å…·"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/my-website/blog/2025/06/05/prosemirror-primary-guide">ProseMirror å…¥é—¨æŒ‡å—</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2026-06-05T00:00:00.000Z" itemprop="datePublished">2026å¹´6æœˆ5æ—¥</time> Â· <!-- -->é˜…è¯»éœ€ 46 åˆ†é’Ÿ</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/hbche" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/hbche.png" alt="Hanbin Che" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/hbche" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Hanbin Che</span></a></div><small class="avatar__subtitle" itemprop="description">Front End Engineer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p><img decoding="async" loading="lazy" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDIwOC4xIDIzOC4wIj48cGF0aCBkPSJNMTA0IDJBMTAyIDEwMiAwIDAgMCAyIDEwNGExMDIgMTAyIDAgMCAwIDEwMiAxMDIgMTAyIDEwMiAwIDAgMCAxMDItMTAyQTEwMiAxMDIgMCAwIDAgMTA0IDJ6bTAgMTQuOWE4Ny4xIDg3LjEgMCAwIDEgODcuMSA4Ny4xIDg3LjEgODcuMSAwIDAgMS04Ny4xIDg3LjFBODcuMSA4Ny4xIDAgMCAxIDE2LjkgMTA0IDg3LjEgODcuMSAwIDAgMSAxMDQgMTYuOXoiLz48cGF0aCBkPSJNMTQ3LjEgOTIuN2MtNi45IDgzLjkgMTAuOCAxMDMuNCAxMC44IDEwMy40cy01NS4xIDUuNS04Mi43LTEzLjRjLTMwLjUtMjAuOS0yNi4wLTY3LjUtMjUuOS05NC42LjEtMjguNCAyNS42LTQ1LjggNDkuOS00NS4zQzEyOC4zIDQzLjMgMTQ5LjQgNjQuNCAxNDcuMSA5Mi43eiIvPjxwYXRoIGQ9Ik04Mi4xIDEzOS41YzExLjMgMzYuMyA1MC42IDYyLjQgNTAuNiA2Mi40bDE4LjUtMS40eiIgZmlsbD0iI2ZmZiIvPjxwYXRoIGQ9Ik04Mi4xIDEzOS41YzMgMTMuMyAxNy45IDI5LjkgMzAuNCA0MS42IDI0LjggMjMuMiA0MiAyMi40IDg2IDU0LjctMTguMi01MS44LTE4LjgtNjItNDMuNS0xMDYuMS0yNC43LTQ0LTY3LjYtMjAuMy02Ny42LTIwLjNTNzkgMTI2IDgyLjEgMTM5LjN6Ii8+PHBhdGggZD0iTTEwOC45IDc2LjBzLTQuMC0xMS42LTE4LjAtMTEuNWMtMzAuMC4yLTI4LjggNTIuMSAxNi45IDUyLjAgMzkuNi0uMSAzOS4yLTQ5LjQgMTYuMS00OS42LTEwLjItLjItMTUuMCA5LjEtMTUuMCA5LjF6IiBmaWxsPSIjZmZmIi8+PHBhdGggZD0iTTEwOS40IDk1LjBjMTAuOC4wIDIuMCAxNC45LS42IDIwLjktMS44LTguNC0xMC4yLTIwLjkuNi0yMC45ek05My4xIDgwLjFjLTUuNiAwLTEwLjIgNC41LTEwLjIgMTAuMiAwIDUuNiA0LjUgMTAuMiAxMC4yIDEwLjIgNS42IDAgMTAuMi00LjUgMTAuMi0xMC4yIDAtNS42LTQuNS0xMC4yLTEwLjItMTAuMnptMzAuNS0uMWMtNC44IDAtOC44IDQuNS04LjggMTAuMiAwIDUuNiAzLjkgMTAuMiA4LjggMTAuMiA0LjggMCA4LjgtNC41IDguOC0xMC4yIDAtNS42LTMuOS0xMC4yLTguOC0xMC4yeiIvPjwvc3ZnPg==" alt="ProseMirror" title="ProseMirror" class="img_ev3q"></p>
<ul>
<li><a href="#%E6%96%87%E6%A1%A3-documents">æ–‡æ¡£ (Documents)</a>
<ul>
<li><a href="#%E7%B4%A2%E5%BC%95-indexing">ç´¢å¼• (Indexing)</a></li>
<li><a href="#%E5%88%87%E7%89%87-slices">åˆ‡ç‰‡ (Slices)</a></li>
<li><a href="#%E4%BF%AE%E6%94%B9-changing">ä¿®æ”¹ (Changing)</a></li>
</ul>
</li>
<li><a href="#%E6%A8%A1%E5%BC%8F-schemas">æ¨¡å¼ (Schemas)</a>
<ul>
<li><a href="#%E8%8A%82%E7%82%B9%E7%B1%BB%E5%9E%8B-node-types">èŠ‚ç‚¹ç±»å‹ (Node Types)</a></li>
<li><a href="#%E5%86%85%E5%AE%B9%E8%A1%A8%E8%BE%BE%E5%BC%8F-content-expressions">å†…å®¹è¡¨è¾¾å¼ (Content Expressions)</a></li>
<li><a href="#%E6%A0%87%E8%AE%B0-marks">æ ‡è®° (Marks)</a></li>
<li><a href="#%E5%B1%9E%E6%80%A7-attributes">å±æ€§ (Attributes)</a></li>
<li><a href="#%E5%BA%8F%E5%88%97%E5%8C%96%E5%92%8C%E8%A7%A3%E6%9E%90-serialization-and-parsing">åºåˆ—åŒ–å’Œè§£æ (Serialization and Parsing)</a></li>
<li><a href="#%E6%89%A9%E5%B1%95%E6%A8%A1%E5%BC%8F-extending-a-schema">æ‰©å±•æ¨¡å¼ (Extending a Schema)</a></li>
</ul>
</li>
<li><a href="#%E6%96%87%E6%A1%A3%E5%8F%98%E6%8D%A2-document-transformations">æ–‡æ¡£å˜æ¢ (Document transformations)</a>
<ul>
<li><a href="#%E4%B8%BA%E4%BB%80%E4%B9%88-why">ä¸ºä»€ä¹ˆ (Why?)</a></li>
<li><a href="#%E5%8F%98%E6%8D%A2-transforms">å˜æ¢ (Transforms)</a></li>
<li><a href="#%E6%98%A0%E5%B0%84-mapping">æ˜ å°„ (Mapping)</a></li>
<li><a href="#%E9%87%8D%E6%96%B0%E5%9F%BA%E5%87%86%E5%8C%96-rebasing">é‡æ–°åŸºå‡†åŒ– (Rebasing)</a></li>
<li><a href="#%E7%BC%96%E8%BE%91%E7%8A%B6%E6%80%81-the-editor-state">ç¼–è¾‘çŠ¶æ€ (The editor state)</a></li>
</ul>
</li>
<li><a href="#%E8%A7%86%E5%9B%BE%E7%BB%84%E4%BB%B6-the-view-component">è§†å›¾ç»„ä»¶ (The view component)</a>
<ul>
<li><a href="#%E5%8F%AF%E7%BC%96%E8%BE%91%E7%9A%84-dom">å¯ç¼–è¾‘çš„ DOM</a></li>
<li><a href="#%E6%95%B0%E6%8D%AE%E6%B5%81-data-flow">æ•°æ®æµ (Data flow)</a></li>
<li><a href="#%E9%AB%98%E6%95%88%E6%9B%B4%E6%96%B0-efficient-updating">é«˜æ•ˆæ›´æ–° (Efficient updating)</a></li>
<li><a href="#%E5%B1%9E%E6%80%A7-props">å±æ€§ (Props)</a></li>
<li><a href="#%E8%A3%85%E9%A5%B0-decorations">è£…é¥° (Decorations)</a></li>
<li><a href="#%E8%8A%82%E7%82%B9%E8%A7%86%E5%9B%BE-node-views">èŠ‚ç‚¹è§†å›¾ (Node views)</a></li>
</ul>
</li>
<li><a href="#%E5%91%BD%E4%BB%A4-commands-1">å‘½ä»¤ (Commands)</a></li>
<li><a href="#%E5%8D%8F%E5%90%8C%E7%BC%96%E8%BE%91-collaborative-editing">ååŒç¼–è¾‘ (Collaborative editing)</a>
<ul>
<li><a href="#%E7%AE%97%E6%B3%95-algorithm">ç®—æ³• (Algorithm)</a></li>
<li><a href="#%E5%8D%8F%E8%B0%83%E6%9C%8D%E5%8A%A1-the-authority">åè°ƒæœåŠ¡ (The Authority)</a></li>
<li><a href="#collab-%E6%A8%A1%E5%9D%97"><code>collab</code> æ¨¡å—</a></li>
</ul>
</li>
</ul>
<p>æœ¬æŒ‡å—ä»‹ç»äº† ProseMirror åº“ä¸­ä½¿ç”¨çš„å„ç§æ¦‚å¿µï¼Œä»¥åŠå®ƒä»¬ä¹‹é—´çš„ç›¸äº’å…³ç³»ã€‚ä¸ºäº†å¯¹ç³»ç»Ÿ
æœ‰ä¸€ä¸ªå®Œæ•´çš„ç†è§£ï¼Œå»ºè®®æŒ‰ç…§å†…å®¹é¡ºåºä¾æ¬¡é˜…è¯»ï¼Œè‡³å°‘é˜…è¯»åˆ°â€œè§†å›¾ç»„ä»¶(The view
component)â€éƒ¨åˆ†ã€‚ProseMirror æä¾›äº†ä¸€å¥—ç”¨äºæ„å»ºå¯Œæ–‡æœ¬ç¼–è¾‘å™¨ï¼ˆrich text editorsï¼‰
çš„å·¥å…·å’Œæ¦‚å¿µï¼Œå®ƒçš„çµæ„Ÿæºè‡ªæ‰€è§å³æ‰€å¾—ï¼ˆWYSIWYGï¼‰çš„ç”¨æˆ·ç•Œé¢ï¼Œä½†è¯•å›¾é¿å…è¿™ç§ç¼–è¾‘æ–¹
å¼çš„é™·é˜±ã€‚ProseMirror çš„ä¸»è¦åŸåˆ™æ˜¯è®©æˆ‘ä»¬çš„ä»£ç å®Œå…¨æŒæ§æ–‡æ¡£(document)ä»¥åŠå¯¹æ–‡æ¡£çš„
æ‰€æœ‰æ“ä½œã€‚è¿™ä¸ªæ–‡æ¡£å¹¶ä¸æ˜¯ä¸€å † HTMLï¼Œè€Œæ˜¯ä¸€ä¸ªè‡ªå®šä¹‰çš„æ•°æ®ç»“æ„ï¼ˆcustom data
structureï¼‰ï¼Œå…¶ä¸­åªåŒ…å«æˆ‘ä»¬æ˜ç¡®å…è®¸å…¶åŒ…å«çš„å…ƒç´ åŠæˆ‘ä»¬æŒ‡å®šå…³ç³»çš„å…ƒç´ ã€‚æ‰€æœ‰æ›´æ–°éƒ½
é€šè¿‡å•ä¸€å…¥å£ç‚¹è¿›è¡Œï¼Œæ‚¨å¯ä»¥åœ¨æ­¤æ£€æŸ¥æ›´æ–°å¹¶ä½œå‡ºååº”ã€‚</p>
<p>æ ¸å¿ƒåº“å¹¶ä¸æ˜¯ä¸€ä¸ªç®€å•çš„å³æ’å³ç”¨ç»„ä»¶ï¼ˆdrop-in componentï¼‰â€”â€”æˆ‘ä»¬æ›´æ³¨é‡æ¨¡å—åŒ–å’Œå¯å®š
åˆ¶æ€§ï¼Œè€Œä¸æ˜¯ç®€å•æ€§ï¼Œå¸Œæœ›æœªæ¥äººä»¬èƒ½åŸºäº ProseMirror æ„å»ºå¯ç›´æ¥ä½¿ç”¨çš„ç¼–è¾‘å™¨ã€‚å› æ­¤
ï¼Œæœ¬åº“æ›´åƒæ˜¯ä¸€å¥—ä¹é«˜ç§¯æœ¨ï¼ˆLego setï¼‰ï¼Œè€Œä¸æ˜¯ä¸€è¾†ç«æŸ´ç›’å°æ±½è½¦ï¼ˆMatchbox carï¼‰
ã€‚ProseMirror æ‹¥æœ‰ 4 ä¸ª<strong>æ ¸å¿ƒæ¨¡å—</strong>ï¼š</p>
<ul>
<li><strong>prosemirror-model</strong> å®šä¹‰äº†ç¼–è¾‘å™¨çš„æ–‡æ¡£æ¨¡å‹ï¼ˆdocument modelï¼‰ï¼Œå³ç”¨æ¥æè¿°ç¼–è¾‘
å™¨å†…å®¹çš„æ•°æ®ç»“æ„ã€‚</li>
<li><strong>prosemirror-state</strong> æä¾›äº†æè¿°ç¼–è¾‘å™¨<strong>çŠ¶æ€</strong>ï¼ˆstateï¼‰çš„æ•°æ®ç»“æ„ï¼ŒåŒ…æ‹¬å½“å‰é€‰
åŒºï¼ˆselectionï¼‰å’Œç”¨äºä»ä¸€ä¸ªçŠ¶æ€ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªçŠ¶æ€çš„äº‹åŠ¡ç³»ç»Ÿï¼ˆtransaction
systemï¼‰ã€‚</li>
<li><strong>prosemirror-view</strong> å®ç°äº†ä¸€ä¸ªç”¨æˆ·ç•Œé¢ç»„ä»¶ï¼Œå®ƒå°†ä¸€ä¸ªç»™å®šçš„ç¼–è¾‘çŠ¶æ€ä»¥å¯ç¼–è¾‘å…ƒ
ç´ çš„å½¢å¼æ˜¾ç¤ºåœ¨æµè§ˆå™¨ä¸­ï¼Œå¹¶å¤„ç†ä¸è¯¥å…ƒç´ çš„ç”¨æˆ·äº¤äº’ã€‚</li>
<li><strong>prosemirror-transform</strong> åŒ…å«ç”¨äºä¿®æ”¹æ–‡æ¡£çš„åŠŸèƒ½ï¼Œè¿™äº›æ›´æ”¹å¯ä»¥è¢«è®°å½•å’Œé‡æ”¾ï¼Œè¿™
æ„æˆäº† <code>state</code> æ¨¡å—ä¸­äº‹åŠ¡çš„åŸºç¡€ï¼Œå¹¶ä½¿å¾—æ’¤é”€å†å²ï¼ˆundo historyï¼‰å’ŒååŒç¼–è¾‘
ï¼ˆcollaborative editingï¼‰æˆä¸ºå¯èƒ½ã€‚</li>
</ul>
<p>æ­¤å¤–ï¼Œè¿˜æœ‰ä¸€äº›ç”±æ ¸å¿ƒå›¢é˜Ÿç»´æŠ¤çš„æ‰©å±•æ¨¡å—ï¼Œå®ƒä»¬æä¾›äº†é¢å¤–çš„åŠŸèƒ½ï¼Œä½†æ‚¨å¯ä»¥æ ¹æ®éœ€è¦çœ
ç•¥æˆ–ä½¿ç”¨å…¶å®ƒæ¨¡å—æ›¿ä»£ã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹æ¨¡å—ä¹Ÿå¾ˆæœ‰ç”¨ï¼š<strong>åŸºæœ¬ç¼–è¾‘å‘½ä»¤</strong>ï¼ˆbasic editing
commandsï¼‰ã€<strong>é”®ç»‘å®š</strong>ï¼ˆbinding keysï¼‰ã€<strong>æ’¤é”€å†å²</strong>ï¼ˆundo historyï¼‰ã€<strong>è¾“å…¥
å®</strong>ï¼ˆinput macrosï¼‰ã€<strong>åä½œç¼–è¾‘</strong>ï¼ˆcollaborative editingï¼‰ã€ä¸€ä¸ª<strong>ç®€å•æ–‡æ¡£æ¨¡
å¼</strong>ï¼ˆsimple document schemaï¼‰ç­‰ã€‚è¿™äº›éƒ½å¯ä»¥åœ¨ GitHub ä¸Šçš„
<a href="https://github.com/prosemirror" target="_blank" rel="noopener noreferrer">ProseMirror ç»„ç»‡</a> æ‰¾åˆ°ã€‚</p>
<p>ç”±äº ProseMirror ä¸æ˜¯ä»¥å•ä¸ªæµè§ˆå™¨å¯åŠ è½½è„šæœ¬çš„å½¢å¼åˆ†å‘çš„ï¼Œæ‚¨å¯èƒ½éœ€è¦ä½¿ç”¨æ‰“åŒ…å·¥å…·
ï¼ˆbundlerï¼‰æ¥ä½¿ç”¨å®ƒã€‚æ‰“åŒ…å·¥å…·æ˜¯ä¸€ç§èƒ½å¤Ÿè‡ªåŠ¨æŸ¥æ‰¾è„šæœ¬ä¾èµ–å¹¶å°†å®ƒä»¬åˆå¹¶ä¸ºä¸€ä¸ªå¤§æ–‡ä»¶
çš„å·¥å…·ï¼Œæ–¹ä¾¿åœ¨ç½‘é¡µä¸­åŠ è½½ã€‚æ‚¨å¯ä»¥åœ¨ç½‘ä¸Šé˜…è¯»æ›´å¤šå…³äºæ‰“åŒ…çš„å†…å®¹ï¼Œä¾‹
å¦‚<a href="https://medium.freecodecamp.org/what-is-module-bundling-1368c7a97af6" target="_blank" rel="noopener noreferrer">æ­¤å¤„</a>ã€‚</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="æˆ‘çš„ç¬¬ä¸€ä¸ªç¼–è¾‘å™¨">æˆ‘çš„ç¬¬ä¸€ä¸ªç¼–è¾‘  å™¨<a href="#æˆ‘çš„ç¬¬ä¸€ä¸ªç¼–è¾‘å™¨" class="hash-link" aria-label="æˆ‘çš„ç¬¬ä¸€ä¸ªç¼–è¾‘å™¨çš„ç›´æ¥é“¾æ¥" title="æˆ‘çš„ç¬¬ä¸€ä¸ªç¼–è¾‘å™¨çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>å„ä¸ªä¹é«˜ç§¯æœ¨ç»„ä»¶å°±è¿™æ ·ç»„åˆåœ¨ä¸€èµ·ï¼Œä»¥åˆ›å»ºä¸€ä¸ªéå¸¸ç®€åŒ–çš„ç¼–è¾‘å™¨ï¼š</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword module" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token imports"> schema </span><span class="token imports punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;prosemirror-schema-basic&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword module" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">EditorState</span><span class="token imports"> </span><span class="token imports punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;prosemirror-state&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword module" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">EditorView</span><span class="token imports"> </span><span class="token imports punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;prosemirror-view&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> state </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">EditorState</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">create</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> schema </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> view </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">EditorView</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token dom variable" style="color:rgb(189, 147, 249);font-style:italic">document</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">body</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> state </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¿™é‡Œ <code>schema</code>ï¼ˆæ¨¡å¼(schema)ï¼‰æ˜¯ä¸€ä¸ªåŸºæœ¬æ¨¡å¼ï¼Œå®ƒè¢«ç”¨æ¥åˆ›å»ºä¸€ä¸ªçŠ¶æ€ï¼ˆstateï¼‰ï¼Œè¯¥çŠ¶
æ€ å°†ç”Ÿæˆä¸€ä¸ªç¬¦åˆè¯¥æ¨¡å¼çš„ç©ºæ–‡æ¡£ï¼Œå¹¶åœ¨æ–‡æ¡£çš„å¼€å¤´ç”Ÿæˆä¸€ä¸ªé»˜è®¤çš„é€‰åŒºã€‚æœ€åï¼Œæˆ‘ä»¬ä¸ºè¿™
ä¸ªçŠ¶æ€åˆ›å»ºäº†ä¸€ä¸ªè§†å›¾ï¼Œå¹¶å°†å…¶é™„åŠ åˆ° <code>document.body</code>ã€‚è¿™æ ·åšä¼šå°†çŠ¶æ€ä¸­çš„æ–‡æ¡£æ¸²æŸ“ä¸º
ä¸€ä¸ªå¯ç¼–è¾‘çš„ DOM èŠ‚ç‚¹ï¼Œå¹¶è®©ç”¨æˆ·åœ¨å…¶ä¸­é”®å…¥æ—¶ç”ŸæˆçŠ¶æ€äº‹åŠ¡ï¼ˆstate transactionsï¼‰ã€‚</p>
<p>æ­¤æ—¶ï¼Œè¿™ä¸ªç¼–è¾‘å™¨è¿˜ä¸å¤ªå¥½ç”¨ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æŒ‰ä¸‹å›è½¦é”®(enter)ï¼Œä»€ä¹ˆä¹Ÿä¸ä¼šå‘ç”Ÿï¼Œå› 
ä¸ºæ ¸å¿ƒåº“å¹¶ä¸å†³å®šå›è½¦é”®åº”è¯¥æ‰§è¡Œä»€ä¹ˆæ“ä½œã€‚æˆ‘ä»¬å°†åœ¨ç¨åä»‹ç»å¦‚ä½•å¤„ç†è¿™äº›æ“ä½œã€‚</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="äº‹åŠ¡-transactions">äº‹åŠ¡ (Transactions)<a href="#äº‹åŠ¡-transactions" class="hash-link" aria-label="äº‹åŠ¡ (Transactions)çš„ç›´æ¥é“¾æ¥" title="äº‹åŠ¡ (Transactions)çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>å½“ç”¨æˆ·é”®å…¥æˆ–ä»¥å…¶ä»–æ–¹å¼ä¸è§†å›¾äº¤äº’æ—¶ï¼Œå°†äº§ç”Ÿâ€œçŠ¶æ€äº‹åŠ¡â€ï¼ˆstate transactionsï¼‰ã€‚è¿™æ„
å‘³ç€ ProseMirror å¹¶ä¸æ˜¯å°±åœ°ä¿®æ”¹æ–‡æ¡£å¹¶éšå¼åœ°æ›´æ–°çŠ¶æ€ã€‚ç›¸åï¼Œæ¯æ¬¡æ›´æ”¹éƒ½ä¼šåˆ›å»ºä¸€ä¸ª
äº‹åŠ¡ï¼ˆtransactionï¼‰ï¼Œè¯¥äº‹åŠ¡æè¿°äº†å¯¹çŠ¶æ€æ‰€åšçš„æ›´æ”¹ã€‚æˆ‘ä»¬å¯ä»¥åº”ç”¨è¯¥äº‹åŠ¡æ¥åˆ›å»ºä¸€ä¸ª
æ–°çš„çŠ¶æ€ï¼Œç„¶åä½¿ç”¨è¿™ä¸ªæ–°çŠ¶æ€æ¥æ›´æ–°è§†å›¾ã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™ä¸€åˆ‡éƒ½åœ¨å†…éƒ¨å®Œæˆï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡ç¼–å†™æ’ä»¶ï¼ˆpluginsï¼‰æˆ–é…ç½®è§†å›¾æ¥
ä»‹å…¥ã€‚ä¾‹å¦‚ï¼Œä¸‹é¢çš„ä»£ç æ·»åŠ äº†ä¸€ä¸ª <code>dispatchTransaction</code> å±æ€§ï¼ˆpropï¼‰ï¼Œè¯¥å±æ€§ä¼šåœ¨
æ¯æ¬¡åˆ›å»ºäº‹åŠ¡æ—¶è¢«è°ƒç”¨ï¼š</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">// ï¼ˆå¿½ç•¥äº† import è¯­å¥ï¼‰</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> state </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">EditorState</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">create</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> schema </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> view </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">EditorView</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token dom variable" style="color:rgb(189, 147, 249);font-style:italic">document</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">body</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  state</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token function" style="color:rgb(80, 250, 123)">dispatchTransaction</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">transaction</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Document size went from&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      transaction</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">before</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">content</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">size</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;to&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      transaction</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">doc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">content</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">size</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> newState </span><span class="token operator">=</span><span class="token plain"> view</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">state</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">apply</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">transaction</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    view</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">updateState</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">newState</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æ¯æ¬¡çŠ¶æ€çš„æ›´æ–°éƒ½å¿…é¡»é€šè¿‡ <code>view.updateState</code> æ–¹æ³•å®Œæˆï¼Œè€Œæ™®é€šçš„ç¼–è¾‘æ›´æ–°éƒ½ä¼šé€šè¿‡æ´¾
å‘ï¼ˆdispatchï¼‰äº‹åŠ¡æ¥è§¦å‘ã€‚</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="æ’ä»¶-plugins">æ’ä»¶ (Plugins)<a href="#æ’ä»¶-plugins" class="hash-link" aria-label="æ’ä»¶ (Plugins)çš„ç›´æ¥é“¾æ¥" title="æ’ä»¶ (Plugins)çš„ç›´æ¥é“¾  æ¥">â€‹</a></h3>
<p><strong>æ’ä»¶ï¼ˆpluginsï¼‰</strong> ç”¨äºä»¥å„ç§æ–¹å¼æ‰©å±•ç¼–è¾‘å™¨å’Œç¼–è¾‘çŠ¶æ€çš„è¡Œä¸ºã€‚æœ‰äº›æ’ä»¶æ¯”è¾ƒç®€å•ï¼Œ
ä¾‹å¦‚å°†ç”¨æˆ·æ“ä½œç»‘å®šåˆ°é”®ç›˜è¾“å…¥çš„ <code>keymap</code> æ’ä»¶ï¼›è¿˜æœ‰ä¸€äº›åˆ™æ›´å¤æ‚ï¼Œæ¯”å¦‚å®ç°æ’¤é”€å†å²
åŠŸèƒ½çš„ <code>history</code> æ’ä»¶ï¼Œå®ƒé€šè¿‡è§‚å¯Ÿäº‹åŠ¡å¹¶å­˜å‚¨å®ƒä»¬çš„é€†æ“ä½œæ¥å®ç°æ’¤é”€åŠŸèƒ½ã€‚</p>
<p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ç»™ç¼–è¾‘å™¨æ·»åŠ ä»¥ä¸‹ä¸¤ä¸ªæ’ä»¶ï¼Œä»¥è·å¾—æ’¤é”€/é‡åšçš„åŠŸèƒ½ï¼š</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">// ï¼ˆå¿½ç•¥äº†é‡å¤çš„ import è¯­å¥ï¼‰</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword module" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token imports"> undo</span><span class="token imports punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token imports"> redo</span><span class="token imports punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token imports"> history </span><span class="token imports punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;prosemirror-history&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword module" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token imports"> keymap </span><span class="token imports punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;prosemirror-keymap&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> state </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">EditorState</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">create</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  schema</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token literal-property property">plugins</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token function" style="color:rgb(80, 250, 123)">history</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">keymap</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token string-property property">&#x27;Mod-z&#x27;</span><span class="token operator">:</span><span class="token plain"> undo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string-property property">&#x27;Mod-y&#x27;</span><span class="token operator">:</span><span class="token plain"> redo </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> view </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">EditorView</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token dom variable" style="color:rgb(189, 147, 249);font-style:italic">document</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">body</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> state </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æ’ä»¶ä¼šåœ¨åˆ›å»ºçŠ¶æ€æ—¶æ³¨å†Œï¼ˆå› ä¸ºå®ƒä»¬å¯ä»¥è®¿é—®çŠ¶æ€äº‹åŠ¡ï¼‰ã€‚åœ¨ä¸ºå¯ç”¨äº†å†å²åŠŸèƒ½çš„çŠ¶æ€åˆ›å»º
è§†å›¾ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æŒ‰ä¸‹ <strong>Ctrl-Z</strong>ï¼ˆåœ¨ macOS ä¸Šæ˜¯ <strong>Cmd-Z</strong>ï¼‰æ¥æ’¤é”€æˆ‘ä»¬ä¸Šä¸€æ¬¡
çš„æ›´æ”¹ã€‚</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="å‘½ä»¤-commands">å‘½ä»¤ (Commands)<a href="#å‘½ä»¤-commands" class="hash-link" aria-label="å‘½ä»¤ (Commands)çš„ç›´æ¥é“¾æ¥" title="å‘½ä»¤ (Commands)çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>å‰ä¸€ä¸ªç¤ºä¾‹ä¸­ç»‘å®šåˆ°é”®ä¸Šçš„ <code>undo</code> å’Œ <code>redo</code> çš„å€¼æ˜¯ä¸€ç§ç‰¹æ®Šçš„å‡½æ•°ï¼Œç§°ä¸º<strong>å‘½ä»¤
ï¼ˆcommandsï¼‰</strong>ã€‚å¤§å¤šæ•°ç¼–è¾‘æ“ä½œéƒ½å¯ä»¥å†™æˆå‘½ä»¤ï¼Œè¿™äº›å‘½ä»¤å¯ä»¥ç»‘å®šåˆ°é”®ç›˜æˆ–èœå•ç­‰ï¼Œä»¥
ä¾¿ç”¨æˆ·è§¦å‘ã€‚å‘½ä»¤åœ¨å®šä¹‰ä¸Šç¨æ˜¾å¤æ‚ã€‚åœ¨æœ€åŸºæœ¬çš„å½¢å¼ä¸­ï¼Œä¸€ä¸ªå‘½ä»¤æ˜¯è¿™æ ·å®šä¹‰çš„å‡½æ•°ï¼šå®ƒ
æ¥å—ä¸€ä¸ªç¼–è¾‘å™¨çŠ¶æ€ï¼ˆstateï¼‰å’Œä¸€ä¸ªè°ƒåº¦å‡½æ•°ï¼ˆdispatch functionï¼‰ä½œä¸ºå‚æ•°ï¼ˆè¯¥å‡½æ•°å¯
ä»¥æ˜¯ <code>EditorView.dispatch</code> æˆ–è€…å…¶ä»–æ¥å—äº‹åŠ¡çš„å‡½æ•°ï¼‰ï¼Œå¹¶è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ã€‚ä¾‹å¦‚ï¼Œä¸€
ä¸ªéå¸¸ç®€å•çš„å‘½ä»¤å‡½æ•°å¯èƒ½æ˜¯ï¼š</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">deleteSelection</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token parameter"> dispatch</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">selection</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">empty</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">dispatch</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">dispatch</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">tr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">deleteSelection</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å½“å‘½ä»¤ä¸é€‚ç”¨æ—¶ï¼Œå®ƒåº”è¯¥è¿”å› <code>false</code> å¹¶ä¸”ä¸åšä»»ä½•äº‹æƒ…ã€‚å½“å‘½ä»¤é€‚ç”¨æ—¶ï¼Œå®ƒåº”è¯¥æ´¾å‘ä¸€
ä¸ªäº‹åŠ¡å¹¶è¿”å› <code>true</code>ã€‚ä¾‹å¦‚ï¼Œåœ¨ <code>keymap</code> æ’ä»¶ä¸­ï¼Œå½“ä¸€ä¸ªæŒ‰é”®ç»‘å®šçš„å‘½ä»¤è¢«æ‰§è¡Œåï¼Œä¼š
æ£€æµ‹è¯¥å‘½ä»¤æ˜¯å¦è¿”å›äº† <code>true</code>ï¼Œå¦‚æœæ˜¯åˆ™åœæ­¢è¯¥é”®çš„åç»­å¤„ç†ã€‚å‘½ä»¤å‡½æ•°çš„ <code>dispatch</code>
å‚æ•°æ˜¯å¯é€‰çš„ï¼šå¦‚æœæ‚¨åªæƒ³æŸ¥è¯¢è¯¥å‘½ä»¤æ˜¯å¦å¯ç”¨ï¼Œè€Œä¸æ‰§è¡Œæ“ä½œï¼Œåªéœ€è¦è°ƒç”¨å‘½ä»¤å‡½æ•°æ—¶ä¼ 
å…¥ <code>dispatch = null</code> æˆ–ä¸ä¼  <code>dispatch</code>ã€‚å› æ­¤ï¼Œèœå•æ å¯ä»¥è°ƒç”¨
<code>deleteSelection(view.state, null)</code> æ¥åˆ¤æ–­é€‰åŒºæ˜¯å¦å¯åˆ é™¤ï¼Œå¦‚æœè¦çœŸæ­£æ‰§è¡Œåˆ é™¤ï¼Œåˆ™
è°ƒç”¨ <code>deleteSelection(view.state, view.dispatch)</code>ã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå‘½ä»¤æ— æ³•è®¿é—®å®é™…çš„è§†å›¾å¯¹è±¡ï¼ˆviewï¼‰ã€‚ä¸è¿‡æœ‰äº›å‘½ä»¤éœ€è¦ä¸ DOM äº¤äº’ï¼Œä¾‹
å¦‚æ£€æŸ¥æŸä¸ªä½ç½®æ˜¯å¦ä½äºæ–‡æœ¬å—çš„æœ«å°¾ï¼Œæˆ–è€…éœ€è¦æ‰“å¼€ä¸€ä¸ªå¯¹è¯æ¡†ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œè°ƒç”¨å‘½ä»¤
çš„æ’ä»¶å¯ä»¥å°†ç¼–è¾‘è§†å›¾å¯¹è±¡ä½œä¸ºç¬¬ä¸‰ä¸ªå‚æ•°ä¼ å…¥å‘½ä»¤å‡½æ•°ã€‚ä¾‹å¦‚  ï¼š</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">blinkView</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">_state</span><span class="token parameter punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token parameter"> dispatch</span><span class="token parameter punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token parameter"> view</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">dispatch</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    view</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">dom</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">style</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">background</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;yellow&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">setTimeout</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">view</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">dom</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">style</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">background</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1000</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä¸Šè¿°ä¾‹å­æ¼”ç¤ºäº†å‘½ä»¤ä¸ä¸€å®šéè¦æ´¾å‘äº‹åŠ¡â€”â€”å‘½ä»¤è°ƒç”¨é€šå¸¸æ˜¯ä¸ºäº†äº§ç”Ÿå‰¯ä½œç”¨(side
effect)ï¼Œåœ¨è¿™é‡Œçš„ä¾‹å­ä¸­å®ƒåªæ˜¯é—ªçƒè§†å›¾çš„èƒŒæ™¯è‰²ã€‚</p>
<p>ProseMirror çš„
<a href="https://prosemirror.net/docs/ref/#commands" target="_blank" rel="noopener noreferrer"><code>prosemirror-commands</code></a> æ¨¡å—æä¾›äº†
ä¸€ç³»åˆ—å¸¸ç”¨ç¼–è¾‘å‘½ä»¤ï¼Œæ¶µç›–ä»ç®€å•å‘½ä»¤ï¼ˆä¾‹å¦‚åˆ é™¤é€‰åŒºï¼‰åˆ°å¤æ‚å‘½ä»¤ï¼ˆå¦‚å¤„ç†é€€æ ¼é”®åˆå¹¶å—
çš„ <code>joinBackward</code>ï¼‰ã€‚è¯¥æ¨¡å—è¿˜æä¾›äº†ä¸€
ä¸ª<a href="https://prosemirror.net/docs/ref/#commands.basicKeymap" target="_blank" rel="noopener noreferrer"><strong>åŸºæœ¬é”®ç›˜æ˜ å°„</strong>ï¼ˆbasic keymapï¼‰</a>ï¼Œ
å°†ä¸€äº›ä¸æ¨¡å¼æ— å…³çš„å‘½ä»¤ç»‘å®šåˆ°å¸¸è§çš„æŒ‰é”®ä¸Šã€‚ä¾‹å¦‚ï¼Œåœ¨è¯¥é”®ç›˜æ˜ å°„ä¸­ï¼Œé€€æ ¼é”®
(backspace)è¢«ç»‘å®šåˆ°å¦‚ä¸‹å‘½ä»¤é“¾ï¼šå…ˆå°è¯• <code>deleteSelection</code>ï¼ˆå½“é€‰åŒºä¸ä¸ºç©ºæ—¶ç”Ÿæ•ˆï¼‰ã€
å†å°è¯• <code>joinBackward</code>ï¼ˆå½“å…‰æ ‡ä½äºæ–‡æœ¬å—å¼€å¤´æ—¶ç”Ÿæ•ˆï¼‰ã€æœ€åå°è¯•
<code>selectNodeBackward</code>ï¼ˆå½“å‰ä¸¤ä¸ªéƒ½ä¸é€‚ç”¨æ—¶é€‰ä¸­å…‰æ ‡å‰é¢çš„èŠ‚ç‚¹ï¼‰ã€‚å½“æ‰€æœ‰è¿™äº›å‘½ä»¤éƒ½ä¸
é€‚ç”¨æ—¶ï¼Œæµè§ˆå™¨ä¼šæ‰§è¡Œè‡ªå·±çš„é€€æ ¼è¡Œä¸ºï¼Œä¾‹å¦‚åœ¨æ–‡æœ¬å—å†…éƒ¨åˆ é™¤ä¸€ä¸ªå­—ç¬¦ã€‚</p>
<p>å‘½ä»¤æ¨¡å—è¿˜å¯¼å‡ºäº†ä¸€äº›å‘½ä»¤æ„é€ å‡½æ•°ï¼Œä¾‹å¦‚ <code>toggleMark(markType, attrs)</code>ï¼Œå®ƒæ¥å—ä¸€ä¸ª
æ ‡è®°ç±»å‹å’Œå¯é€‰çš„å±æ€§é›†ï¼Œè¿”å›ä¸€ä¸ªå‘½ä»¤å‡½æ•°ï¼Œç”¨äºåœ¨å½“å‰é€‰åŒºä¸Šåˆ‡æ¢è¯¥æ ‡è®°ã€‚ä¸€äº›å…¶ä»–æ¨¡
å—ä¹Ÿä¼šå¯¼å‡ºå‘½ä»¤ï¼Œä¾‹å¦‚å†å²æ¨¡å—æä¾›äº† <code>undo</code> å’Œ <code>redo</code> å‘½ä»¤ã€‚è¦å®šåˆ¶æ‚¨çš„ç¼–è¾‘å™¨ï¼Œæˆ–è®©
ç”¨æˆ·èƒ½å¤Ÿä¸æ–‡æ¡£ä¸­çš„è‡ªå®šä¹‰èŠ‚ç‚¹äº¤äº’ï¼Œæ‚¨ä¹Ÿå¯èƒ½éœ€è¦ç¼–å†™è‡ªå·±çš„å‘½ä»¤ã€‚</p>
<div class="language-tsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-tsx codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token imports"> schema </span><span class="token imports punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;prosemirror-schema-basic&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">EditorState</span><span class="token imports"> </span><span class="token imports punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;prosemirror-state&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">EditorView</span><span class="token imports"> </span><span class="token imports punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;prosemirror-view&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token imports"> useEffect </span><span class="token imports punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;react&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token imports"> keymap </span><span class="token imports punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;prosemirror-keymap&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token imports"> baseKeymap </span><span class="token imports punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;prosemirror-commands&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">SetupExample</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token function" style="color:rgb(80, 250, 123)">useEffect</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> view </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">EditorView</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token dom variable" style="color:rgb(189, 147, 249);font-style:italic">document</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">querySelector</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;#setup-editor&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      state</span><span class="token operator">:</span><span class="token plain"> </span><span class="token maybe-class-name">EditorState</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">create</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        schema</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        plugins</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token function" style="color:rgb(80, 250, 123)">keymap</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">baseKeymap</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> view</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">destroy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">div</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">id</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&#x27;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">setup-editor</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&#x27;</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">className</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&#x27;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">editor</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&#x27;</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain-text">      </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">div</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">id</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&#x27;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">setup-content</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&#x27;</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">div</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">div</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">default</span><span class="token plain"> </span><span class="token maybe-class-name">SetupExample</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æ­¤æ—¶ï¼Œæˆ‘ä»¬å·²ç»æœ‰äº†ä¸€ä¸ªåŸºæœ¬æ­£å¸¸å·¥ä½œçš„ç¼–è¾‘å™¨ã€‚</p>
<p>è¦ä¸ºç‰¹å®šäºæ¨¡å¼æ·»åŠ èœå•ã€é™„åŠ é”®ç»‘å®šç­‰ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦æŸ¥çœ‹
<a href="https://github.com/prosemirror/prosemirror-example-setup" target="_blank" rel="noopener noreferrer">prosemirror-example-setup</a>
åŒ…ã€‚è¿™æ˜¯ä¸€ä¸ªä¸ºæˆ‘ä»¬å®ç°åŸºç¡€ç¼–è¾‘å™¨çš„ä¸€ç³»åˆ—æ’ä»¶çš„æ¨¡å—ï¼Œä½†é¡¾åæ€ä¹‰ï¼Œå®ƒæ›´å¤šçš„æ˜¯ä½œä¸ºç¤º
ä¾‹è€Œä¸æ˜¯ç”Ÿäº§çº§åº“ã€‚å¯¹äºå®é™…éƒ¨ç½²ï¼Œæˆ‘ä»¬å¯èƒ½å¸Œæœ›ç”¨è‡ªå®šä¹‰ä»£ç æ›¿æ¢å®ƒï¼Œè¿™äº›ä»£ç å¯ä»¥å®Œå…¨
æŒ‰ç…§æˆ‘ä»¬æƒ³è¦çš„æ–¹å¼è®¾ç½®ä¸œè¥¿ã€‚</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="å†…å®¹-content">å†…å®¹ (Content)<a href="#å†…å®¹-content" class="hash-link" aria-label="å†…å®¹ (Content)çš„ç›´æ¥é“¾æ¥" title="å†…å®¹ (Content)çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>çŠ¶æ€ï¼ˆstateï¼‰ä¸­çš„æ–‡æ¡£å¯¹è±¡ä¿å­˜åœ¨ <code>doc</code> å±æ€§ä¸­ã€‚è¿™ä¸ªå±æ€§æ˜¯ä¸€ä¸ªåªè¯»çš„æ•°æ®ç»“æ„ï¼Œè¡¨ç¤º
æ–‡æ¡£ä½œä¸ºèŠ‚ç‚¹æ ‘ï¼ˆæ ‘å½¢å±‚æ¬¡ç»“æ„ï¼‰ã€‚ä¸€ä¸ªç®€å•çš„æ–‡æ¡£å¯èƒ½æ˜¯ä¸€ä¸ªç±»å‹ä¸º <code>&quot;doc&quot;</code> çš„èŠ‚ç‚¹ï¼Œ
å®ƒåŒ…å«ä¸¤ä¸ª <code>&quot;paragraph&quot;</code> èŠ‚ç‚¹ï¼Œæ¯ä¸ª <code>&quot;paragraph&quot;</code> èŠ‚ç‚¹éƒ½åŒ…å«ä¸€ä¸ª <code>&quot;text&quot;</code> èŠ‚ç‚¹ï¼ˆ
æ–‡æœ¬ï¼‰ã€‚åœ¨åˆå§‹åŒ–çŠ¶æ€æ—¶ï¼Œæ‚¨å¯ä»¥æä¾›ä¸€ä¸ªåˆå§‹æ–‡æ¡£ï¼ˆå¦‚ HTML ç‰‡æ®µï¼‰ï¼Œå¦‚æœæä¾›äº†åˆå§‹æ–‡
æ¡£ï¼Œåˆ™ <code>schema</code> å­—æ®µå¯é€‰ï¼Œå› ä¸ºå¯ä»¥ä»æ–‡æ¡£ä¸­æ¨æ–­å‡ºä½¿ç”¨çš„æ¨¡å¼ã€‚</p>
<p>ä¾‹å¦‚ï¼Œä¸‹é¢çš„ç¤ºä¾‹ä½¿ç”¨ <code>DOMParser</code> é€šè¿‡åŸºæœ¬æ¨¡å¼(<code>prosemirror-schema-basic</code> æä¾›)å°†
é¡µé¢ä¸Š id ä¸º <code>content</code> çš„ DOM å…ƒç´ çš„å†…å®¹è§£æä¸ºæ–‡æ¡£ï¼Œå¹¶ç”¨è¯¥ç»“æœæ¥åˆ›å»ºåˆå§‹çŠ¶æ€ï¼š</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword module" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">DOMParser</span><span class="token imports"> </span><span class="token imports punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;prosemirror-model&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> state </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">EditorState</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">create</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  schema</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token literal-property property">doc</span><span class="token operator">:</span><span class="token plain"> </span><span class="token maybe-class-name">DOMParser</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">fromSchema</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">schema</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">parse</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token dom variable" style="color:rgb(189, 147, 249);font-style:italic">document</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">querySelector</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;#content&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä»æ¨¡å¼ç”Ÿæˆçš„ <code>DOMParser</code>ï¼Œå®ƒä¼šå°† DOM å…ƒç´ çš„å†…å®¹è½¬æ¢ä¸º
ProseMirror æ–‡æ¡£èŠ‚ç‚¹ã€‚</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="æ–‡æ¡£-documents">æ–‡æ¡£ (Documents)<a href="#æ–‡æ¡£-documents" class="hash-link" aria-label="æ–‡æ¡£ (Documents)çš„ç›´æ¥é“¾æ¥" title="æ–‡æ¡£ (Documents)çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>ProseMirror ä¸ºå†…å®¹æ–‡æ¡£å®šä¹‰äº†ä¸€ç§è‡ªæœ‰çš„æ•°æ®ç»“æ„ã€‚ç”±äºæ–‡æ¡£æ˜¯æ„å»ºç¼–è¾‘å™¨å…¶ä»–åŠŸèƒ½çš„æ ¸
å¿ƒå…ƒç´ ï¼Œç†è§£å®ƒä»¬çš„å·¥ä½œåŸç†éå¸¸é‡è¦ã€‚ProseMirror çš„æ–‡æ¡£æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªæ ‘å½¢ç»“æ„ï¼šæ–‡æ¡£
ï¼ˆé¡¶å±‚ <code>&quot;doc&quot;</code> èŠ‚ç‚¹ï¼‰åŒ…å«è‹¥å¹²å­èŠ‚ç‚¹ï¼Œè€Œæ¯ä¸ªå­èŠ‚ç‚¹åˆå¯ä»¥åŒ…å«è‡ªå·±çš„å­èŠ‚ç‚¹ï¼Œä»¥æ­¤ç±»
æ¨ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šå°†æ–‡æ¡£æƒ³è±¡ä¸ºå—çº§èŠ‚ç‚¹ï¼ˆblock nodesï¼‰çš„åºåˆ—ï¼Œå…¶ä¸­åŒ…å«æ–‡æœ¬
å—ï¼ˆtextblocksï¼‰å’Œå…¶å®ƒå—å…ƒç´ ã€‚</p>
<p>åœ¨æµè§ˆå™¨çš„ HTML ä¸­ï¼Œä¸€ä¸ªå¸¦æœ‰æ ¼å¼æ ‡è®°çš„æ®µè½é€šå¸¸è¡¨ç°ä¸ºä¸€ä¸ªåµŒå¥—ç»“æ„ã€‚ä¾‹å¦‚ï¼š</p>
<div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">p</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  This is </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">strong</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">strong text with </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">em</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">emphasis</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">em</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">strong</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">p</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¿™ä¸ª HTML ç‰‡æ®µå¯¹åº”ä¸€ä¸ªæ ‘å½¢ç»“æ„ï¼š<code>&lt;p&gt;</code> èŠ‚ç‚¹åŒ…å«æ–‡æœ¬å’Œä¸€ä¸ª <code>&lt;strong&gt;</code> èŠ‚ç‚¹
ï¼Œ<code>&lt;strong&gt;</code> èŠ‚ç‚¹åŒ…å«æ–‡æœ¬å’Œ <code>&lt;em&gt;</code> èŠ‚ç‚¹ï¼Œä»¥æ­¤ç±»æ¨ã€‚<strong>è€Œåœ¨ ProseMirror ä¸­</strong>ï¼Œå†…è”
å†…å®¹ï¼ˆå¦‚åŠ ç²—ã€æ–œä½“ï¼‰è¢«å»ºæ¨¡ä¸ºä¸€ä¸ªæ‰å¹³åºåˆ—ï¼Œå¹¶å°†è¿™äº›æ ·å¼æ ‡è®°ä½œä¸ºå…ƒæ•°æ®é™„åŠ åˆ°æ–‡æœ¬èŠ‚
ç‚¹ä¸Šã€‚è¿™ä¸æˆ‘ä»¬ç›´è§‰ä¸Šå¤„ç†æ–‡æœ¬çš„æ–¹å¼æ›´ç›¸ç¬¦ï¼Œä¹Ÿå…è®¸æˆ‘ä»¬é€šè¿‡å­—ç¬¦åç§»æ¥å®šä½æ®µè½ä¸­çš„ä½
ç½®ï¼Œè€Œä¸å¿…åœ¨æ ‘ä¸­ä¸€è·¯è®¡æ•°ã€‚</p>
<p>è¿™ç§è®¾è®¡è¿˜æœ‰å…¶ä»–å¥½å¤„ï¼šå®ƒæ„å‘³ç€æ¯ä¸ªæ–‡æ¡£åªæœ‰ä¸€ç§æœ‰æ•ˆçš„è¡¨ç¤ºã€‚å…·æœ‰ç›¸åŒæ ‡è®°çš„ç›¸é‚»æ–‡æœ¬
èŠ‚ç‚¹ä¼šè¢«è‡ªåŠ¨åˆå¹¶ï¼Œç©ºçš„æ–‡æœ¬èŠ‚ç‚¹æ˜¯ä¸å…è®¸å­˜åœ¨çš„ï¼Œæ ‡è®°åœ¨èŠ‚ç‚¹ä¸­å‡ºç°çš„é¡ºåºç”±æ¨¡å¼
ï¼ˆschemaï¼‰æŒ‡å®šï¼Œç¡®ä¿æ–‡æ¡£å§‹ç»ˆç¬¦åˆå®šä¹‰çš„çº¦æŸã€‚</p>
<p>å› æ­¤ï¼ŒProseMirror æ–‡æ¡£æ˜¯ç”±å—çº§èŠ‚ç‚¹ç»„æˆçš„æ ‘ï¼Œå…¶ä¸­å¤§å¤šæ•°å¶å­èŠ‚ç‚¹æ˜¯æ–‡æœ¬å—
ï¼ˆtextblocksï¼‰ï¼Œå®ƒä»¬ä»£è¡¨å¯  ä»¥åŒ…å«æ–‡æœ¬çš„å—çº§å…ƒç´ ã€‚æ‚¨ä¹Ÿå¯ä»¥æœ‰ä¸€äº›ç©ºçš„å—çº§èŠ‚ç‚¹ä½œä¸ºå¶
å­èŠ‚ç‚¹ï¼Œä¾‹å¦‚æ°´å¹³çº¿ï¼ˆ<code>horizontal_rule</code>ï¼‰ã€å†…è”å›¾ç‰‡ç­‰ã€‚æ¯ä¸ªèŠ‚ç‚¹å¯¹è±¡å…·æœ‰ä¸€äº›å±æ€§ï¼Œ
ç”¨äºè¡¨ç¤ºå®ƒä»¬åœ¨æ–‡æ¡£ç»“æ„ä¸­çš„è§’è‰²ï¼š</p>
<ul>
<li><code>isBlock</code> ä¸ <code>isInline</code> è¡¨ç¤ºèŠ‚ç‚¹æ˜¯å—çº§çš„è¿˜æ˜¯å†…è”çš„ã€‚</li>
<li><code>inlineContent</code> å¦‚æœèŠ‚ç‚¹æœŸå¾…å†…è”å†…å®¹ï¼Œåˆ™ä¸º <code>true</code>ã€‚</li>
<li><code>isTextblock</code> å¦‚æœä¸€ä¸ªå—çº§èŠ‚ç‚¹å…è®¸åŒ…å«å†…è”å†…å®¹ï¼Œåˆ™ä¸º <code>true</code>ã€‚</li>
<li><code>isLeaf</code> å¦‚æœèŠ‚ç‚¹ä¸å…è®¸ä»»ä½•å†…å®¹ï¼ˆå³å¶å­èŠ‚ç‚¹ï¼‰ï¼Œåˆ™ä¸º <code>true</code>ã€‚</li>
</ul>
<p>ä¾‹å¦‚ï¼Œå¸¸è§çš„ <code>&quot;paragraph&quot;</code> èŠ‚ç‚¹é€šå¸¸æ˜¯æ–‡æœ¬å—ï¼ˆtextblockï¼‰ï¼Œè€Œåƒ <code>&lt;blockquote&gt;</code> è¿™
æ ·çš„å¼•ç”¨å—å¯èƒ½æ˜¯ä¸€ä¸ªå—çº§èŠ‚ç‚¹ï¼Œå®ƒçš„å†…å®¹ç”±å…¶ä»–å—ç»„æˆã€‚æ–‡æœ¬èŠ‚ç‚¹ã€ç¡¬æ¢è¡Œï¼ˆhard
breakï¼‰å’Œå†…è”å›¾ç‰‡ï¼ˆinline imageï¼‰æ˜¯å†…è”çš„å¶å­èŠ‚ç‚¹ï¼Œè€Œæ°´å¹³çº¿èŠ‚ç‚¹æ˜¯å—çº§çš„å¶å­èŠ‚ç‚¹
ã€‚</p>
<p>æ¨¡å¼ï¼ˆschemaï¼‰å®šä¹‰äº†å“ªäº›èŠ‚ç‚¹å¯ä»¥å‡ºç°åœ¨ä½•å¤„ã€‚ä¾‹å¦‚ï¼Œå³ä½¿æŸä¸ªèŠ‚ç‚¹å…è®¸å—çº§å†…å®¹ï¼Œæ¨¡å¼
ä¹Ÿå¯ä»¥é™åˆ¶åªå…è®¸ç‰¹å®šç±»å‹çš„å—çº§èŠ‚ç‚¹ä½œä¸ºå…¶å­èŠ‚ç‚¹ã€‚è¦é€šè¿‡ç¼–ç¨‹æ–¹å¼åˆ›å»ºèŠ‚ç‚¹ï¼Œå¿…é¡»ä½¿ç”¨
å…¶æ‰€å±æ¨¡å¼æä¾›çš„æ–¹æ³•ï¼Œä¾‹å¦‚ä½¿ç”¨æ¨¡å¼å¯¹è±¡çš„ <code>node</code> å’Œ <code>text</code> æ–¹æ³•ã€‚</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword module" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token imports"> schema </span><span class="token imports punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;prosemirror-schema-basic&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯èŠ‚ç‚¹ç±»å‹åï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å±æ€§å¯¹è±¡ï¼Œ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯å­èŠ‚ç‚¹åˆ—è¡¨ã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> doc </span><span class="token operator">=</span><span class="token plain"> schema</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">node</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;doc&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword null nil" style="color:rgb(189, 147, 249);font-style:italic">null</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  schema</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">node</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;paragraph&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword null nil" style="color:rgb(189, 147, 249);font-style:italic">null</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">schema</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">text</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;One.&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  schema</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">node</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;horizontal_rule&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  schema</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">node</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;paragraph&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword null nil" style="color:rgb(189, 147, 249);font-style:italic">null</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">schema</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">text</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Two!&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ç´¢å¼•-indexing">ç´¢å¼• (Indexing)<a href="#ç´¢å¼•-indexing" class="hash-link" aria-label="ç´¢å¼• (Indexing)çš„ç›´æ¥é“¾æ¥" title="ç´¢å¼• (Indexing)çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>ProseMirror èŠ‚ç‚¹æ”¯æŒä¸¤ç§ç±»å‹çš„ç´¢å¼•ï¼šä¸€ç§æ˜¯å°†å…¶è§†ä¸ºæ ‘ç»“æ„æ¥éå†ï¼Œå¯ä»¥ä½¿ç”¨èŠ‚ç‚¹çš„
<code>child</code> æ–¹æ³•å’Œ <code>childCount</code> å±æ€§è®¿é—®å­èŠ‚ç‚¹ï¼Œæˆ–è€…å†™é€’å½’å‡½æ•°éå†æ‰€æœ‰èŠ‚ç‚¹ï¼ˆä¹Ÿå¯ä»¥ä½¿
ç”¨ <code>descendants</code> æˆ– <code>nodesBetween</code> æ–¹æ³•å¿«é€Ÿéå†ï¼‰ï¼›å¦ä¸€ç§åˆ™æ˜¯å°†æ–‡æ¡£è§†ä¸ºä¸€ä¸ªæ‰å¹³
çš„æ ‡è®°åºåˆ—ï¼ˆtoken sequenceï¼‰ï¼Œåœ¨è¿™ç§åºåˆ—ä¸­å¯ä»¥å°†æ–‡æ¡£ä¸­ä»»æ„ä½ç½®è¡¨ç¤ºä¸ºä¸€ä¸ªæ•´æ•°ã€‚</p>
<p>ä½¿ç”¨æ ‡è®°åºåˆ—ç´¢å¼•æ›´é€‚åˆç²¾ç¡®å®šä½æ–‡æ¡£ä¸­çš„ä½ç½®ï¼š</p>
<ul>
<li>æ–‡æ¡£å¼€å§‹ï¼ˆç¬¬ä¸€ä¸ªå†…å®¹ä¹‹å‰ï¼‰çš„ä½ç½®ä¸º <strong>0</strong>ã€‚</li>
<li>è¿›å…¥æˆ–ç¦»å¼€ä¸€ä¸ªéå¶å­èŠ‚ç‚¹ï¼ˆå³å…è®¸å†…å®¹çš„èŠ‚ç‚¹ï¼‰æ—¶ï¼Œç®—ä½œä¸€ä¸ªæ ‡è®°ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ–‡æ¡£ä»¥
ä¸€ä¸ªæ®µè½å¼€å§‹ï¼Œé‚£ä¹ˆæ®µè½çš„å¼€å§‹å°±è¢«è®¡ä¸ºä½ç½® 1ã€‚</li>
<li>æ–‡æœ¬èŠ‚ç‚¹ä¸­çš„æ¯ä¸ªå­—ç¬¦ç®—ä½œä¸€ä¸ªæ ‡è®°ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå¼€å¤´æ®µè½çš„å†…å®¹æ˜¯ <code>&quot;hi&quot;</code>ï¼Œé‚£ä¹ˆä½ç½®
<strong>2</strong> è¡¨ç¤ºåœ¨å­—æ¯ <code>&quot;h&quot;</code> ä¹‹åï¼Œä½ç½® <strong>3</strong> è¡¨ç¤ºåœ¨å­—æ¯ <code>&quot;i&quot;</code> ä¹‹åï¼Œä½ç½® <strong>4</strong> è¡¨ç¤º
æ•´ä¸ªæ®µè½ä¹‹åã€‚</li>
<li>ä¸å…è®¸åŒ…å«å†…å®¹çš„å¶å­èŠ‚ç‚¹ï¼ˆä¾‹å¦‚å›¾ç‰‡ï¼‰ä¹Ÿç®—ä½œä¸€ä¸ªæ ‡è®°ã€‚</li>
</ul>
<p>å¦‚æœæ–‡æ¡£å†…å®¹ç­‰ä»·äºä»¥ä¸‹ HTMLï¼š</p>
<div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">p</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">One</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">p</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">blockquote</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">p</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">Two</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">img</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">src</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">...</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">/&gt;</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">p</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">blockquote</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>é‚£ä¹ˆå¯¹åº”çš„æ ‡è®°åºåˆ—å’Œä½ç½®å¯èƒ½å¦‚ä¸‹ï¼ˆ<code>&lt;p&gt;</code>ã€<code>&lt;blockquote&gt;</code> ç­‰è¢«è§†ä¸ºæ ‡è®°è¾¹ç•Œï¼‰ï¼š</p>
<div class="language-markdown codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-markdown codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">0   1 2 3 4    5</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">p</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"> O n e </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">p</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">5            6   7 8 9 10    11   12            13</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">blockquote</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"> </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">p</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"> T w o </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">img</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"> </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">p</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"> </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">blockquote</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æ¯ä¸ªèŠ‚ç‚¹æœ‰ä¸€ä¸ª <code>nodeSize</code> å±æ€§ï¼Œè¡¨ç¤ºæ•´ä¸ªèŠ‚ç‚¹ï¼ˆåŒ…æ‹¬å¼€å§‹å’Œç»“æŸæ ‡è®°ï¼‰çš„å¤§å°ã€‚æ‚¨å¯ä»¥
ä½¿ç”¨ <code>node.content.size</code> æ¥è·å–èŠ‚ç‚¹å†…å®¹çš„å¤§å°ã€‚è¯·æ³¨æ„ï¼Œå¯¹äºæœ€å¤–å±‚çš„æ–‡æ¡£èŠ‚ç‚¹æ¥è¯´
ï¼Œå®ƒçš„å¼€å§‹å’Œç»“æŸæ ‡è®°ä¸ç®—åœ¨æ–‡æ¡£å¤§å°å†…ï¼ˆå› ä¸ºæ‚¨ä¸èƒ½å°†å…‰æ ‡æ”¾åœ¨æ–‡æ¡£ä¹‹å¤–ï¼‰ï¼Œå› æ­¤æ–‡æ¡£çš„
å¤§å°æ˜¯ <code>doc.content.size</code>ï¼Œè€Œä¸æ˜¯ <code>doc.nodeSize</code>ã€‚</p>
<p>æ‰‹åŠ¨æŒ‰ç…§ä¸Šè¿°æ–¹å¼è®¡ç®—ä½ç½®å¯èƒ½å¾ˆéº»çƒ¦ã€‚æ‚¨å¯ä»¥è°ƒç”¨èŠ‚ç‚¹çš„ <code>resolve</code> æ–¹æ³•æ¥è·å¾—ä¸€ä¸ªæ›´
è¯¦ç»†çš„ç»“æ„ï¼Œè¯¥ç»“æ„ä¼šå‘Šè¯‰æ‚¨è¯¥ä½ç½®æ‰€åœ¨çš„çˆ¶èŠ‚ç‚¹ä»¥åŠç›¸å¯¹äºçˆ¶èŠ‚ç‚¹çš„åç§»ç­‰ä¿¡æ¯ã€‚è¯·æ³¨æ„
åŒºåˆ†â€œå­èŠ‚ç‚¹ç´¢å¼•â€ï¼ˆchild indexï¼‰ã€æ–‡æ¡£èŒƒå›´ä½ç½®ï¼ˆdocument-wide positionï¼‰å’ŒèŠ‚ç‚¹å†…
éƒ¨åç§»ï¼ˆnode-local offsetï¼‰ã€‚</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="åˆ‡ç‰‡-slices">åˆ‡ç‰‡ (Slices)<a href="#åˆ‡ç‰‡-slices" class="hash-link" aria-label="åˆ‡ç‰‡ (Slices)çš„ç›´æ¥é“¾æ¥" title="åˆ‡ç‰‡ (Slices)çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>åœ¨å¤„ç†å¤åˆ¶ç²˜è´´æˆ–æ‹–æ”¾æ—¶ï¼Œéœ€è¦ä½¿ç”¨<strong>æ–‡æ¡£åˆ‡ç‰‡</strong>ï¼ˆsliceï¼‰æ¥è¡¨ç¤ºæ–‡æ¡£ä¸­ä¸¤ä¸ªä½ç½®ä¹‹é—´çš„
å†…å®¹ã€‚è¿™ç§åˆ‡ç‰‡ä¸ åŒäºå®Œæ•´çš„èŠ‚ç‚¹æˆ–ç‰‡æ®µï¼Œå› ä¸ºåˆ‡ç‰‡å¯ä»¥åŒ…å«<strong>æ‰“å¼€çš„èŠ‚ç‚¹</strong>ï¼šå³åœ¨åˆ‡ç‰‡çš„
å¼€å§‹æˆ–ç»“æŸä½ç½®ï¼Œæ–‡æ¡£èŠ‚ç‚¹å¯èƒ½åªè¢«éƒ¨åˆ†åŒ…å«ï¼Œæ²¡æœ‰å®Œæ•´çš„å¼€å§‹æˆ–ç»“æŸæ ‡è®°ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨ä»ä¸€ä¸ªæ®µè½çš„ä¸­é—´é€‰æ‹©åˆ°ä¸‹ä¸€ä¸ªæ®µè½çš„ä¸­é—´ï¼Œé‚£ä¹ˆé€‰æ‹©çš„åˆ‡ç‰‡å°†åŒ…å«ä¸¤ä¸ªæ®µè½
ï¼šç¬¬ä¸€ä¸ªæ®µè½åœ¨èµ·å§‹å¤„æ˜¯â€œæ‰“å¼€â€çš„ï¼Œç¬¬äºŒä¸ªæ®µè½åœ¨ç»“æŸå¤„æ˜¯â€œæ‰“å¼€â€çš„ï¼›è€Œå¦‚æœæ‚¨ä»¥èŠ‚ç‚¹æ–¹å¼
é€‰æ‹©ä¸€ä¸ªæ®µè½ï¼Œé‚£ä¹ˆé€‰æ‹©çš„å°±æ˜¯ä¸€ä¸ªå®Œæ•´çš„æ®µè½èŠ‚ç‚¹ã€‚å¯¹äºæ‰“å¼€çš„èŠ‚ç‚¹ï¼Œå¦‚æœå°†å…¶è§†ä¸ºå®Œæ•´
å†…å®¹æ¥è§£æï¼Œå¯èƒ½ä¼šè¿åæ¨¡å¼çš„çº¦æŸï¼ˆå› ä¸ºæŸäº›å¿…éœ€çš„å­èŠ‚ç‚¹å¯èƒ½ä¸åœ¨æ­¤åˆ‡ç‰‡ä¸­ï¼‰ã€‚</p>
<p>ProseMirror æä¾›äº† <code>Slice</code> æ•°æ®ç»“æ„ç”¨äºè¡¨ç¤ºè¿™æ ·çš„æ–‡æ¡£ç‰‡æ®µã€‚å®ƒå­˜å‚¨äº†ä¸€ä¸ª
<code>Fragment</code>ï¼ˆfragmentï¼‰å¯¹è±¡ä»¥åŠåˆ‡ç‰‡ä¸¤ç«¯çš„æ‰“å¼€æ·±åº¦ï¼ˆopen depthï¼‰ã€‚æ‚¨å¯ä»¥ä½¿ç”¨èŠ‚ç‚¹çš„
<code>slice</code> æ–¹æ³•æ¥è·å–æ–‡æ¡£çš„ä¸€æ®µå†…å®¹åˆ‡ç‰‡ã€‚ä¾‹å¦‚ï¼Œå‡è®¾æ–‡æ¡£åŒ…å«ä¸¤ä¸ªæ®µè½ï¼Œåˆ†åˆ«ä¸º <code>&quot;a&quot;</code>
å’Œ <code>&quot;b&quot;</code>ï¼š</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">// åˆå§‹æ–‡æ¡£ docï¼š&lt;p&gt;a&lt;/p&gt;&lt;p&gt;b&lt;/p&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> slice1 </span><span class="token operator">=</span><span class="token plain"> doc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">slice</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// ä»ä½ç½®0åˆ°3ï¼Œå¯¹åº”ç¬¬ä¸€ä¸ªæ®µè½</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token console class-name">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">slice1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">openStart</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> slice1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">openEnd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// â†’ 0 0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> slice2 </span><span class="token operator">=</span><span class="token plain"> doc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">slice</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// ä»ç¬¬ä¸€ä¸ªæ®µè½çš„ä½ç½®1åˆ°ç¬¬äºŒä¸ªæ®µè½çš„ç»“æŸ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token console class-name">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">slice2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">openStart</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> slice2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">openEnd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// â†’ 1 1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åœ¨ä¸Šä¾‹ä¸­ï¼Œ<code>slice1</code> æ˜¯ä¸€ä¸ªå®Œæ•´çš„æ®µè½ï¼ˆå·¦å³è¾¹ç•Œéƒ½é—­åˆï¼‰ï¼Œè€Œ <code>slice2</code> åˆ™åœ¨ä¸¤ç«¯å„â€œæ‰“
å¼€â€äº†ä¸€ä¸ªèŠ‚ç‚¹ã€‚</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ä¿®æ”¹-changing">ä¿®æ”¹ (Changing)<a href="#ä¿®æ”¹-changing" class="hash-link" aria-label="ä¿®æ”¹ (Changing)çš„ç›´æ¥é“¾æ¥" title="ä¿®æ”¹ (Changing)çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>ç”±äºèŠ‚ç‚¹å’Œç‰‡æ®µæ˜¯æŒä¹…åŒ–ï¼ˆimmutableï¼‰çš„ï¼Œæ‚¨æ°¸è¿œä¸åº”ç›´æ¥ä¿®æ”¹å®ƒä»¬ã€‚æ¯ä¸ªæ–‡æ¡£ã€èŠ‚ç‚¹æˆ–
ç‰‡æ®µåœ¨åˆ›å»ºåéƒ½è¢«è§†ä¸ºä¸€ä¸ªå›ºå®šå€¼ã€‚å¦‚æœæ‚¨æƒ³è¦æ›´æ–°æ–‡æ¡£ï¼Œå°±éœ€è¦<strong>åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡æ¡£
å€¼</strong>ã€‚å¹¸è¿çš„æ˜¯ï¼Œå¦‚æœæ‚¨åˆ›å»ºäº†ä¸€ä¸ªä¿®æ”¹åçš„æ–°æ–‡æ¡£ï¼Œæ–°æ–‡æ¡£ä¼šä¸æ—§æ–‡æ¡£å…±äº«æ‰€æœ‰æœªæ”¹å˜çš„
å­èŠ‚ç‚¹ï¼Œä»è€Œé¿å…é‡å¤åˆ›å»ºï¼Œæé«˜æ€§èƒ½ã€‚</p>
<p>å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ‚¨ä¼šä½¿ç”¨å˜æ¢ï¼ˆtransformsï¼‰æ¥æ›´æ–°æ–‡æ¡£ï¼Œè€Œä¸å¿…ç›´æ¥æ“ä½œèŠ‚ç‚¹ã€‚å˜æ¢ä¼šè®°
å½•ä¸‹æ‰€æœ‰æ›´æ”¹ï¼Œè¿™æ˜¯ç¼–è¾‘å™¨çŠ¶æ€ç®¡ç†å’ŒååŒç¼–è¾‘æ‰€ä¾èµ–çš„æœºåˆ¶ã€‚å¦‚æœæ‚¨ç¡®å®éœ€è¦æ‰‹åŠ¨åˆ›å»ºä¸€
ä¸ªä¿®æ”¹åçš„æ–‡æ¡£ï¼Œå¯ä»¥ä½¿ç”¨ <code>Node</code> å’Œ <code>Fragment</code> æä¾›çš„ä¸€äº›è¾…åŠ©æ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥ä½¿
ç”¨ <code>Node.replace</code> æ–¹æ³•æ¥æ›¿æ¢æ–‡æ¡£çš„æŸä¸ªèŒƒå›´ï¼Œæˆ–è€…ä½¿ç”¨ <code>copy</code> æ–¹æ³•å¤åˆ¶èŠ‚ç‚¹å¹¶æ›¿æ¢å…¶
å†…å®¹ã€‚<code>Fragment</code> ç±»å‹ä¹Ÿæä¾›äº†ç±»ä¼¼çš„æ›´æ–°æ–¹æ³•ï¼Œæ¯”å¦‚ <code>replaceChild</code> å’Œ <code>append</code> ç­‰
ã€‚</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="æ¨¡å¼-schemas">æ¨¡å¼ (Schemas)<a href="#æ¨¡å¼-schemas" class="hash-link" aria-label="æ¨¡å¼ (Schemas)çš„ç›´æ¥é“¾æ¥" title="æ¨¡å¼ (Schemas)çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>æ¯ä¸ª ProseMirror æ–‡æ¡£éƒ½æœ‰ä¸€ä¸ªå…³è”çš„æ¨¡å¼ï¼ˆschemaï¼‰ã€‚æ¨¡å¼æè¿°äº†æ–‡æ¡£ä¸­å¯èƒ½å‡ºç°çš„èŠ‚
ç‚¹ç±»å‹åŠå…¶åµŒå¥—å…³ç³»ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªæ¨¡å¼å¯èƒ½è§„å®šï¼šé¡¶å±‚æ–‡æ¡£èŠ‚ç‚¹(<code>doc</code>)å¯ä»¥åŒ…å«ä¸€ä¸ªæˆ–å¤š
ä¸ªå—çº§èŠ‚ç‚¹ï¼ˆå¦‚æ®µè½ï¼‰ï¼Œæ®µè½èŠ‚ç‚¹å¯ä»¥åŒ…å«ä»»æ„æ•°é‡çš„å†…è”èŠ‚ç‚¹å’Œæ ‡è®°ã€‚ProseMirror æä¾›
äº†ä¸€ä¸ªåŸºç¡€çš„æ¨¡å¼åŒ…
ï¼ˆ<a href="https://prosemirror.net/docs/ref/#schema-basic" target="_blank" rel="noopener noreferrer"><code>prosemirror-schema-basic</code></a>ï¼‰
ï¼Œä½† ProseMirror çš„ä¼˜åŠ¿ä¹‹ä¸€æ˜¯æ‚¨å¯ä»¥è‡ªå®šä¹‰è‡ªå·±çš„æ¨¡å¼ä»¥æ»¡è¶³éœ€æ±‚ã€‚</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="èŠ‚ç‚¹ç±»å‹-node-types">èŠ‚ç‚¹ç±»å‹ (Node Types)<a href="#èŠ‚ç‚¹ç±»å‹-node-types" class="hash-link" aria-label="èŠ‚ç‚¹ç±»å‹ (Node Types)çš„ç›´æ¥é“¾æ¥" title="èŠ‚ç‚¹ç±»å‹ (Node Types)çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>åœ¨æ¨¡å¼ä¸­ï¼Œæ‚¨éœ€è¦åˆ—ä¸¾å‡ºæ‰€æœ‰å¯èƒ½å‡ºç°çš„èŠ‚ç‚¹ç±»å‹ï¼Œå¹¶ä¸ºæ¯ä¸ªèŠ‚ç‚¹ç±»å‹æä¾›ä¸€ä¸ªè§„èŒƒå¯¹è±¡
ï¼ˆspecï¼‰ï¼Œè¯´æ˜è¯¥ç±»å‹çš„åç§°ã€å†…å®¹æ¨¡å‹å’Œå±æ€§ç­‰ã€‚ä¾‹å¦‚ï¼š</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> trivialSchema </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">Schema</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token literal-property property">nodes</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token literal-property property">doc</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token literal-property property">content</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;paragraph+&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token literal-property property">paragraph</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token literal-property property">content</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;text*&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token literal-property property">text</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token literal-property property">inline</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">/* ... å…¶ä»–èŠ‚ç‚¹ç±»å‹ ... */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä»¥ä¸Šç¤ºä¾‹å®šä¹‰äº†è¿™æ ·ä¸€ä¸ª  æ¨¡å¼ï¼šæ–‡æ¡£(<code>doc</code>)èŠ‚ç‚¹å¯ä»¥åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªæ®µè½(<code>paragraph</code>)ï¼Œ
æ¯ä¸ªæ®µè½å¯ä»¥åŒ…å«é›¶ä¸ªæˆ–å¤šä¸ªæ–‡æœ¬èŠ‚ç‚¹(<code>text</code>)ã€‚æ¯ä¸ªæ¨¡å¼è‡³å°‘éœ€è¦å®šä¹‰ä¸€ä¸ªé¡¶å±‚èŠ‚ç‚¹ç±»å‹
ï¼ˆé»˜è®¤ä¸º <code>&quot;doc&quot;</code>ï¼Œä¹Ÿå¯ä»¥é…ç½®ï¼‰ä»¥åŠä¸€ä¸ªæ–‡æœ¬èŠ‚ç‚¹ç±»å‹ï¼ˆ<code>text</code>ï¼‰ã€‚å¯¹äºå†…è”èŠ‚ç‚¹ï¼Œé€šå¸¸
éœ€è¦åœ¨è§„èŒƒä¸­å£°æ˜ <code>inline: true</code>ï¼Œä½† <code>text</code> ç±»å‹é»˜è®¤ä¸ºå†…è”ï¼Œæ‰€ä»¥å¯çœç•¥è¯¥å±æ€§ã€‚</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="å†…å®¹è¡¨è¾¾å¼-content-expressions">å†…å®¹è¡¨è¾¾å¼ (Content Expressions)<a href="#å†…å®¹è¡¨è¾¾å¼-content-expressions" class="hash-link" aria-label="å†…å®¹è¡¨è¾¾å¼ (Content Expressions)çš„ç›´æ¥é“¾æ¥" title="å†…å®¹è¡¨è¾¾å¼ (Content Expressions)çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>ç¤ºä¾‹ä¸­ <code>content</code> å­—æ®µä½¿ç”¨çš„å­—ç¬¦ä¸²ç§°ä¸ºå†…å®¹è¡¨è¾¾å¼ï¼ˆcontent expressionï¼‰ã€‚å®ƒæŒ‡å®šäº†
è¯¥èŠ‚ç‚¹ç±»å‹å¯æ¥å—çš„å­èŠ‚ç‚¹åºåˆ—ã€‚ä¾‹å¦‚ï¼Œ<code>&quot;paragraph+&quot;</code> è¡¨ç¤ºä¸€ä¸ªæˆ–å¤šä¸ªæ®µè½
ï¼Œ<code>&quot;paragraph*&quot;</code> è¡¨ç¤ºé›¶ä¸ªæˆ–å¤šä¸ªæ®µè½ï¼Œ<code>&quot;caption?&quot;</code> è¡¨ç¤ºé›¶ä¸ªæˆ–ä¸€ä¸ªæ ‡é¢˜èŠ‚ç‚¹ã€‚æ‚¨è¿˜å¯
ä»¥åœ¨åç§°åä½¿ç”¨å¤§æ‹¬å·æ¥é™å®šé‡å¤æ¬¡æ•°ï¼Œä¾‹å¦‚ <code>{2}</code>ï¼ˆæ°å¥½ä¸¤ä¸ªï¼‰ã€<code>{1,5}</code>ï¼ˆè‡³å°‘ä¸€ä¸ªï¼Œ
æœ€å¤šäº”ä¸ªï¼‰ã€<code>{2,}</code>ï¼ˆè‡³å°‘ä¸¤ä¸ªï¼‰ç­‰ã€‚æ‚¨ä¹Ÿå¯ä»¥ç»„åˆè¡¨è¾¾å¼ï¼Œä¾‹å¦‚
<code>&quot;heading paragraph+&quot;</code> è¡¨ç¤ºä¸€ä¸ªæ ‡é¢˜åè·Ÿä¸€ä¸ªæˆ–å¤šä¸ªæ®µè½ï¼›ä½¿ç”¨ç®¡é“ç¬¦å¯ä»¥æŒ‡å®šé€‰æ‹©ï¼Œ
ä¾‹å¦‚ <code>&quot;(paragraph|blockquote)+&quot;</code> è¡¨ç¤ºä¸€ä¸ªæˆ–å¤šä¸ªæ®µè½æˆ–å—å¼•ç”¨ã€‚</p>
<p>æœ‰æ—¶æ‚¨å¸Œæœ›æŸäº›èŠ‚ç‚¹ç±»å‹å¯ä»¥å¤ç”¨åœ¨æ¨¡å¼çš„å¤šä¸ªä½ç½®ï¼Œä¾‹å¦‚ï¼Œå®šä¹‰ä¸€ä¸ªåä¸º <code>&quot;block&quot;</code> çš„
èŠ‚ç‚¹ç»„ï¼Œå…¶ä¸­åŒ…å«æ®µè½å’Œå—å¼•ç”¨ã€‚å¯ä»¥åœ¨èŠ‚ç‚¹ç±»å‹çš„è§„èŒƒä¸­ä½¿ç”¨ <code>group</code> å±æ€§ï¼Œä¾‹å¦‚ï¼š</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> groupSchema </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">Schema</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token literal-property property">nodes</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token literal-property property">doc</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token literal-property property">content</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;block+&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token literal-property property">paragraph</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token literal-property property">group</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;block&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token literal-property property">content</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;text*&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token literal-property property">blockquote</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token literal-property property">group</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;block&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token literal-property property">content</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;block+&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token literal-property property">text</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åœ¨è¿™ä¸ªæ¨¡å¼ä¸­ï¼Œ<code>&quot;block+&quot;</code> ç­‰ä»·äº <code>&quot;(paragraph|blockquote)+&quot;</code>ã€‚å»ºè®®è¦æ±‚å—çº§èŠ‚ç‚¹ç±»
å‹ï¼ˆå¦‚ç¤ºä¾‹ä¸­çš„ <code>doc</code> æˆ– <code>blockquote</code>ï¼‰è‡³å°‘æœ‰ä¸€ä¸ªå­èŠ‚ç‚¹ï¼ˆä½¿ç”¨ <code>+</code> è€Œé <code>*</code>ï¼‰ï¼Œå› 
ä¸ºå¦‚æœä¸€ä¸ªå…ƒç´ ä¸ºç©ºï¼Œæµè§ˆå™¨é€šå¸¸ä¼šæŠ˜å å®ƒï¼Œä½¿å…¶å˜å¾—ä¸å¯è§ï¼Œè¿™ä¼š å¯¼è‡´ç¼–è¾‘ä½“éªŒå¾ˆå·®ã€‚</p>
<p>åœ¨æˆ–è¡¨è¾¾å¼ï¼ˆor expressionï¼‰ä¸­ï¼Œé¡ºåºå¾ˆé‡è¦ã€‚å½“ç¼–è¾‘å™¨éœ€è¦åˆ›å»ºä¸€ä¸ªèŠ‚ç‚¹çš„é»˜è®¤å®ä¾‹ï¼ˆ
æ¯”å¦‚åœ¨æ‰§è¡Œ <code>replace</code> ä¹‹ç±»çš„å˜æ¢åç¡®ä¿æ–‡æ¡£ä»ç„¶æœ‰æ•ˆæ—¶ï¼‰ï¼Œå®ƒä¼šé€‰æ‹©è¡¨è¾¾å¼ä¸­çš„ç¬¬ä¸€ä¸ª
ç±»å‹ã€‚å¦‚æœç¬¬ä¸€ä¸ªæ˜¯ç»„åï¼Œåˆ™é€‰ç¬¬ä¸€ä¸ªç»„æˆå‘˜ã€‚ä¾‹å¦‚ï¼Œå¦‚æœäº¤æ¢äº†ä¸Šä¾‹ä¸­ <code>&quot;paragraph&quot;</code>
å’Œ <code>&quot;blockquote&quot;</code> çš„é¡ºåºï¼Œç¼–è¾‘å™¨å¯èƒ½ä¼šå°è¯•åˆ›å»ºä¸€ä¸ª <code>blockquote</code>ï¼Œè€Œæ ¹æ®å†…å®¹æ¨¡å‹
ï¼Œ<code>blockquote</code> ä¸­åˆéœ€è¦ä¸€ä¸ªå—èŠ‚ç‚¹ï¼Œç»“æœå†æ¬¡å°è¯•åˆ›å»º <code>blockquote</code>ï¼Œå¦‚æ­¤å¾ªç¯ä¸‹å»ä¼š
å¯¼è‡´é”™è¯¯ã€‚è‹¥éœ€è¦ç¡®ä¿ç¼–è¾‘å™¨èƒ½è‡ªåŠ¨å¡«å……ç¼ºå¤±çš„èŠ‚ç‚¹ï¼Œè¯·å§‹ç»ˆå°†æ¨¡å¼çš„ç¬¬ä¸€ä¸ªå¯é€‰ç±»å‹æ”¾åœ¨
æœ€å‰ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¹¶éæ‰€æœ‰èŠ‚ç‚¹æ“ä½œå‡½æ•°éƒ½ä¼šæ£€æŸ¥å†…å®¹çš„æœ‰æ•ˆæ€§ã€‚å˜æ¢ï¼ˆtransformsï¼‰ä¼šæ£€æŸ¥
æ¨¡å¼çº¦æŸï¼Œä½†åŸå§‹çš„èŠ‚ç‚¹åˆ›å»ºå‡½æ•°é€šå¸¸ä¸ä¼šï¼Œå› æ­¤æ‚¨å¯ä»¥é€šè¿‡ <code>NodeType.create</code> åˆ›å»ºä¸
ç¬¦åˆæ¨¡å¼çš„èŠ‚ç‚¹ã€‚å¯¹äºå­˜åœ¨æ­¤éœ€æ±‚çš„åœºæ™¯ï¼Œè¿™æ˜¯ä¸€ç§åˆç†çš„åšæ³•ï¼ˆä¾‹å¦‚åœ¨åˆ‡ç‰‡è¾¹ç•Œä¸Šåˆ›å»ºâ€œ
æ‰“å¼€â€èŠ‚ç‚¹æ—¶ï¼‰ã€‚ProseMirror ä¹Ÿæä¾›äº† <code>createChecked</code> æ–¹æ³•å’Œ <code>check</code> æ–¹æ³•ï¼Œå¯ä»¥åœ¨
åˆ›å»ºåæ£€æŸ¥æˆ–æ–­è¨€èŠ‚ç‚¹çš„å†…å®¹æ˜¯å¦åˆæ³•ã€‚</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="æ ‡è®°-marks">æ ‡è®° (Marks)<a href="#æ ‡è®°-marks" class="hash-link" aria-label="æ ‡è®° (Marks)çš„ç›´æ¥é“¾æ¥" title="æ ‡è®° (Marks)çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>**æ ‡è®°ï¼ˆmarksï¼‰**ç”¨äºä¸ºå†…è”å†…å®¹æ·»åŠ é¢å¤–çš„æ ·å¼æˆ–ä¿¡æ¯ã€‚æ¨¡å¼å¿…é¡»å£°æ˜æ‰€æœ‰å¯èƒ½å‡º
ç°çš„æ ‡è®°ç±»å‹ã€‚æ ‡è®°ç±»å‹ç±»ä¼¼äºèŠ‚ç‚¹ç±»å‹ï¼Œä¹Ÿæ˜¯ç”±æ¨¡å¼å®šä¹‰çš„åç§°ï¼Œç”¨äºæ ‡è®°æ–‡æœ¬æˆ–èŠ‚ç‚¹ä¸Š
æ‰€åº”ç”¨çš„ç‰¹å®šæ ·å¼ï¼ˆå¦‚ç²—ä½“ã€æ–œä½“ã€ä¸‹åˆ’çº¿ã€é“¾æ¥ç­‰ï¼‰ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå…·æœ‰å†…è”å†…å®¹çš„èŠ‚ç‚¹
å…è®¸åº”ç”¨æ¨¡å¼ä¸­å®šä¹‰çš„æ‰€æœ‰æ ‡è®°ã€‚æ‚¨å¯ä»¥åœ¨èŠ‚ç‚¹è§„èŒƒä¸­é€šè¿‡ <code>marks</code> å±æ€§é™åˆ¶å…è®¸çš„æ ‡è®°
  ã€‚ä¾‹å¦‚ï¼š</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> markSchema </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">Schema</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token literal-property property">nodes</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token literal-property property">doc</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token literal-property property">content</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;block+&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token literal-property property">paragraph</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token literal-property property">group</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;block&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token literal-property property">content</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;text*&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token literal-property property">marks</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;_&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token literal-property property">heading</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token literal-property property">group</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;block&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token literal-property property">content</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;text*&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token literal-property property">marks</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token literal-property property">text</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token literal-property property">inline</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token literal-property property">marks</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token literal-property property">strong</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token literal-property property">em</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¿™ä¸ªæ¨¡å¼å®šä¹‰äº†ä¸¤ä¸ªæ ‡è®°ç±»å‹ï¼š<code>strong</code> å’Œ <code>em</code>ã€‚æ®µè½èŠ‚ç‚¹å…è®¸ä½¿ç”¨è¿™äº›æ ‡è®°
ï¼ˆ<code>marks: &quot;_&quot;</code> è¡¨ç¤ºå…è®¸ä»»ä½•æ ‡è®°ï¼‰ï¼Œè€Œæ ‡é¢˜èŠ‚ç‚¹ (<code>heading</code>) è§„å®šä¸å…è®¸ä»»ä½•æ ‡è®°
ï¼ˆ<code>marks: &quot;&quot;</code> è¡¨ç¤ºç©ºé›†ï¼‰ã€‚åœ¨å†…å®¹è¡¨è¾¾å¼ä¸­ï¼Œæ ‡è®°é›†åˆå¯ä»¥å†™æˆç”¨ç©ºæ ¼åˆ†éš”çš„æ ‡è®°åç§°æˆ–
åˆ†ç»„åç§°ï¼›<code>&quot;_&quot;</code> è¡¨ç¤ºé€šé…ç¬¦ï¼Œç©ºå­—ç¬¦ä¸²è¡¨ç¤ºä¸å…è®¸ä»»ä½•æ ‡è®°ã€‚</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="å±æ€§-attributes">å±æ€§ (Attributes)<a href="#å±æ€§-attributes" class="hash-link" aria-label="å±æ€§ (Attributes)çš„ç›´æ¥é“¾æ¥" title="å±æ€§ (Attributes)çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>æ¨¡å¼è¿˜å¯ä»¥ä¸ºæ¯ä¸ªèŠ‚ç‚¹ç±»å‹æˆ–æ ‡è®°ç±»å‹å®šä¹‰å±æ€§ï¼ˆattrsï¼‰ã€‚å¦‚æœä¸€ä¸ªèŠ‚ç‚¹ç±»å‹éœ€è¦å­˜å‚¨é¢
å¤–çš„ä¿¡æ¯ï¼ˆä¾‹å¦‚ <code>heading</code> ç±»å‹é€šå¸¸ä¼šæœ‰ä¸€ä¸ª <code>level</code> å±æ€§è¡¨ç¤ºæ ‡é¢˜çº§åˆ«ï¼‰ï¼Œå¯ä»¥åœ¨å…¶è§„
èŒƒä¸­ä½¿ç”¨ <code>attrs</code> å­—æ®µã€‚å±æ€§é›†æ˜¯æ™®é€šçš„å¯¹è±¡ï¼Œæ¯ä¸ªé”®å¯¹åº”ä¸€ä¸ªå±æ€§åï¼Œå€¼ä¸ºè¯¥å±æ€§çš„è®¾
ç½®ã€‚ä¾‹å¦‚ï¼š</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token literal-property property">heading</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token literal-property property">content</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;text*&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token literal-property property">attrs</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token literal-property property">level</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token keyword module" style="color:rgb(189, 147, 249);font-style:italic">default</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œæ¯ä¸ª <code>heading</code> èŠ‚ç‚¹éƒ½æœ‰ <code>.attrs.level</code> å±æ€§ï¼Œå¦‚æœåœ¨åˆ›å»ºæ—¶æ²¡æœ‰æŒ‡å®šçº§
åˆ«ï¼Œåˆ™é»˜è®¤ä¸º 1ã€‚å¦‚æœæŸä¸ªå± æ€§æ²¡æœ‰æä¾›é»˜è®¤å€¼ï¼Œé‚£ä¹ˆå½“æ‚¨å°è¯•åˆ›å»ºè¯¥èŠ‚ç‚¹è€Œæ²¡æœ‰æŒ‡å®šè¯¥å±
æ€§æ—¶ï¼Œå°†ä¼šæŠ›å‡ºé”™è¯¯ã€‚è¿™ä¹Ÿæ„å‘³ç€ç¼–è¾‘å™¨æ— æ³•è‡ªåŠ¨ç”Ÿæˆæ­¤ç±»èŠ‚ç‚¹æ¥æ»¡è¶³æ¨¡å¼çš„çº¦æŸï¼Œå› æ­¤ä¸
èƒ½å°†å¿…é¡»å‡ºç°å´æ²¡æœ‰é»˜è®¤å€¼çš„èŠ‚ç‚¹æ”¾åœ¨å¿…éœ€ä½ç½®ï¼ˆrequired positionï¼‰ã€‚æ¢è¨€ä¹‹ï¼Œåªæœ‰ä¸º
æ¯ä¸ªå¯èƒ½çš„å±æ€§æä¾›äº†é»˜è®¤å€¼æ—¶ï¼Œç¼–è¾‘å™¨æ‰èƒ½åœ¨å¿…è¦æ—¶æ’å…¥ç©ºèŠ‚ç‚¹æ¥å¡«è¡¥ç¼ºå¤±å†…å®¹ã€‚</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="åºåˆ—åŒ–å’Œè§£æ-serialization-and-parsing">åºåˆ—åŒ–å’Œè§£æ (Serialization and Parsing)<a href="#åºåˆ—åŒ–å’Œè§£æ-serialization-and-parsing" class="hash-link" aria-label="åºåˆ—åŒ–å’Œè§£æ (Serialization and Parsing)çš„ç›´æ¥é“¾æ¥" title="åºåˆ—åŒ–å’Œè§£æ (Serialization and Parsing)çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>ä¸ºäº†åœ¨æµè§ˆå™¨ä¸­ç¼–è¾‘æ–‡æ¡£èŠ‚ç‚¹ï¼Œå¿…é¡»èƒ½å¤Ÿå°†æ–‡æ¡£èŠ‚ç‚¹æ¸²æŸ“åˆ° DOM ä¸­ã€‚æœ€ç®€å•çš„æ–¹æ³•æ˜¯ï¼Œåœ¨
æ¨¡å¼ä¸­ä¸ºæ¯ä¸ªèŠ‚ç‚¹ç±»å‹æŒ‡å®šå®ƒçš„ DOM è¡¨ç°æ–¹å¼ï¼Œè¿™å¯ä»¥é€šè¿‡åœ¨èŠ‚ç‚¹è§„èŒƒä¸­æ·»åŠ  <code>toDOM</code> å‡½
æ•°æ¥å®ç°ã€‚ä¾‹å¦‚ï¼š</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> schema </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">Schema</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token literal-property property">nodes</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token literal-property property">doc</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token literal-property property">content</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;paragraph+&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token literal-property property">paragraph</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token literal-property property">content</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;text*&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token function" style="color:rgb(80, 250, 123)">toDOM</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">node</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;p&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token literal-property property">text</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token literal-property property">inline</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä¸Šè¿°ä»£ç ä¸­çš„ <code>[&quot;p&quot;, 0]</code> è¡¨æ˜æ®µè½èŠ‚ç‚¹åœ¨ DOM ä¸­åº”æ¸²æŸ“ä¸ºä¸€ä¸ª <code>&lt;p&gt;</code> æ ‡ç­¾ï¼Œ<code>0</code> è¡¨ç¤ºä¸€
ä¸ªâ€œå ä½ç¬¦â€ï¼ŒèŠ‚ç‚¹çš„å†…å®¹å°†è¢«æ¸²æŸ“åˆ°æ­¤å¤„ã€‚æ‚¨ä¹Ÿå¯ä»¥åœ¨æ ‡ç­¾åé¢æ·»åŠ ä¸€ä¸ªå¯¹è±¡æ¥æŒ‡å®š HTML
å±æ€§ï¼Œä¾‹å¦‚ <code>[&quot;div&quot;, {class: &quot;c&quot;}, 0]</code>ã€‚å¶å­èŠ‚ç‚¹ï¼ˆå¦‚ <code>image</code>ï¼‰å¦‚æœæ²¡æœ‰å†…å®¹ï¼Œåˆ™å…¶
<code>toDOM</code> è¿”å›çš„æ•°ç»„ä¸­ä¸éœ€è¦å ä½ç¬¦ï¼Œå› ä¸ºæ²¡æœ‰é¢å¤–å†…å®¹è¦æ¸²æŸ“ã€‚</p>
<p>æ‚¨è¿˜éœ€è¦èƒ½å¤Ÿä» DOM è§£ææ–‡æ¡£ï¼Œä¾‹å¦‚åœ¨ç”¨æˆ·ç²˜è´´æˆ–æ‹–æ”¾æ—¶ã€‚ProseMirror æä¾›äº†è§£æåŠŸèƒ½
ï¼Œæ‚¨å¯ä»¥åœ¨æ¨¡å¼ä¸­ä½¿ç”¨ <code>parseDOM</code> æŒ‡å®šè§£æè§„åˆ™ï¼šæ¯ä¸ªè§„åˆ™æè¿°äº†å¦‚ä½•å°†æŸç§ DOM ç»“æ„
æ˜ å°„ä¸ºèŠ‚ç‚¹æˆ–æ ‡è®°ã€‚ä¾‹å¦‚ï¼Œ<code>prosemirror-schema-basic</code> å¯¹ <code>em</code>ï¼ˆæ–œä½“ï¼‰æ ‡è®°æä¾›äº†å¦‚ä¸‹
è§£æè§„åˆ™ï¼š</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token literal-property property">parseDOM</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token literal-property property">tag</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;em&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// åŒ¹é… &lt;em&gt; å…ƒç´ </span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token literal-property property">tag</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;i&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// åŒ¹é… &lt;i&gt; å…ƒç´ </span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token literal-property property">style</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;font-style=italic&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// åŒ¹é…å†…è”æ ·å¼ &#x27;font-style: italic&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åœ¨ä¸Šä¾‹ä¸­ï¼Œ<code>tag</code> å¯ä»¥æ˜¯ä¸€ä¸ª CSS é€‰æ‹©å™¨ï¼Œä¾‹å¦‚ <code>&quot;div.highlight&quot;</code>ï¼›<code>style</code> å¯ä»¥åŒ¹é…
å†…è”çš„ CSS æ ·å¼ã€‚è‹¥æ¨¡å¼ä¸­åŒ…å«äº† <code>parseDOM</code> è§„åˆ™ï¼Œæ‚¨å¯ä»¥é€šè¿‡
<code>DOMParser.fromSchema(schema)</code> åˆ›å»ºä¸€ä¸ªé»˜è®¤çš„ DOM è§£æå™¨ï¼Œç¼–è¾‘å™¨ä¼šä½¿ç”¨å®ƒæ¥å¤„ç†å‰ª
è´´æ¿å†…å®¹çš„ç²˜è´´ï¼Œä¹Ÿå¯ä»¥è‡ªè¡Œè¦†ç›–è¯¥è§£æå™¨ã€‚</p>
<p>æœ€åï¼ŒProseMirror æ–‡æ¡£è¿˜æ”¯æŒå†…ç½®çš„ JSON åºåˆ—åŒ–æ ¼å¼ã€‚æ‚¨å¯ä»¥è°ƒç”¨æ–‡æ¡£å¯¹è±¡çš„
<code>toJSON</code> æ–¹æ³•ç”Ÿæˆä¸€ä¸ªå¯ç”¨äº <code>JSON.stringify</code> çš„è¡¨ç¤ºï¼Œç„¶åä½¿ç”¨æ¨¡å¼çš„
<code>nodeFromJSON</code> æ–¹æ³•å°†å…¶è§£æå›æ–‡æ¡£å¯¹è±¡ã€‚</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="æ‰©å±•æ¨¡å¼-extending-a-schema">æ‰©å±•æ¨¡å¼ (Extending a Schema)<a href="#æ‰©å±•æ¨¡å¼-extending-a-schema" class="hash-link" aria-label="æ‰©å±•æ¨¡å¼ (Extending a Schema)çš„ç›´æ¥é“¾æ¥" title="æ‰©å±•æ¨¡å¼ (Extending a Schema)çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>ä¼ é€’ç»™ <code>Schema</code> æ„é€ å‡½æ•°çš„ <code>nodes</code> å’Œ <code>marks</code> é€‰é¡¹å¯ä»¥æ˜¯æœ‰åºæ˜ å°„ (OrderedMap) å¯¹
è±¡æˆ–æ™®é€šå¯¹è±¡ã€‚æ¨¡å¼å®ä¾‹çš„ <code>spec.nodes</code> å’Œ <code>spec.marks</code> å±æ€§æ€»æ˜¯æœ‰åºæ˜ å°„ï¼Œè¿™ä½¿å¾—åœ¨
æ­¤åŸºç¡€ä¸Šåˆ›å»ºæ–°æ¨¡å¼æ›´åŠ æ–¹ä¾¿ã€‚è¿™äº›æ˜ å°„æ”¯æŒä¸€äº›æ–¹æ³•æ¥æ´¾ç”Ÿæ›´æ–°çš„æ˜ å°„ã€‚ä¾‹å¦‚ï¼Œå‡è®¾æœ‰ä¸€
ä¸ªç°æœ‰æ¨¡å¼ <code>schema</code>ï¼Œæ‚¨å¯ä»¥æ‰§è¡Œ <code>schema.spec.nodes.remove(&quot;blockquote&quot;)</code> æ¥å¾—åˆ°
ä¸€ä¸ªå»é™¤äº† <code>blockquote</code> èŠ‚ç‚¹çš„èŠ‚ç‚¹é›†åˆï¼Œç„¶åå°†å…¶ä½œä¸ºæ–°çš„ <code>nodes</code> ä¼ ç»™ <code>Schema</code>
æ¥æ„é€ ä¸€ä¸ªæ–°æ¨¡å¼ã€‚å¦å¤–
ï¼Œ<a href="https://prosemirror.net/docs/ref/#schema-list" target="_blank" rel="noopener noreferrer">prosemirror-schema-list</a> æ¨¡å—
å¯¼å‡ºäº†ä¸€ä¸ªä¾¿æ·æ–¹æ³•ï¼Œå¯ä»¥å°†åˆ—è¡¨æ¨¡å—ä¸­çš„èŠ‚ç‚¹ç±»å‹ï¼ˆå¦‚åµŒå¥—åˆ—è¡¨ï¼‰æ·»åŠ åˆ°ç°æœ‰æ¨¡å¼ä¸­ã€‚</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="æ–‡æ¡£å˜æ¢-document-transformations">æ–‡æ¡£å˜æ¢ (Document transformations)<a href="#æ–‡æ¡£å˜æ¢-document-transformations" class="hash-link" aria-label="æ–‡ æ¡£å˜æ¢ (Document transformations)çš„ç›´æ¥é“¾æ¥" title="æ–‡æ¡£å˜æ¢ (Document transformations)çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>å˜æ¢ï¼ˆtransformsï¼‰æ˜¯ ProseMirror å·¥ä½œçš„æ ¸å¿ƒã€‚å®ƒä»¬æ„æˆäº‹åŠ¡ï¼ˆtransactionï¼‰çš„åŸºç¡€ï¼Œ
å¹¶è®©æ’¤é”€å†å²å’ŒååŒç¼–è¾‘æˆä¸ºå¯èƒ½ã€‚ä¸ºä»€ä¹ˆä¸ç›´æ¥å°±åœ°ä¿®æ”¹æ–‡æ¡£ï¼ŸåŸå› æœ‰å¾ˆå¤šï¼šé¦–å…ˆï¼Œä½¿ç”¨
ä¸å¯å˜æ•°æ®ç»“æ„ï¼ˆimmutable data structureï¼‰å¯ä»¥è®©ä»£ç æ›´å¥å£®ï¼›æ›´é‡è¦çš„æ˜¯ï¼Œå˜æ¢ç³»ç»Ÿ
å¯ä»¥è®°å½•æ›´æ–°è½¨è¿¹ï¼Œä»¥æ­¥éª¤ï¼ˆstepsï¼‰çš„å½¢å¼æè¿°ä»æ—§æ–‡æ¡£åˆ°æ–°æ–‡æ¡£æ‰€åšçš„å…·ä½“æ›´æ”¹ã€‚è¿™å¯¹
äºå®ç°æ’¤é”€å†å²è‡³å…³é‡è¦ï¼Œå› ä¸ºæ’¤é”€å†å²éœ€è¦å­˜å‚¨è¿™äº›æ­¥éª¤çš„é€†æ“ä½œã€‚å¦å¤–ï¼ŒååŒç¼–è¾‘ç³»ç»Ÿ
å°†è¿™äº›æ­¥éª¤å‘é€ç»™å…¶å®ƒç”¨æˆ·æˆ–æœåŠ¡å™¨ï¼Œä»¥ç¡®ä¿å¤šä¸ªç¼–è¾‘è€…çš„æ–‡æ¡£å¯ä»¥è‡ªåŠ¨åˆå¹¶ã€‚</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ä¸ºä»€ä¹ˆ-why">ä¸ºä»€ä¹ˆ (Why?)<a href="#ä¸ºä»€ä¹ˆ-why" class="hash-link" aria-label="ä¸ºä»€ä¹ˆ (Why?)çš„ç›´æ¥é“¾æ¥" title="ä¸ºä»€ä¹ˆ (Why?)çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>æ¯æ¬¡æ›´æ”¹éƒ½ä¼šç”Ÿæˆä¸€ä¸ªæˆ–å¤šä¸ªæ­¥éª¤ï¼ˆStepï¼‰ã€‚è™½ç„¶æ‚¨ä¸€èˆ¬ä¸éœ€è¦ç›´æ¥æ“ä½œæ­¥éª¤ï¼Œä½†äº†è§£å®ƒä»¬
çš„åŸç†å¾ˆæœ‰å¸®åŠ©ã€‚ä¾‹å¦‚ï¼Œ<code>ReplaceStep</code> ç”¨äºåœ¨æ–‡æ¡£ä¸­æ›¿æ¢ä¸€æ®µå†…å®¹ï¼Œ<code>AddMarkStep</code> ç”¨äº
åœ¨æŒ‡å®šèŒƒå›´å†…æ·»åŠ æ ‡è®°ã€‚ä¸€ä¸ªæ­¥éª¤å¯ä»¥åº”ç”¨åˆ°æ–‡æ¡£ä¸Šä»¥ç”Ÿæˆä¸€ä¸ªæ–°æ–‡æ¡£ï¼š</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token console class-name">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">myDoc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">toString</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// â†’ p(&quot;hello&quot;)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// ä¸€ä¸ªåˆ é™¤ 3 åˆ° 5 ä¹‹é—´å†…å®¹çš„æ­¥éª¤</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> step </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">ReplaceStep</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token maybe-class-name">Slice</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">empty</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> result </span><span class="token operator">=</span><span class="token plain"> step</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">apply</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">myDoc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token console class-name">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">result</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">doc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">toString</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// â†’ p(&quot;heo&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åº”ç”¨æ­¥éª¤ä¸ä¼šè‡ªåŠ¨å¡«è¡¥æ¨¡å¼çº¦æŸæˆ–è°ƒæ•´èŠ‚ç‚¹ï¼Œå®ƒåªä¼šå­—é¢åœ°ä¿®æ”¹æ–‡æ¡£ã€‚å¦‚æœæ­¥éª¤æ— æ³•åº”ç”¨ï¼ˆ
ä¾‹å¦‚ï¼Œä»…åˆ é™¤äº†ä¸€ä¸ªæ ‡ç­¾çš„èµ·å§‹ä»¤ç‰Œï¼Œè¿™ä¼šå¯¼è‡´ä¸å¹³è¡¡ï¼‰ï¼Œåˆ™ <code>apply</code> æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªåŒ…
å«é”™è¯¯ä¿¡æ¯çš„ç»“æœå¯¹è±¡è€Œä¸æ˜¯æ–‡æ¡£ã€‚å› æ­¤ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šä½¿ç”¨æ›´é«˜çº§çš„å·¥å…·æ¥ç”Ÿæˆæ­¥éª¤ï¼Œè€Œä¸
æ‰‹åŠ¨æ„é€ å®ƒä»¬ã€‚</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="å˜æ¢-transforms">å˜æ¢ (Transforms)<a href="#å˜æ¢-transforms" class="hash-link" aria-label="å˜æ¢ (Transforms)çš„ç›´æ¥é“¾æ¥" title="å˜æ¢ (Transforms)çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>ä¸€æ¬¡ç¼–è¾‘æ“ä½œå¯èƒ½äº§ç”Ÿå¤šä¸ªæ­¥éª¤ã€‚æ–¹ä¾¿çš„æ–¹æ³•æ˜¯åˆ›å»ºä¸€ä¸ª <code>Transform</code> å¯¹è±¡ï¼ˆè‹¥åœ¨ç¼–è¾‘å™¨
çŠ¶æ€èŒƒå›´å†…å·¥ä½œï¼Œå¯ä»¥ä½¿ç”¨å…¶å­ç±» <code>Transaction</code>ï¼‰ã€‚<code>Transform</code> å¯¹è±¡ç»´æŠ¤ä¸€ä¸ªå¯ä¿®æ”¹çš„
æ–‡æ¡£å‰¯æœ¬ï¼Œå¹¶æä¾›ä¸€ç³»åˆ—æ–¹æ³•æ¥ç¼–è¾‘å®ƒï¼š</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> tr </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">Transform</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">myDoc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">tr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">delete</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">7</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// åˆ é™¤ä½ç½®5åˆ°7çš„å†…å®¹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">tr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">split</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// åœ¨ä½ç½®5æ‹†åˆ†å…¶çˆ¶èŠ‚ç‚¹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token console class-name">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">tr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">doc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">toString</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// æŸ¥çœ‹ä¿®æ”¹åçš„æ–‡æ¡£</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token console class-name">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">tr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">steps</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// â†’ 2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤  åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å¤§å¤šæ•°å˜æ¢æ–¹æ³•ä¼šè¿”å› <code>Transform</code> å¯¹è±¡æœ¬èº«ï¼Œä»¥ä¾¿æ‚¨å¯ä»¥é“¾å¼è°ƒç”¨ï¼Œä¾‹å¦‚
<code>tr.delete(5, 7).split(5)</code>ã€‚<code>Transform</code> æä¾›äº†è®¸å¤šæ–¹æ³•ï¼ŒåŒ…æ‹¬åˆ é™¤ï¼ˆ<code>delete</code>ï¼‰ã€æ›¿
æ¢ï¼ˆ<code>replace</code>ï¼‰ã€æ·»åŠ æˆ–åˆ é™¤æ ‡è®°ï¼ˆ<code>addMark</code>/<code>removeMark</code>ï¼‰ã€ä»¥åŠæ‰§è¡Œè¯¸å¦‚æ‹†åˆ†
ï¼ˆ<code>split</code>ï¼‰ã€åˆå¹¶ï¼ˆ<code>join</code>ï¼‰ã€æå‡ï¼ˆ<code>lift</code>ï¼‰ã€åŒ…è£¹ï¼ˆ<code>wrap</code>ï¼‰ç­‰æ“ä½œã€‚è¿™äº›æ–¹æ³•ä¼šä¸º
æ‚¨åˆ›å»ºé€‚å½“çš„æ­¥éª¤ï¼Œå¹¶æ›´æ–°å†…éƒ¨æ–‡æ¡£å‰¯æœ¬ã€‚</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="æ˜ å°„-mapping">æ˜ å°„ (Mapping)<a href="#æ˜ å°„-mapping" class="hash-link" aria-label="æ˜ å°„ (Mapping)çš„ç›´æ¥é“¾æ¥" title="æ˜ å°„ (Mapping)çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>å½“æ‚¨å¯¹æ–‡æ¡£è¿›è¡Œæ›´æ”¹æ—¶ï¼ŒåŸå§‹æ–‡æ¡£çš„ä½ç½®å°†ä¼šå‘ç”Ÿå˜åŒ–ã€‚æ¯”å¦‚ï¼Œå¾€æ–‡æ¡£ä½ç½® 5 å¤„æ’å…¥äº†ä¸¤
ä¸ªå­—ç¬¦ï¼Œé‚£ä¹ˆåŸæ¥ä½ç½® 10 å°±å˜æˆäº†ä½ç½® 12ï¼›å¦‚æœåˆ é™¤äº†ä¸€æ®µå†…å®¹ï¼Œé‚£ä¹ˆè¿™äº›ä½ç½®å¯èƒ½å°±
ä¸å­˜åœ¨äº†ã€‚ä¸ºäº†åœ¨æ–‡æ¡£æ›´æ”¹åä¿æŒå¯¹ä½ç½®çš„è·Ÿè¸ªï¼Œæ­¥éª¤ï¼ˆStepï¼‰æä¾›äº†æ˜ å°„ï¼ˆmapï¼‰ã€‚ä¾‹å¦‚
ï¼š</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> step </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">ReplaceStep</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">6</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token maybe-class-name">Slice</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">empty</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// åˆ é™¤4åˆ°6ä¹‹é—´çš„å†…å®¹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> map </span><span class="token operator">=</span><span class="token plain"> step</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">getMap</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token console class-name">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">map</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">map</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">8</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// â†’ 6</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token console class-name">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">map</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">map</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// â†’ 2 ï¼ˆå˜åŠ¨å‰çš„ä½ç½®ä¿æŒä¸å˜ï¼‰</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>Transform</code> å¯¹è±¡ä¼šè‡ªåŠ¨æ”¶é›†å®ƒåŒ…å«çš„æ‰€æœ‰æ­¥éª¤çš„æ˜ å°„ï¼Œå½¢æˆä¸€ä¸ª <code>Mapping</code> ç®¡é“ï¼Œæ‚¨å¯
ä»¥é€šè¿‡å®ƒæ¥ä¸€æ¬¡æ€§å°†ä½ç½®æ˜ å°„è¿‡æ‰€æœ‰æ­¥éª¤ï¼š</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> tr </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">Transform</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">myDoc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">tr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">split</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">10</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// åœ¨ä½ç½®10æ‹†åˆ†èŠ‚ç‚¹ï¼Œæ–‡æ¡£åœ¨æ­¤å¤„å¢åŠ 2ä¸ªæ ‡è®°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">tr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">delete</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// ä»ä½ç½®2åˆ°5åˆ é™¤3ä¸ªæ ‡è®°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token console class-name">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">tr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">mapping</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">map</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">15</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// â†’ 14</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token console class-name">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">tr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">mapping</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">map</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">6</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// â†’ 3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token console class-name">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">tr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">mapping</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">map</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">10</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// â†’ 9</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä½ç½®æ°å¥½ä½äºå˜åŠ¨çš„è¾¹ç•Œä¸Šï¼Œæ˜ å°„çš„è¡Œä¸ºå¹¶ä¸å”¯ä¸€ã€‚ä¾‹å¦‚ä¸Šä¾‹ä¸­ï¼Œä½ç½® 10
æ˜¯æ‹†åˆ†ç‚¹å‰çš„ä½ç½®ï¼Œæ˜ å°„åˆ° 9ã€‚å¦‚æœæ‚¨å¸Œæœ›â€œä½ç½®éšå‰é¢çš„å˜åŒ–ç§»åŠ¨â€ï¼Œå¯ä»¥ä½¿ç”¨å¸¦
<code>bias = -1</code> çš„æ˜ å°„è°ƒç”¨ï¼š</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token console class-name">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">tr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">mapping</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">map</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">10</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// â†’ 7</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¿™æ ·å¯ä»¥è®©ä½ç½®å°½é‡å‘åä¿ç•™åŸä½ä¸åŠ¨ã€‚å®šä¹‰å°è€Œç®€å•çš„æ­¥éª¤ä½¿å¾—æ˜ å°„æˆä¸ºå¯èƒ½ï¼Œä¹Ÿè®©æ­¥éª¤
å¯ä»¥è¢«æ— æŸåœ°åè½¬ï¼ˆinvertï¼‰å¹¶åœ¨å¤šä¸ªæ˜ å°„ä¹‹é—´ç›¸äº’è½¬æ¢ã€‚</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="é‡æ–°åŸºå‡†åŒ–-rebasing"> é‡æ–°åŸºå‡†åŒ– (Rebasing)<a href="#é‡æ–°åŸºå‡†åŒ–-rebasing" class="hash-link" aria-label="é‡æ–°åŸºå‡†åŒ– (Rebasing)çš„ç›´æ¥é“¾æ¥" title="é‡æ–°åŸºå‡†åŒ– (Rebasing)çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>åœ¨åšæ›´å¤æ‚çš„æ“ä½œæ—¶ï¼Œå¯èƒ½éœ€è¦â€œé‡æ–°åŸºå‡†åŒ–â€ï¼ˆrebasingï¼‰ã€‚ç®€å•æ¥è¯´ï¼Œé‡æ–°åŸºå‡†åŒ–æ˜¯æŒ‡ï¼š
å¦‚æœæœ‰ä¸¤ä¸ªæ­¥éª¤ <em>stepA</em> å’Œ <em>stepB</em> éƒ½æ˜¯ä»åŒä¸€ä¸ªæ—§æ–‡æ¡£å‡ºå‘çš„ï¼Œä½†æ‚¨æƒ³å…ˆåº”ç”¨
<em>stepA</em>ï¼ˆå¾—åˆ°æ–‡æ¡£ <code>docA</code>ï¼‰ï¼Œç„¶åå†åº”ç”¨åŸæœ¬ä¸ºæ—§æ–‡æ¡£è®¾è®¡çš„ <em>stepB</em>ï¼Œé‚£ä¹ˆæ‚¨éœ€è¦å¯¹
<em>stepB</em> è¿›è¡Œé‡æ–°åŸºå‡†åŒ–ï¼Œå¾—åˆ°ä¸€ä¸ªæ–°çš„æ­¥éª¤ <em>stepBâ€²</em>ï¼Œä½¿å…¶èƒ½æ­£ç¡®åœ°ä½œç”¨äº <code>docA</code>ã€‚è¿™
å¯ä»¥é€šè¿‡å°† <em>stepB</em> æ˜ å°„åˆ° <em>stepA</em> çš„æ˜ å°„ç»“æœæ¥å®ç°
ï¼ˆ<code>stepB.map(stepA.getMap())</code>ï¼‰ã€‚</p>
<p>å½“éœ€è¦å°†ä¸€è¿ä¸²æ­¥éª¤é‡æ–°åŸºå‡†åŒ–åˆ°å¦ä¸€ä¸²æ­¥éª¤ä¸Šæ—¶ï¼Œæƒ…å†µå°±æ›´å¤æ‚ã€‚ä¾‹å¦‚ï¼Œå‡è®¾æœ‰æ­¥éª¤åºåˆ—
<code>stepA1, stepA2</code> å’Œ <code>stepB1, stepB2</code>ã€‚å¦‚æœæ‚¨æƒ³å°† <code>stepB1, stepB2</code> åº”ç”¨åˆ°
<code>stepA1, stepA2</code> ä¹‹åçš„æ–‡æ¡£ï¼Œæ‚¨éœ€è¦å…ˆå¯¹ <code>stepB1</code> è¿›è¡Œæ˜ å°„ï¼Œç„¶åå†å¯¹ <code>stepB2</code> è¿›
è¡Œå¤æ‚çš„æ˜ å°„ã€‚ProseMirror çš„ <code>Mapping</code> ç®¡é“èƒ½å¤Ÿå¤„ç†è¿™ç±»å¤šæ­¥éª¤çš„æ˜ å°„ï¼ŒåŒ…æ‹¬ä½¿ç”¨é€†
æ˜ å°„ï¼ˆinvertï¼‰æ¥ç¡®ä¿æ­¥éª¤ä»ç„¶æœ‰æ•ˆã€‚å°½ç®¡æŠ€æœ¯ç»†èŠ‚è¾ƒå¤šï¼Œä½†ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¦‚æœæ­¥éª¤æ— æ³•æ˜ 
å°„ï¼ˆä¾‹å¦‚å…¶ç›®æ ‡å†…å®¹å·²è¢«åˆ é™¤ï¼‰ï¼Œåˆ™æ˜ å°„ä¼šå¤±è´¥å¹¶è¿”å› nullï¼Œè¿™æ—¶é€šå¸¸ä¼šæ”¾å¼ƒè¯¥æ­¥éª¤ã€‚</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ç¼–è¾‘çŠ¶æ€-the-editor-state">ç¼–è¾‘çŠ¶æ€ (The editor state)<a href="#ç¼–è¾‘çŠ¶æ€-the-editor-state" class="hash-link" aria-label="ç¼–è¾‘çŠ¶æ€ (The editor state)çš„ç›´æ¥é“¾æ¥" title="ç¼–è¾‘çŠ¶æ€ (The editor state)çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>ç¼–è¾‘å™¨çš„çŠ¶æ€ç”±å“ªäº›éƒ¨åˆ†ç»„æˆï¼Ÿå½“ç„¶æœ‰æ–‡æ¡£ï¼ˆ<code>doc</code>ï¼‰ï¼Œè¿˜æœ‰å½“å‰çš„é€‰åŒºï¼ˆ<code>selection</code>ï¼‰ã€‚
æ­¤å¤–ï¼Œå½“æ‚¨æ¿€æ´»æŸä¸ªæ ‡è®°ä½†è¿˜æ²¡æœ‰è¾“å…¥æ—¶ï¼Œéœ€è¦è®°å½•å½“å‰çš„â€œé¢„ç½®æ ‡è®°â€ï¼ˆ<code>storedMarks</code>ï¼‰
ã€‚è¿™ä¸‰ä¸ªæ˜¯ ProseMirror çŠ¶æ€å¯¹è±¡çš„ä¸»è¦ç»„æˆéƒ¨åˆ†ï¼Œå®ƒä»¬åˆ†åˆ«ä»¥
<code>state.doc</code>ã€<code>state.selection</code> å’Œ <code>state.storedMarks</code> å±æ€§å­˜åœ¨ã€‚ä»¥ä¸‹ç¤ºä¾‹æ¼”ç¤ºäº†åˆ
å§‹åŒ–çŠ¶æ€å’ŒæŸ¥çœ‹å…¶å†…å®¹ï¼š</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword module" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token imports"> schema </span><span class="token imports punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;prosemirror-schema-basic&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword module" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">EditorState</span><span class="token imports"> </span><span class="token imports punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;prosemirror-state&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> state </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">EditorState</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">create</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> schema </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token console class-name">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">doc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">toString</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// ä¸€ä¸ªç©ºæ®µè½</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token console class-name">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">selection</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token keyword module" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// 1ï¼Œå³æ®µè½å¼€å§‹çš„ä½ç½®</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>æ’ä»¶å¯èƒ½ä¹Ÿéœ€è¦åœ¨çŠ¶æ€ä¸­å­˜å‚¨è‡ªå·±çš„æ•°æ®ï¼ˆä¾‹å¦‚å†å²æ’ä»¶éœ€è¦ä¿å­˜å†å²è®°å½•ï¼‰ã€‚è¿™å°±æ˜¯ä¸ºä»€
ä¹ˆåˆ›å»ºçŠ¶æ€æ—¶å¯ä»¥ä¼ å…¥æ’ä»¶æ•°ç»„ <code>plugins</code>ï¼Œè¿™äº›æ’ä»¶ä¼šåœ¨çŠ¶æ€å¯¹è±¡ä¸­å æ®æ§½ä½ï¼Œä¿å­˜å®ƒä»¬
è‡ªå·±çš„çŠ¶æ€ã€‚æ’ä»¶æœ¬èº«ç”± <code>Plugin</code> ç±»çš„å®ä¾‹è¡¨ç¤ºï¼Œå¯ä»¥é€šè¿‡ <code>state</code> å±æ€§åœ¨å…¶ä¸­å®šä¹‰è‡ª
å·±çš„çŠ¶æ€ç‰‡æ®µã€‚ä¾‹å¦‚ï¼š</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> transactionCounter </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">Plugin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token literal-property property">state</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">init</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">apply</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">tr</span><span class="token parameter punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token parameter"> value</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> value </span><span class="token operator">+</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">getTransactionCount</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">state</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> transactionCounter</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">getState</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä¸Šä¾‹ä¸­çš„æ’ä»¶å®šä¹‰äº†ä¸€ä¸ªç®€å•çš„çŠ¶æ€ï¼šä¸€ä¸ªè®¡æ•°å™¨ï¼Œç”¨äºè®°å½•åº”ç”¨åˆ°çŠ¶æ€çš„äº‹åŠ¡æ•°é‡
ã€‚<code>init</code> æ–¹æ³•è¿”å›åˆå§‹å€¼ï¼ˆè¿™é‡Œæ˜¯ 0ï¼‰ï¼Œ<code>apply</code> æ–¹æ³•åœ¨æ¯æ¬¡äº‹åŠ¡åº”ç”¨æ—¶è¿”å›ä¸€ä¸ªæ–°çš„è®¡
æ•°å€¼ã€‚<code>getTransactionCount</code> å‡½æ•°å¯ä»¥ä½¿ç”¨æ’ä»¶å¯¹è±¡çš„ <code>getState</code> æ–¹æ³•ä»æ•´ä¸ªç¼–è¾‘å™¨çŠ¶
æ€å¯¹è±¡ä¸­æå–è¿™ä¸ªæ’ä»¶çš„çŠ¶æ€ã€‚</p>
<p>ç”±äºç¼–è¾‘å™¨çŠ¶æ€æ˜¯æŒä¹…åŒ–çš„ï¼ˆimmutableï¼‰ï¼Œæ’ä»¶çš„çŠ¶æ€éƒ¨åˆ†ä¹Ÿå¿…é¡»ä¿æŒä¸å¯å˜ã€‚ä¹Ÿå°±æ˜¯è¯´
ï¼Œå¦‚æœæ’ä»¶çŠ¶æ€éœ€è¦æ”¹å˜ï¼Œå®ƒçš„ <code>apply</code> æ–¹æ³•å¿…é¡»è¿”å›ä¸€ä¸ªæ–°å€¼ï¼Œè€Œä¸æ˜¯ä¿®æ”¹ç°æœ‰å€¼ï¼Œå¹¶
ä¸”å¤–éƒ¨ä»£ç ä¹Ÿä¸åº”ä¿®æ”¹å®ƒä»¬ã€‚</p>
<p>æ’ä»¶é€šå¸¸è¿˜éœ€è¦å‘äº‹åŠ¡æ·»åŠ å…ƒæ•°æ®ï¼ˆmetadataï¼‰ã€‚ä¾‹å¦‚ï¼Œå½“æ‰§è¡Œæ’¤é”€æ“ä½œæ—¶ï¼Œå†å²æ’ä»¶å¯èƒ½
ä¼šç»™äº§ç”Ÿçš„äº‹åŠ¡æ‰“ä¸Šä¸€ä¸ªæ ‡è®°ï¼Œä»¥è¡¨æ˜å®ƒä¸åº”è¢«è®°å½•åˆ°å†å²ä¸­ã€‚äº‹åŠ¡å¯¹è±¡æä¾›äº† <code>setMeta</code>
å’Œ <code>getMeta</code> æ–¹æ³•æ¥è®¾ç½®å’Œè¯»å–å…ƒæ•°æ®ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹ä¸Šé¢çš„è®¡æ•°æ’ä»¶ï¼Œä¸å¯¹å¸¦æœ‰
ç‰¹å®šå…ƒæ•°æ®çš„äº‹åŠ¡è¿›è¡Œè®¡æ•°ï¼š</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> transactionCounter </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">Plugin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token literal-property property">state</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">init</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">apply</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">tr</span><span class="token parameter punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token parameter"> value</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">tr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">getMeta</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">transactionCounter</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> value</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> value </span><span class="token operator">+</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">markAsUncounted</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">tr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  tr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">setMeta</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">transactionCounter</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¦‚æœäº‹åŠ¡é™„åŠ äº† <code>transactionCounter</code> æ’ä»¶çš„å…ƒæ•°æ®ï¼Œåˆ™è®¡æ•°å™¨ä¸ä¼šå¢åŠ 
ã€‚æ‚¨å¯ä»¥ä½¿ç”¨æ’ä»¶å¯¹è±¡æœ¬èº«ä½œä¸ºå…ƒæ•°æ®çš„é”®ï¼Œä»¥é¿å…ä¸å…¶ä»–é”®åå†²çªã€‚ProseMirror ä¹Ÿä½¿ç”¨
äº†ä¸€äº›é¢„å®šä¹‰çš„é”®åï¼Œä¾‹å¦‚å¯ä»¥é€šè¿‡è®¾ç½®é”® <code>&quot;addToHistory&quot;</code> ä¸º <code>false</code> æ¥é˜»æ­¢äº‹åŠ¡è¢«
è®°å½•è¿›å†å²ï¼Œä»¥åŠåœ¨ç²˜è´´äº‹ä»¶ä¸­ï¼Œç¼–è¾‘å™¨è§†å›¾ä¼šè‡ªåŠ¨å°†äº‹åŠ¡ä¸Šçš„ <code>&quot;paste&quot;</code> å±æ€§è®¾ç½®ä¸º
<code>true</code>ã€‚</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="è§†å›¾ç»„ä»¶-the-view-component">è§†å›¾ç»„ä»¶ (The view component)<a href="#è§†å›¾ç»„ä»¶-the-view-component" class="hash-link" aria-label="è§†å›¾ç»„ä»¶ (The view component)çš„ç›´æ¥é“¾æ¥" title="è§†å›¾ç»„ä»¶ (The view component)çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p><strong>è§†å›¾ç»„ä»¶ï¼ˆEditorViewï¼‰</strong> æ˜¯ ProseMirror çš„ç”¨æˆ·ç•Œé¢éƒ¨åˆ†ã€‚å®ƒè´Ÿè´£å°†ä¸€ä¸ªç¼–è¾‘çŠ¶æ€å±•
ç¤ºç»™ç”¨æˆ·ï¼Œå¹¶å…è®¸ç”¨æˆ·åœ¨å…¶ä¸­è¿›è¡Œç¼–è¾‘äº¤äº’ã€‚æ ¸å¿ƒè§†å›¾ç»„ä»¶çš„èŒè´£èŒƒå›´å¾ˆä¸“ä¸€ï¼šå®ƒåªå¤„ç†ä¸
ç¼–è¾‘è¡¨é¢ç›´æ¥ç›¸å…³çš„äº¤äº’ï¼Œä¾‹å¦‚é”®å…¥ã€ç‚¹å‡»ã€å¤åˆ¶ã€ç²˜è´´ã€æ‹–æ”¾ç­‰ã€‚å…¶ä»–è¯¸å¦‚æ˜¾ç¤ºå·¥å…·æ èœ
å•æˆ–æä¾›å®Œæ•´é”®ç›˜å¿«æ·é”®ç­‰åŠŸèƒ½ï¼Œéƒ½è¶…å‡ºäº†æ ¸å¿ƒè§†å›¾çš„èŒè´£ï¼Œéœ€è¦é€šè¿‡æ’ä»¶æˆ–å¤–éƒ¨ä»£ç æ¥å®
ç°ã€‚</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="å¯ç¼–è¾‘çš„-dom">å¯ç¼–è¾‘çš„ DOM<a href="#å¯ç¼–è¾‘çš„-dom" class="hash-link" aria-label="å¯ç¼–è¾‘çš„ DOMçš„ç›´æ¥é“¾æ¥" title="å¯ç¼–è¾‘çš„ DOMçš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>æµè§ˆå™¨å…è®¸æˆ‘ä»¬å°† DOM çš„æŸäº›éƒ¨åˆ†è®¾ç½®ä¸ºå¯ç¼–è¾‘ï¼ˆcontenteditableï¼‰ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨è¿™äº›
åŒºåŸŸå†…è·å¾—ç„¦ç‚¹å¹¶æ’å…¥æ–‡æœ¬ã€‚è§†å›¾ä¼šæ ¹æ®æ–‡æ¡£çŠ¶æ€åˆ›å»ºä¸€ä¸ª DOM ç»“æ„ï¼ˆé»˜è®¤ä½¿ç”¨æ¨¡å¼çš„
<code>toDOM</code> æ–¹æ³•ï¼‰ï¼Œå¹¶å°†å…¶æ‰€åœ¨çš„å…ƒç´ è®¾ä¸ºå¯ç¼–è¾‘ã€‚å½“è¿™ä¸ªå¯ç¼–è¾‘å…ƒç´ è·å¾—ç„¦ç‚¹æ—¶
ï¼ŒProseMirror ä¼šç¡®ä¿æµè§ˆå™¨çš„ DOM é€‰åŒºä¸ç¼–è¾‘çŠ¶æ€ä¸­çš„é€‰åŒºä¿æŒä¸€è‡´ã€‚</p>
<p>è§†å›¾è¿˜ä¼šæ³¨å†Œå¤§é‡çš„äº‹ä»¶å¤„ç†å™¨ï¼Œå°† DOM äº‹ä»¶ç¿»è¯‘ä¸ºç›¸åº”çš„ç¼–è¾‘å™¨äº‹åŠ¡ã€‚ä¾‹å¦‚ï¼Œå½“ç”¨æˆ·ç²˜
è´´å†…å®¹æ—¶ï¼Œäº‹ä»¶å¤„ç†å™¨ä¼šå°†ç²˜è´´çš„å†…å®¹è§£æä¸º ProseMirror æ–‡æ¡£åˆ‡ç‰‡ï¼ˆsliceï¼‰å¹¶æ’å…¥åˆ°æ–‡
æ¡£ä¸­ã€‚æµè§ˆå™¨è‡ªèº«ä¹Ÿä¼šå¤„ç†å¾ˆå¤šäº‹ä»¶ï¼Œä¾‹å¦‚å…‰æ ‡ç§»åŠ¨å’Œæ–‡æœ¬è¾“å…¥ï¼Œè¿™æ ·å¯ä»¥åˆ©ç”¨æµè§ˆå™¨çš„åŸ
ç”Ÿç¼–è¾‘èƒ½åŠ›ï¼ˆå¦‚æ‹¼å†™æ£€æŸ¥ã€ç§»åŠ¨å…‰æ ‡çš„å‡†ç¡®åº¦ç­‰ï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæµè§ˆå™¨ä¼šå…ˆæ›´æ–° DOMï¼Œ
ç„¶å ProseMirror æ£€æµ‹ DOM çš„æ›´æ”¹ï¼ŒæŠŠ æ›´æ”¹çš„å†…å®¹é‡æ–°è§£ææˆäº‹åŠ¡åº”ç”¨åˆ°çŠ¶æ€ä¸­ã€‚å¯¹äºå…‰
æ ‡å’Œé€‰åŒºçš„å˜åŒ–ï¼Œåªæœ‰å½“æµè§ˆå™¨é€‰åŒºä¸çŠ¶æ€é€‰åŒºä¸ä¸€è‡´æ—¶ï¼Œç¼–è¾‘å™¨æ‰ä¼šæ›´æ–°é€‰åŒºäº‹åŠ¡ï¼Œä»¥é¿
å…ç ´åæµè§ˆå™¨ç»´æŠ¤çš„ä¸€äº›éšè—çŠ¶æ€ï¼ˆä¾‹å¦‚åœ¨å…‰æ ‡ä»ä¸€è¡Œè¾ƒçŸ­çš„æ–‡æœ¬ç§»åŠ¨åˆ°ä¸‹ä¸€è¡Œæ—¶è®°å¿†æ°´å¹³
ä½ç½®ç­‰ï¼‰ã€‚</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="æ•°æ®æµ-data-flow">æ•°æ®æµ (Data flow)<a href="#æ•°æ®æµ-data-flow" class="hash-link" aria-label="æ•°æ®æµ (Data flow)çš„ç›´æ¥é“¾æ¥" title="æ•°æ®æµ (Data flow)çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>ç¼–è¾‘å™¨è§†å›¾ä¼šæ˜¾ç¤ºç»™å®šçš„ç¼–è¾‘çŠ¶æ€ï¼Œå½“ç”¨æˆ·æ‰§è¡Œæ“ä½œæ—¶ï¼Œå®ƒä¼šåˆ›å»ºä¸€ä¸ªäº‹åŠ¡å¹¶<strong>å¹¿æ’­</strong>å‡ºå»
ã€‚é€šå¸¸ï¼Œè¿™ä¸ªäº‹åŠ¡ä¼šè¢«åº”ç”¨åˆ°å½“å‰çŠ¶æ€ä»¥ç”Ÿæˆä¸€ä¸ªæ–°çŠ¶æ€ï¼Œç„¶åä½¿ç”¨
<code>view.updateState(newState)</code> å°†æ–°çŠ¶æ€æä¾›ç»™è§†å›¾ã€‚æµç¨‹å¯ä»¥ç”¨å¦‚ä¸‹å›¾ç¤ºæ¦‚å¿µåŒ–ï¼š</p>
<div class="language-markdown codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-markdown codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">      DOM äº‹ä»¶</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       â†—   â†˜</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   EditorView</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       â†–   â†™</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    äº‹åŠ¡ (Transaction)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       â†—   â†˜</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    æ–°çš„ EditorState</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¿™ç§è®¾è®¡å½¢æˆäº†ä¸€ä¸ªç®€å•è€Œå¾ªç¯çš„æ•°æ®æµï¼Œç›¸æ¯”ä¼ ç»Ÿçš„ã€ä¾èµ–å¤§é‡ç›´æ¥äº‹ä»¶å¤„ç†å›è°ƒçš„æ–¹å¼
ï¼Œè¿™ç§ç»“æ„æ›´æ¸…æ™°ã€‚æ‚¨å¯ä»¥é€šè¿‡åœ¨ <code>EditorView</code> æ„é€ æ—¶æä¾› <code>dispatchTransaction</code> å±
æ€§æ¥â€œæ‹¦æˆªâ€äº‹åŠ¡ï¼Œä»¥å°†æ­¤å¾ªç¯æ•°æ®æµæ•´åˆåˆ°æ‚¨çš„åº”ç”¨ç¨‹åºçš„çŠ¶æ€ç®¡ç†ä¹‹ä¸­ï¼ˆä¾‹å¦‚ä¸ Redux
ä¹‹ç±»çš„æ•°æ®æµæ¶æ„ç»“åˆï¼‰ã€‚ä¾‹å¦‚ï¼š</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">// åº”ç”¨çš„æ•´ä½“çŠ¶æ€</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> appState </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token literal-property property">editor</span><span class="token operator">:</span><span class="token plain"> </span><span class="token maybe-class-name">EditorState</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">create</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> schema </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token literal-property property">score</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> view </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">EditorView</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token dom variable" style="color:rgb(189, 147, 249);font-style:italic">document</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">body</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token literal-property property">state</span><span class="token operator">:</span><span class="token plain"> appState</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">editor</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token function" style="color:rgb(80, 250, 123)">dispatchTransaction</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">transaction</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">update</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token literal-property property">type</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;EDITOR_TRANSACTION&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> transaction </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// ç®€é™‹çš„åº”ç”¨çŠ¶æ€æ›´æ–°å‡½æ•°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">update</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">event</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">type</span><span class="token plain"> </span><span class="token operator">==</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;EDITOR_TRANSACTION&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    appState</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">editor</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> appState</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">editor</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">apply</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">transaction</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">type</span><span class="token plain"> </span><span class="token operator">==</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;SCORE_POINT&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> appState</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">score</span><span class="token operator">++</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token function" style="color:rgb(80, 250, 123)">draw</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// æ›´æ–° DOM çš„å‡½æ•°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">draw</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token dom variable" style="color:rgb(189, 147, 249);font-style:italic">document</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">querySelector</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;#score&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">textContent</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> appState</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">score</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  view</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">updateState</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">appState</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">editor</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åœ¨ä¸Šä¾‹ä¸­ï¼Œæˆ‘ä»¬å°† ProseMirror çš„äº‹åŠ¡é›†æˆåˆ°äº†è‡ªå®šä¹‰çš„åº”ç”¨çŠ¶æ€æµä¸­ã€‚æ¯å½“æˆ‘ä»¬æ”¶åˆ°ä¸€
ä¸ª <code>EDITOR_TRANSACTION</code> äº‹ä»¶æ—¶ï¼Œå°±å°†äº‹åŠ¡åº”ç”¨åˆ°ç¼–è¾‘å™¨çŠ¶æ€ï¼Œå¹¶è°ƒç”¨
<code>view.updateState</code> æ¥æ›´æ–°è§†å›¾ã€‚</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="é«˜æ•ˆæ›´æ–°-efficient-updating">é«˜æ•ˆæ›´æ–° (Efficient updating)<a href="#é«˜æ•ˆæ›´æ–°-efficient-updating" class="hash-link" aria-label="é«˜æ•ˆæ›´æ–° (Efficient updating)çš„ç›´æ¥é“¾æ¥" title="é«˜æ•ˆæ›´æ–° (Efficient updating)çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>ä¸€ç§æœ€æœ´ç´ çš„å®ç° <code>updateState</code> çš„æ–¹æ³•æ˜¯æ¯æ¬¡éƒ½é‡æ–°ç»˜åˆ¶æ•´ä¸ªæ–‡æ¡£ã€‚ä½†å¯¹äºå¤§å‹æ–‡æ¡£ï¼Œ
è¿™æ ·ä¼šéå¸¸æ…¢ã€‚ProseMirror çš„è§†å›¾çŸ¥é“æ—§æ–‡æ¡£å’Œæ–°æ–‡æ¡£ï¼Œå› æ­¤å®ƒä¼šæ¯”è¾ƒä¸¤è€…ï¼Œåªå¯¹æœ‰æ‰€ä¸
åŒçš„éƒ¨åˆ†è¿›è¡Œæ›´æ–°ï¼Œè€Œä¿æŒå…¶ä½™éƒ¨åˆ†ä¸å˜ã€‚è¿™æ ·åšä½¿å¾—å…¸å‹æ›´æ–°æ‰€éœ€çš„å·¥ä½œéå¸¸å°‘ã€‚</p>
<p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä¾‹å¦‚ç”¨æˆ·é”®å…¥ä¸€ä¸ªå­—ç¬¦æ—¶ï¼Œæµè§ˆå™¨å·²ç»ç›´æ¥å°†å­—ç¬¦æ’å…¥åˆ° DOM ä¸­
ã€‚ProseMirror æ­¤æ—¶çš„æ›´æ–°åªéœ€æ£€æŸ¥ DOM ä¸çŠ¶æ€æ˜¯å¦ä¸€è‡´ï¼Œå°±å¯èƒ½ä¸éœ€è¦åšä»»ä½•ä¿®æ”¹ã€‚å¦‚
æœç”¨æˆ·éšåæ’¤é”€è¾“å…¥æˆ–å‘ç”Ÿå…¶ä»–æƒ…å†µå¯¼è‡´éœ€è¦å›æ»šï¼Œè§†å›¾ä¼šæ’¤é”€æµè§ˆå™¨çš„æ›´æ”¹ä»¥ä¿æŒåŒæ­¥ã€‚
 ç±»ä¼¼åœ°ï¼Œå¯¹äºå…‰æ ‡ä½ç½®ï¼Œåªæœ‰åœ¨çŠ¶æ€é€‰åŒºä¸ DOM é€‰åŒºä¸ä¸€è‡´æ—¶æ‰ä¼šè¿›è¡Œæ›´æ–°ï¼Œä»¥å…æ‰“ä¹±æµ
è§ˆå™¨å†…éƒ¨ç»´æŠ¤çš„å…‰æ ‡çŠ¶æ€ã€‚</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="å±æ€§-props">å±æ€§ (Props)<a href="#å±æ€§-props" class="hash-link" aria-label="å±æ€§ (Props)çš„ç›´æ¥é“¾æ¥" title="å±æ€§ (Props)çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>åœ¨ React ç­‰æ¡†æ¶ä¸­ï¼Œâ€œå±æ€§â€ï¼ˆpropsï¼‰æ˜¯ä¼ é€’ç»™ç»„ä»¶çš„ä¸€ç»„é…ç½®å‚æ•°ï¼Œå†³å®šäº†ç»„ä»¶çš„è¡Œä¸ºã€‚
åœ¨ ProseMirror ä¸­ä¹Ÿå€Ÿç”¨äº†è¿™ä¸€æ¦‚å¿µã€‚å¯¹äºç¼–è¾‘å™¨è§†å›¾æ¥è¯´ï¼ŒçŠ¶æ€ï¼ˆstateï¼‰æ˜¯ä¸€ä¸ªå±æ€§ï¼Œ
å…¶å®ƒå±æ€§ï¼ˆä¾‹å¦‚ <code>editable</code>, <code>handleDoubleClick</code> ç­‰ï¼‰åœ¨æ„é€ è§†å›¾æ—¶æä¾›ï¼Œå¹¶å®šä¹‰äº†è§†
å›¾çš„è¡Œä¸ºã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼š</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> view </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">EditorView</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token literal-property property">state</span><span class="token operator">:</span><span class="token plain"> myState</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token function" style="color:rgb(80, 250, 123)">editable</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// ä½¿ç¼–è¾‘å™¨åªè¯»</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token function" style="color:rgb(80, 250, 123)">handleDoubleClick</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Double click!&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä¸Šä¾‹ä¸­ï¼Œ<code>state</code> å’Œ <code>editable</code>ã€<code>handleDoubleClick</code> éƒ½æ˜¯ä¼ é€’ç»™è§†å›¾çš„å±æ€§ã€‚æ’ä»¶ä¹Ÿ
å¯ä»¥å£°æ˜é¢å¤–çš„å±æ€§ï¼ˆpropsï¼‰ï¼Œä¾‹å¦‚å‰é¢ç¤ºä¾‹ä¸­çš„ <code>maxSizePlugin</code>ï¼šå®ƒé€šè¿‡å±æ€§å†³å®šç¼–
è¾‘å™¨æ˜¯å¦å¯ç¼–è¾‘ï¼š</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">maxSizePlugin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">max</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">Plugin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token literal-property property">props</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token function" style="color:rgb(80, 250, 123)">editable</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">state</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> state</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">doc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">content</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">size</span><span class="token plain"> </span><span class="token operator">&lt;</span><span class="token plain"> max</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å¦‚æœåŒä¸€ä¸ªå±æ€§è¢«å¤šæ¬¡å£°æ˜ï¼Œå…¶å¤„ç†æ–¹å¼å–å†³äºå±æ€§æœ¬èº«çš„ç±»å‹ï¼šé€šå¸¸ç›´æ¥æä¾›ç»™è§†å›¾çš„å±
æ€§ä¼˜å…ˆçº§æœ€é«˜ï¼Œç„¶åæŒ‰æ’ä»¶é¡ºåºä¾æ¬¡åº”ç”¨ã€‚ä¾‹å¦‚ï¼Œå¯¹äºæŸäº›åªå–ç¬¬ä¸€ä¸ªå€¼çš„å±æ€§ï¼ˆå¦‚
<code>domParser</code>ï¼‰ï¼Œåç»­çš„å®šä¹‰ä¼šè¢«å¿½ç•¥ï¼›å¯¹äºäº‹ä»¶å¤„ç†å‡½æ•°å±æ€§ï¼Œè¿”å› <code>true</code> çš„ç¬¬ä¸€ä¸ªå¤„
ç†å™¨ä¼šå¤„ç†äº‹ä»¶å¹¶åœæ­¢ç»§ç»­è°ƒç”¨ï¼›è€Œå¯¹äºåƒ <code>attributes</code>ï¼ˆå¯ä»¥ä¸ºå¯ç¼–è¾‘ DOM èŠ‚ç‚¹è®¾ç½®å±
æ€§ï¼‰å’Œæ¥ä¸‹æ¥è¦ä»‹ç»çš„è£…é¥°ï¼ˆdecorationsï¼‰è¿™ç±»å±æ€§ï¼Œä¼šå°†æ‰€æœ‰æ’ä»¶æä¾›çš„å€¼åˆå¹¶èµ·æ¥ã€‚</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="è£…é¥°-decorations">è£…é¥° (Decorations)<a href="#è£…é¥°-decorations" class="hash-link" aria-label="è£…é¥° (Decorations)çš„ç›´æ¥é“¾æ¥" title="è£…é¥° (Decorations)çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>**è£…é¥°ï¼ˆDecorationsï¼‰**è®©æ‚¨æ§åˆ¶è§†å›¾å¦‚ä½•åœ¨é¡µé¢ä¸Šä¸ºæ–‡æ¡£ç»˜åˆ¶å†…å®¹ã€‚æ‚¨å¯ä»¥é€šè¿‡æ’
ä»¶çš„ <code>decorations</code> å±æ€§è¿”å›ä¸€ä¸ª <code>DecorationSet</code> æ¥åˆ›å»ºè£…é¥°ã€‚è£…é¥°ä¸»è¦æœ‰ä¸‰ç§ç±»å‹ï¼š</p>
<ul>
<li><strong>èŠ‚ç‚¹è£…é¥°ï¼ˆNode decorationsï¼‰</strong>ï¼šä¸ºæ–‡æ¡£æ ‘ä¸­æŸä¸ªèŠ‚ç‚¹çš„ DOM è¡¨ç°æ·»åŠ æ ·å¼æˆ–å±æ€§
ã€‚</li>
<li><strong>å°éƒ¨ä»¶è£…é¥°ï¼ˆWidget decorationsï¼‰</strong>ï¼šåœ¨æ–‡æ¡£ä¸­çš„æŸä¸ªä½ç½®æ’å…¥ä¸€ä¸ªè‡ªå®šä¹‰çš„ DOM
èŠ‚ç‚¹ï¼Œè¯¥èŠ‚ç‚¹ä¸å±äºæ–‡æ¡£å†…å®¹æœ¬èº«ã€‚</li>
<li><strong>å†…è”è£…é¥°ï¼ˆInline decorationsï¼‰</strong>ï¼šç±»ä¼¼èŠ‚ç‚¹è£…é¥°ï¼Œä¸ºä¸€æ®µèŒƒå›´å†…çš„æ‰€æœ‰å†…è”èŠ‚ç‚¹æ·»
åŠ æ ·å¼æˆ–å±æ€§ï¼Œä½†ä»…å½±å“å®ƒä»¬çš„æ˜¾ç¤ºï¼Œä¸æ”¹å˜æ–‡æ¡£ç»“  æ„ã€‚</li>
</ul>
<p>ä¸ºäº†é«˜æ•ˆåœ°ç®¡ç†è£…é¥°ï¼Œéœ€è¦ä½¿ç”¨ <code>DecorationSet</code>ã€‚<code>DecorationSet</code> æ˜¯ä¸€ç§æ¨¡ä»¿æ–‡æ¡£æ ‘ç»“
æ„çš„æ•°æ®ç»“æ„ï¼Œå¯ä»¥å¯¹è£…é¥°è¿›è¡Œå¿«é€Ÿæ¯”è¾ƒå’Œæ›´æ–°ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªæ’ä»¶ï¼Œåœ¨æ•´ä¸ªæ–‡
æ¡£èŒƒå›´å†…ä¸ºå†…å®¹æ·»åŠ ç´«è‰²å­—ä½“çš„è£…é¥°ï¼š</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> purplePlugin </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">Plugin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token literal-property property">props</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">decorations</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">state</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token maybe-class-name">DecorationSet</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">create</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">doc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token maybe-class-name">Decoration</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">inline</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> state</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">doc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">content</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">size</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token literal-property property">style</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;color: purple&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å¦‚æœè£…é¥°æ•°é‡è¾ƒå¤šï¼Œæ‚¨å¯èƒ½å¸Œæœ›å°†è£…é¥°é›†åˆä¿å­˜åœ¨æ’ä»¶çŠ¶æ€ä¸­ï¼Œå¹¶åœ¨äº‹åŠ¡ä¸­ä½¿ç”¨ <code>map</code> æ–¹
æ³•å°†å…¶å‰ç§»ï¼Œåªåœ¨éœ€è¦æ—¶æ›´æ–°å®ƒã€‚ä¾‹å¦‚ï¼š</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> specklePlugin </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">Plugin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token literal-property property">state</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">init</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">_</span><span class="token parameter punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token parameter"> </span><span class="token parameter punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token parameter"> doc </span><span class="token parameter punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> speckles </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> pos </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> pos </span><span class="token operator">&lt;</span><span class="token plain"> doc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">content</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">size</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> pos </span><span class="token operator">+=</span><span class="token plain"> </span><span class="token number">4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        speckles</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">push</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token maybe-class-name">Decoration</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">inline</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">pos </span><span class="token operator">-</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> pos</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token literal-property property">style</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;background: yellow&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token maybe-class-name">DecorationSet</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">create</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">doc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> speckles</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">apply</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">tr</span><span class="token parameter punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token parameter"> </span><span class="token parameter keyword" style="color:rgb(189, 147, 249);font-style:italic">set</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> set</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">map</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">tr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">mapping</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> tr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">doc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token literal-property property">props</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">decorations</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">state</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> specklePlugin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">getState</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¯¥æ’ä»¶åˆå§‹åŒ–çŠ¶æ€æ—¶ï¼Œä¼šåœ¨æ¯ç¬¬ 4 ä¸ªä½ç½®æ·»åŠ ä¸€ä¸ªé»„è‰²èƒŒæ™¯çš„å†…è”è£…é¥°ã€‚åœ¨çŠ¶æ€æ›´æ–°æ—¶ï¼Œ
æ’ä»¶çš„ <code>apply</code> æ–¹æ³•ä¼šä½¿ç”¨æ˜ å°„ï¼ˆmappingï¼‰å°†è£…é¥°é›†è‡ªåŠ¨å‰ç§»ï¼Œä½¿è£…é¥°åœ¨æ–‡æ¡£å˜æ›´åä»ä¿
æŒåœ¨æ­£ç¡®ä½ç½®ã€‚è¿™æ ·ï¼Œåªæœ‰æ–‡æ¡£å®é™…å˜åŒ–è¿‡çš„éƒ¨åˆ†è£…é¥°æ‰ä¼šè¢«é‡æ–°è®¡ç®—ï¼Œå…¶ä½™éƒ¨åˆ†ä¿æŒä¸å˜
ã€‚</p>
<p>æœ€åï¼Œå½“ç¼–è¾‘å™¨æ¸²æŸ“æ—¶ï¼Œ<code>decorations</code> å±æ€§è¿”å›çš„è£…é¥°é›†åˆä¼šè¢«åº”ç”¨åˆ°è§†å›¾ä¸­ï¼Œä»è€Œä½¿è£…
é¥°ç”Ÿæ•ˆã€‚</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="èŠ‚ç‚¹è§†å›¾-node-views">èŠ‚ç‚¹è§†å›¾ (Node views)<a href="#èŠ‚ç‚¹è§†å›¾-node-views" class="hash-link" aria-label="èŠ‚ç‚¹è§†å›¾ (Node views)çš„ç›´æ¥é“¾æ¥" title="èŠ‚ç‚¹è§†å›¾ (Node views)çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>è¿˜æœ‰ä¸€ç§æ–¹å¼å¯ä»¥å½±å“ç¼–è¾‘å™¨è§†å›¾å¯¹èŠ‚ç‚¹çš„æ¸²æŸ“â€”â€”èŠ‚ç‚¹è§†å›¾ï¼ˆNode viewsï¼‰ã€‚èŠ‚ç‚¹è§†å›¾å…è®¸
æ‚¨ä¸ºæ–‡æ¡£ä¸­çš„ç‰¹å®šèŠ‚ç‚¹ç±»å‹å®šä¹‰ä¸€ä¸ªâ€œè¿·ä½  UI ç»„ä»¶â€ï¼Œè‡ªå®šä¹‰å®ƒä»¬çš„ DOM è¡¨ç°å¹¶å¤„ç†äº¤äº’
ã€‚ä¾‹å¦‚ï¼š</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> view </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">EditorView</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  state</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token literal-property property">nodeViews</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">image</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">node</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">ImageView</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">node</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">class</span><span class="token plain"> </span><span class="token class-name">ImageView</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token function" style="color:rgb(80, 250, 123)">constructor</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">node</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// è¿™å°†ä½œä¸ºå›¾åƒèŠ‚ç‚¹çš„ DOM è¡¨ç°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">this</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">dom</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token dom variable" style="color:rgb(189, 147, 249);font-style:italic">document</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">createElement</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;img&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">this</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">dom</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">src</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> node</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">attrs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">src</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">this</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">dom</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">addEventListener</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;click&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">e</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token console class-name">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">log</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;You clicked me!&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      e</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">preventDefault</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token function" style="color:rgb(80, 250, 123)">stopEvent</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ä¸Šè¿°ç¤ºä¾‹ä¸º <code>image</code> èŠ‚ç‚¹å®šä¹‰äº†ä¸€ä¸ªè§†å›¾ï¼Œå®ƒåˆ›å»ºäº†ä¸€ä¸ªè‡ªå®šä¹‰çš„ <code>&lt;img&gt;</code> DOM å…ƒç´ ï¼Œå¹¶
ä¸ºå…¶æ·»åŠ äº†ç‚¹å‡»å¤„ç†å™¨ã€‚é€šè¿‡å®šä¹‰ <code>stopEvent() { return true }</code>ï¼Œè¿™ä¸ªèŠ‚ç‚¹è§†å›¾å‘Šè¯‰
ProseMirror åº”è¯¥å¿½ç•¥è¿™ä¸ª DOM å…ƒç´ ä¸Šçš„æ‰€æœ‰äº‹ä»¶ï¼Œè®©æ‚¨å®Œå…¨æŒæ§å®ƒã€‚</p>
<p>é€šå¸¸æˆ‘ä»¬å¸Œæœ›èŠ‚ç‚¹è§†å›¾ä¸­çš„äº¤äº’èƒ½å¤Ÿå½±å“æ–‡æ¡£æœ¬èº«ã€‚ä¸ºæ­¤ï¼ŒèŠ‚ç‚¹è§†å›¾å¯ä»¥è·å¾—ä¸€ä¸ª
<code>getPos</code> å›è°ƒå‡½æ•°ï¼Œç”¨äºè·å–è¯¥èŠ‚ç‚¹åœ¨æ–‡æ¡£ä¸­çš„å½“å‰ä½ç½®ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬ä¿®æ”¹ä¸Šè¿°ç¤ºä¾‹ï¼Œè®©
ç‚¹å‡»å›¾ç‰‡æ—¶å¼¹å‡ºå¯¹è¯æ¡†è¾“å…¥æ–°çš„ alt æ–‡æœ¬ï¼š</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> view </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">EditorView</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  state</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token literal-property property">nodeViews</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">image</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">node</span><span class="token parameter punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token parameter"> view</span><span class="token parameter punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token parameter"> getPos</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">ImageView</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">node</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> view</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> getPos</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">class</span><span class="token plain"> </span><span class="token class-name">ImageView</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token function" style="color:rgb(80, 250, 123)">constructor</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">node</span><span class="token parameter punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token parameter"> view</span><span class="token parameter punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token parameter"> getPos</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">this</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">dom</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token dom variable" style="color:rgb(189, 147, 249);font-style:italic">document</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">createElement</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;img&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">this</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">dom</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">src</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> node</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">attrs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">src</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">this</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">dom</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">alt</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> node</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">attrs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">alt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">this</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">dom</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">addEventListener</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;click&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">e</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      e</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">preventDefault</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> alt </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">prompt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;New alt text:&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">alt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        view</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">dispatch</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          view</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">state</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">tr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">setNodeMarkup</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token function" style="color:rgb(80, 250, 123)">getPos</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword null nil" style="color:rgb(189, 147, 249);font-style:italic">null</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token literal-property property">src</span><span class="token operator">:</span><span class="token plain"> node</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">attrs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">src</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            alt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token function" style="color:rgb(80, 250, 123)">stopEvent</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå½“ç”¨æˆ·ç‚¹å‡»å›¾ç‰‡æ—¶ä¼šå¼¹å‡º <code>prompt</code> å¯¹è¯æ¡†è¾“å…¥æ–°çš„ alt æ–‡æœ¬ã€‚æˆ‘ä»¬ä½¿ç”¨
<code>view.dispatch(view.state.tr.setNodeMarkup(getPos(), null, {...}))</code> æ¥å‘é€ä¸€ä¸ªäº‹
åŠ¡  ï¼Œè°ƒç”¨ <code>setNodeMarkup</code> æ–¹æ³•æ›´æ”¹è¯¥å›¾ç‰‡èŠ‚ç‚¹çš„å±æ€§ï¼ˆå…¶ä¸­åŒ…å«æ–°çš„ <code>alt</code> æ–‡æœ¬ï¼‰
ã€‚<code>getPos()</code> æä¾›äº†è¯¥èŠ‚ç‚¹åœ¨æ–‡æ¡£ä¸­çš„ä½ç½®ã€‚</p>
<p>åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“èŠ‚ç‚¹è¢«æ›´æ–°æ—¶ï¼Œç¼–è¾‘å™¨ä¼šä¿ç•™èŠ‚ç‚¹çš„å¤–å±‚ DOM å…ƒç´ ï¼Œä»…æ›´æ–°å­èŠ‚ç‚¹éƒ¨åˆ†
ã€‚èŠ‚ç‚¹è§†å›¾å¯ä»¥è¦†ç›–è¿™ä¸€è¡Œä¸ºã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æƒ³æ ¹æ®æ®µè½çš„å†…å®¹ä¸ºç©ºæƒ…å†µç»™æ®µè½åŠ ä¸Šæˆ–å»
æ‰ä¸€ä¸ª CSS ç±»ï¼Œå¯ä»¥è¿™æ ·åšï¼š</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> view </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">EditorView</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  state</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token literal-property property">nodeViews</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">paragraph</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">node</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">ParagraphView</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">node</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">class</span><span class="token plain"> </span><span class="token class-name">ParagraphView</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token function" style="color:rgb(80, 250, 123)">constructor</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">node</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">this</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">dom</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">this</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">contentDOM</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token dom variable" style="color:rgb(189, 147, 249);font-style:italic">document</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">createElement</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;p&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">node</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">content</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">size</span><span class="token plain"> </span><span class="token operator">==</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">this</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">dom</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">classList</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">add</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;empty&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token function" style="color:rgb(80, 250, 123)">update</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">node</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">node</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">content</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">size</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">this</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">dom</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">classList</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">remove</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;empty&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">this</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">dom</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">classList</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">add</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;empty&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä¸º <code>paragraph</code> èŠ‚ç‚¹å®šä¹‰äº†è§†å›¾ï¼šå¦‚æœæ®µè½å†…å®¹ä¸ºç©º
ï¼ˆ<code>node.content.size == 0</code>ï¼‰ï¼Œå°±æ·»åŠ  <code>empty</code> ç±»ï¼›å¦åˆ™ç§»é™¤è¯¥ç±»ã€‚æˆ‘ä»¬æŠŠ
<code>this.contentDOM</code> è®¾ç½®æˆ <code>this.dom</code> æœ¬èº«ï¼Œè¡¨ç¤ºæ®µè½çš„å†…å®¹ç›´æ¥ç¼–è¾‘åœ¨ <code>&lt;p&gt;</code> æ ‡ç­¾å†…
ã€‚<code>update</code> æ–¹æ³•ä¼šåœ¨èŠ‚ç‚¹å†…å®¹å˜åŒ–æ—¶è°ƒç”¨ï¼Œç”¨äºæ›´æ–°å¤–å±‚ DOM çš„ç±»åï¼Œå¹¶è¿”å› <code>true</code> è¡¨
ç¤ºæ›´æ–°æˆåŠŸï¼ŒProseMirror ä¼šç»§ç»­æ›´æ–°å…¶å†…å®¹éƒ¨åˆ†ã€‚</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="å‘½ä»¤-commands-1">å‘½ä»¤ (Commands)<a href="#å‘½ä»¤-commands-1" class="hash-link" aria-label="å‘½ä»¤ (Commands)çš„ç›´æ¥é“¾æ¥" title="å‘½ä»¤ (Commands)çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>åœ¨ ProseMirror ä¸­ï¼Œå‘½ä»¤ï¼ˆCommandsï¼‰æ˜¯ä¸€ç§å‡½æ•°ï¼Œç”¨äºå®ç°ç”¨æˆ·å¯æ‰§è¡Œçš„ç¼–è¾‘æ“ä½œã€‚è¿™
äº›æ“ä½œå¯ä»¥é€šè¿‡å¿«æ·é”®ã€èœå•ç­‰è§¦å‘ã€‚å‘½ä»¤é€šå¸¸ä¼šæ¥æ”¶ä¸€ä¸ªç¼–è¾‘å™¨çŠ¶æ€ï¼ˆstateï¼‰å’Œä¸€ä¸ªå¯
é€‰çš„è°ƒåº¦å‡½æ•°ï¼ˆdispatchï¼‰ã€‚å¦‚æœå‘½ä»¤å¯ä»¥æ‰§è¡Œï¼Œåˆ™å®ƒåº”è¯¥ä½¿ç”¨ <code>dispatch</code> æ¥æ´¾å‘ä¸€ä¸ªäº‹
åŠ¡å¹¶è¿”å› <code>true</code>ï¼›å¦‚æœå‘½ä»¤ä¸é€‚ç”¨ï¼Œåˆ™è¿”å› <code>false</code>ã€‚è¿™æ˜¯æˆ‘ä»¬ä¹‹å‰ä»‹ç»è¿‡çš„å†…å®¹ã€‚ä»¥ä¸‹
æ˜¯å¦ä¸€ä¸ªç¤ºä¾‹ï¼š</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">deleteSelection</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token parameter"> dispatch</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">selection</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">empty</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">dispatch</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">dispatch</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">tr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">deleteSelection</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>è¦åˆ¤æ–­æŸä¸ªå‘½ä»¤æ˜¯å¦å¯ç”¨ä½†ä¸æ‰§è¡Œå®ƒï¼Œæ‚¨å¯ä»¥è°ƒç”¨å®ƒæ—¶ä¸ä¼ å…¥ <code>dispatch</code>ï¼ˆæˆ–ä¼  <code>null</code>ï¼‰
ã€‚ä¾‹å¦‚ï¼šå¦‚æœè¦åˆ¤æ–­å½“å‰é€‰åŒºæ˜¯å¦å¯åˆ é™¤ï¼Œå¯ä»¥è°ƒç”¨
<code>deleteSelection(view.state, null)</code>ï¼›è€Œè¦çœŸæ­£æ‰§è¡Œè¯¥å‘½ä»¤ï¼Œå°±è°ƒç”¨
<code>deleteSelection(view.state, view.dispatch)</code>ã€‚èœå•æ å¯ä»¥åˆ©ç”¨è¿™ä¸€æœºåˆ¶æ¥å†³å®šå“ªäº›èœ
å•é¡¹éœ€è¦ç½®ç°ï¼ˆdisabledï¼‰ã€‚</p>
<p>å‘½ä»¤å‡½æ•°å¯ä»¥è¿”å› <code>true</code>ï¼ˆè¡¨ç¤ºå‘½ä»¤å·²è¢«å¤„ç†å¹¶ä¸”ä¸åº”ç»§ç»­å¤„ç†ï¼‰æˆ– <code>false</code>ã€‚åœ¨é»˜è®¤é”®
ç›˜æ˜ å°„ä¸­ï¼Œè¿™ä¸€è¿”å›å€¼ç”¨äºé˜»æ­¢é”®äº‹ä»¶çš„ä¼ æ’­ã€‚</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ååŒç¼–è¾‘-collaborative-editing">ååŒç¼–è¾‘ (Collaborative editing)<a href="#ååŒç¼–è¾‘-collaborative-editing" class="hash-link" aria-label="ååŒç¼–è¾‘ (Collaborative editing)çš„ç›´æ¥é“¾æ¥" title="ååŒç¼–è¾‘ (Collaborative editing)çš„ç›´æ¥é“¾æ¥">â€‹</a></h2>
<p>å®æ—¶ååŒç¼–è¾‘å…è®¸å¤šä¸ªç”¨æˆ·åŒæ—¶ç¼–è¾‘åŒä¸€ä¸ªæ–‡æ¡£ã€‚ä»–ä»¬çš„æ›´æ”¹ä¼šç«‹å³åº”ç”¨åˆ°å„è‡ªçš„æœ¬åœ°æ–‡æ¡£
ä¸Šï¼Œå¹¶éšåå‘é€ç»™å…¶ä»–ç”¨æˆ·ã€‚å…¶å®ƒç”¨æˆ·ä¼šè‡ªåŠ¨åˆå¹¶è¿™äº›æ›´æ”¹ï¼ˆæ— éœ€æ‰‹åŠ¨è§£å†³å†²çªï¼‰ï¼Œä»è€Œä¿
è¯æ–‡æ¡£æœ€ç»ˆä¿æŒä¸€è‡´ã€‚æœ¬æŒ‡å—æ¥ä¸‹æ¥å°†ä»‹ç»å¦‚ä½•è¿æ¥ ProseMirror çš„ååŒç¼–è¾‘åŠŸèƒ½ã€‚</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ç®—æ³•-algorithm">ç®—æ³• (Algorithm)<a href="#ç®—æ³•-algorithm" class="hash-link" aria-label="ç®—æ³• (Algorithm)çš„ç›´æ¥é“¾æ¥" title="ç®—æ³• (Algorithm)çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>ProseMirror çš„ååŒç¼–è¾‘ç³»ç»Ÿä½¿ç”¨ä¸€ä¸ª<strong>ä¸­å¤®åè°ƒæœåŠ¡</strong>ï¼ˆcentral authorityï¼‰æ¥ç¡®å®šæ›´
æ”¹çš„åº”ç”¨é¡ºåºã€‚å¦‚æœä¸¤ä¸ªç¼–è¾‘è€…åŒæ—¶æäº¤æ›´æ”¹ï¼Œå®ƒä»¬éƒ½  ä¼šå°†æ›´æ”¹å‘é€åˆ°è¯¥æœåŠ¡ã€‚æœåŠ¡ä¼šæ¥å—
å…¶ä¸­ä¸€ä¸ªç¼–è¾‘è€…çš„æ›´æ”¹å¹¶å¹¿æ’­ç»™æ‰€æœ‰ç¼–è¾‘è€…ï¼›å¦ä¸€ä¸ªç¼–è¾‘è€…çš„æ›´æ”¹ä¼šæš‚æ—¶è¢«æ‹’ç»ã€‚å½“è¯¥ç¼–è¾‘
è€…æ¥æ”¶åˆ°æœåŠ¡å™¨çš„æ›´æ–°æ—¶ï¼Œå®ƒå°†æŠŠè‡ªå·±çš„æ›´æ”¹<strong>é‡æ–°åŸºå‡†åŒ–</strong>ï¼ˆrebaseï¼‰åˆ°æ–°çš„æ–‡æ¡£åŸºç¡€ä¸Š
ï¼Œç„¶åå†æ¬¡å°è¯•æäº¤ã€‚è¿™ç§æ–¹å¼ä½¿å¾—æ‰€æœ‰ç¼–è¾‘è€…æœ€ç»ˆéƒ½èƒ½å¾—åˆ°ç›¸åŒçš„æ–‡æ¡£ã€‚</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="åè°ƒæœåŠ¡-the-authority">åè°ƒæœåŠ¡ (The Authority)<a href="#åè°ƒæœåŠ¡-the-authority" class="hash-link" aria-label="åè°ƒæœåŠ¡ (The Authority)çš„ç›´æ¥é“¾æ¥" title="åè°ƒæœåŠ¡ (The Authority)çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p>åè°ƒæœåŠ¡ï¼ˆAuthorityï¼‰çš„ä½œç”¨å¾ˆç®€å•ï¼šå®ƒéœ€è¦è¿½è¸ªå½“å‰çš„æ–‡æ¡£ç‰ˆæœ¬ï¼Œæ¥å—ç¼–è¾‘è€…æäº¤çš„æ›´
æ”¹å¹¶æŒ‰é¡ºåºç´¯ç§¯è¿™äº›æ›´æ”¹ï¼Œä»¥åŠåœ¨ç¼–è¾‘è€…æŸ¥è¯¢æ—¶æä¾›æŒ‡å®šç‰ˆæœ¬ä¹‹åçš„æ‰€æœ‰æ–°æ›´æ”¹ã€‚ä»¥ä¸‹æ˜¯ä¸€
ä¸ªè¿è¡Œåœ¨åŒä¸€ JavaScript ç¯å¢ƒä¸­çš„ç®€å•å®ç°ç¤ºä¾‹ï¼š</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">class</span><span class="token plain"> </span><span class="token class-name">Authority</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token function" style="color:rgb(80, 250, 123)">constructor</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">doc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">this</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">doc</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> doc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">this</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">steps</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// å·²æ¥å—çš„æ‰€æœ‰æ­¥éª¤</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">this</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">stepClientIDs</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// è®°å½•æ¯ä¸ªæ­¥éª¤æ¥è‡ªå“ªä¸ªå®¢æˆ·ç«¯</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">this</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">onNewSteps</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// å½“æœ‰æ–°æ­¥éª¤æ—¶çš„å›è°ƒåˆ—è¡¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token function" style="color:rgb(80, 250, 123)">receiveSteps</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">version</span><span class="token parameter punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token parameter"> steps</span><span class="token parameter punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token parameter"> clientID</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">version </span><span class="token operator">!=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">this</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">steps</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// åº”ç”¨å¹¶ç´¯ç§¯æ–°æ­¥éª¤</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    steps</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">forEach</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">step</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">this</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">doc</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> step</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">apply</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">this</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">doc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">doc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">this</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">steps</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">push</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">step</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">this</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">stepClientIDs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">push</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">clientID</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// é€šçŸ¥ç›‘å¬å™¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">this</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">onNewSteps</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">forEach</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token function" style="color:rgb(80, 250, 123)">stepsSince</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">version</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token literal-property property">steps</span><span class="token operator">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">this</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">steps</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">slice</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">version</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token literal-property property">clientIDs</span><span class="token operator">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">this</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">stepClientIDs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">slice</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">version</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>å½“ä¸€ä¸ªç¼–è¾‘å™¨æƒ³è¦æäº¤å…¶æœ¬åœ°æ›´æ”¹ç»™åè°ƒæœåŠ¡æ—¶ï¼Œå®ƒä¼šè°ƒç”¨
<code>authority.receiveSteps(version, steps, clientID)</code>ï¼Œä¼ å…¥å®ƒæ‰€çŸ¥çš„æœ€æ–°ç‰ˆæœ¬å·ã€åˆšäº§
ç”Ÿçš„æ–°æ­¥éª¤ä»¥åŠå®ƒçš„å®¢æˆ·ç«¯æ ‡è¯† <code>clientID</code>ã€‚å¦‚æœæœåŠ¡æ¥å—äº†è¿™äº›æ­¥éª¤ï¼ˆç‰ˆæœ¬åŒ¹é…æ—¶ï¼‰ï¼Œ
å®ƒå°±ä¼šæŠŠå®ƒä»¬æ·»åŠ åˆ°è‡ªå·±çš„æ–‡æ¡£ä¸­ï¼Œå¹¶é€šçŸ¥æ‰€æœ‰ç›‘å¬è€…ï¼ˆé€šè¿‡ <code>onNewSteps</code> å›è°ƒï¼‰ã€‚</p>
<p>å½“è¿™äº›æ­¥éª¤è¢«æ¥å—åï¼Œç¼–è¾‘å™¨ä¼šé€šè¿‡ <code>onNewSteps</code> å›è°ƒçŸ¥é“æœ‰æ–°æ­¥éª¤äº§ç”Ÿï¼Œç„¶åå–å‡ºè‡ªå·±
æ–°äº§ç”Ÿçš„æ­¥éª¤æ¥è¿›è¡Œæ“ä½œã€‚åœ¨å®é™…éƒ¨ç½²ä¸­ï¼Œæ‚¨å¯ä»¥é€‰æ‹©è®© <code>receiveSteps</code> è¿”å›çŠ¶æ€æ¥ç«‹å³
ç¡®è®¤æ”¶åˆ°æ­¥éª¤ï¼Œä½†ä¸Šè¿°æœºåˆ¶æ˜¯ç¡®ä¿åœ¨ä¸å¯é è¿æ¥ä¸Šä¹Ÿèƒ½åŒæ­¥çš„åŸºç¡€ã€‚</p>
<p>æ­¤å®ç°ä¼šæ— é™ç´¯ç§¯æ­¥éª¤åˆ—è¡¨ï¼Œå› æ­¤åˆ—è¡¨çš„é•¿åº¦å°±æ˜¯å½“å‰æ–‡æ¡£çš„ç‰ˆæœ¬å·ã€‚æ‚¨å¯èƒ½å¸Œæœ›è®©åè°ƒæœ
åŠ¡åœ¨æŸä¸ªæ—¶å€™ä¸¢å¼ƒæ—§æ­¥éª¤ä»¥é‡Šæ”¾å†…å­˜ï¼Œä½†æ€»ä½“æ€è·¯å°±æ˜¯è¿™æ ·ã€‚</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="collab-æ¨¡å—"><code>collab</code> æ¨¡å—<a href="#collab-æ¨¡å—" class="hash-link" aria-label="collab-æ¨¡å—çš„ç›´æ¥é“¾æ¥" title="collab-æ¨¡å—çš„ç›´æ¥é“¾æ¥">â€‹</a></h3>
<p><code>prosemirror-collab</code> æ¨¡å—å¯¼å‡ºäº†ä¸€ä¸ª <code>collab</code> å‡½æ•°ï¼Œå®ƒç”Ÿæˆä¸€ä¸ªæ’ä»¶ ï¼Œç”¨äºè¿½è¸ªæœ¬åœ°
æ›´æ”¹ã€æ¥æ”¶è¿œç¨‹æ›´æ”¹å¹¶æŒ‡ç¤ºä½•æ—¶å‘é€æ›´æ”¹åˆ°åè°ƒæœåŠ¡ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼š</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword module" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">EditorState</span><span class="token imports"> </span><span class="token imports punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;prosemirror-state&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword module" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">EditorView</span><span class="token imports"> </span><span class="token imports punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;prosemirror-view&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword module" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token imports"> schema </span><span class="token imports punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;prosemirror-schema-basic&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword module" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> </span><span class="token imports">collab</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;prosemirror-collab&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">collabEditor</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">authority</span><span class="token parameter punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token parameter"> place</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> view </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">EditorView</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">place</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token literal-property property">state</span><span class="token operator">:</span><span class="token plain"> </span><span class="token maybe-class-name">EditorState</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">create</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token literal-property property">doc</span><span class="token operator">:</span><span class="token plain"> authority</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">doc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token literal-property property">plugins</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">collab</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">collab</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token literal-property property">version</span><span class="token operator">:</span><span class="token plain"> authority</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">steps</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">length</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">dispatchTransaction</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">transaction</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> newState </span><span class="token operator">=</span><span class="token plain"> view</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">state</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">apply</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">transaction</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      view</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">updateState</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">newState</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> sendable </span><span class="token operator">=</span><span class="token plain"> collab</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">sendableSteps</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">newState</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">sendable</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)">// å°†æœ¬åœ°æœªç¡®è®¤çš„æ­¥éª¤å‘é€ç»™åè°ƒæœåŠ¡</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        authority</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">receiveSteps</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          sendable</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">version</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          sendable</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">steps</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          sendable</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">clientID</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  authority</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">onNewSteps</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">push</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> newData </span><span class="token operator">=</span><span class="token plain"> authority</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">stepsSince</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">collab</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">getVersion</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">view</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">state</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// å°†ä»æœåŠ¡æ”¶åˆ°çš„æ­¥éª¤åº”ç”¨åˆ°æœ¬åœ°çŠ¶æ€</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    view</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">dispatch</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      collab</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">receiveTransaction</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">view</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">state</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> newData</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">steps</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> newData</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">clientIDs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> view</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>collabEditor</code> å‡½æ•°åˆ›å»ºäº†ä¸€ä¸ªå¸¦æœ‰ <code>collab</code> æ’ä»¶çš„ç¼–è¾‘å™¨ã€‚æ¯å½“çŠ¶æ€æ›´æ–°æ—¶ï¼Œå®ƒè°ƒç”¨
<code>collab.sendableSteps(newState)</code> æ¥æ£€æŸ¥æ˜¯å¦æœ‰æœ¬åœ°æ­¥éª¤éœ€è¦å‘é€ç»™åè°ƒæœåŠ¡ã€‚å¦‚æœæœ‰
ï¼Œå°±è°ƒç”¨ <code>authority.receiveSteps</code> å‘é€å®ƒä»¬ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬ä¸ºåè°ƒæœåŠ¡çš„ <code>onNewSteps</code>
äº‹ä»¶æ³¨å†Œå›è°ƒï¼šå½“æœ‰æ–°æ­¥éª¤åˆ°æ¥æ—¶ï¼Œè·å–è‡ªå½“å‰çŠ¶æ€ç‰ˆæœ¬ä»¥æ¥çš„æ–°æ­¥éª¤ï¼Œå¹¶ä½¿ç”¨
<code>collab.receiveTransaction</code> åˆ›å»ºä¸€ä¸ªæ›´æ–°æœ¬åœ°çŠ¶æ€çš„äº‹åŠ¡å¹¶æ´¾å‘å®ƒã€‚</p>
<p>å¦‚æœåè°ƒæœåŠ¡æ‹’ç»äº†æŸäº›æ­¥éª¤ï¼Œè¿™äº›æ­¥éª¤ä¼šä¿æŒæœªç¡®è®¤çŠ¶æ€ï¼Œç›´åˆ°æ”¶åˆ°æ¥è‡ªæœåŠ¡å™¨çš„æ–°æ­¥éª¤
ã€‚åœ¨æ”¶åˆ°ä¹‹åï¼Œç”±äº <code>onNewSteps</code> å›è°ƒä¼šè§¦å‘ä¸€æ¬¡ dispatchï¼Œæœ¬åœ°çš„æœªç¡®è®¤æ­¥éª¤å°±ä¼šå†
æ¬¡å°è¯•æäº¤ã€‚</p>
<p>ä»¥ä¸Šå°±æ˜¯è®¾ç½®ååŒç¼–è¾‘çš„åŸºæœ¬æ­¥éª¤ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œæ‚¨è¿˜éœ€è¦å¤„ç†å¼‚æ­¥é€šä¿¡ï¼ˆå¦‚ä½¿ç”¨
WebSocket æˆ–è½®è¯¢ï¼‰ã€é”™è¯¯å¤„ç†ä»¥åŠå¦‚ä½•è®©åè°ƒæœåŠ¡å®šæœŸä¸¢å¼ƒæ—§æ­¥éª¤ç­‰é—®é¢˜ã€‚ä½†åŸºæœ¬åŸç†ç”±
ä¸Šè¿°ç¤ºä¾‹å®Œæ•´æè¿°ã€‚</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>æ ‡ç­¾ï¼š</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/my-website/blog/tags/å‰ç«¯">å‰ç«¯</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/my-website/blog/tags/å¯Œæ–‡æœ¬">å¯Œæ–‡æœ¬</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/my-website/blog/tags/prosemirror">prosemirror</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="è®¡ç®—æœºç¼–ç å­¦ä¹ è®°å½•"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/my-website/blog/2023/10/27/character-encoding">è®¡ç®—æœºä¸­çš„å­—ç¬¦ç¼–ç </a></h2><div class="container_mt6G margin-vert--md"><time datetime="2023-10-27T00:00:00.000Z" itemprop="datePublished">2023å¹´10æœˆ27æ—¥</time> Â· <!-- -->é˜…è¯»éœ€ 17 åˆ†é’Ÿ</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/hbche" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/hbche.png" alt="Hanbin Che" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/hbche" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Hanbin Che</span></a></div><small class="avatar__subtitle" itemprop="description">Front End Engineer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>è®¡ç®—æœºå­—ç¬¦ç¼–ç æ˜¯ä¸€ç§æ–¹æ³•ï¼Œç”¨äºå°†å­—ç¬¦ï¼ˆåŒ…æ‹¬å­—æ¯ã€æ•°å­—ã€ç¬¦å·å’Œæ§åˆ¶å­—ç¬¦ï¼‰æ˜ å°„åˆ°æ•°å­—å€¼ï¼Œä»¥ä¾¿è®¡ç®—æœºèƒ½å¤Ÿå¤„ç†å’Œå­˜å‚¨æ–‡æœ¬æ•°æ®ã€‚å­—ç¬¦ç¼–ç é€šå¸¸å°†æ¯ä¸ªå­—ç¬¦æ˜ å°„åˆ°å”¯ä¸€çš„æ•°å­—å€¼ï¼Œä»¥ä¾¿è®¡ç®—æœºèƒ½å¤Ÿè¯†åˆ«å’Œæ“ä½œæ–‡æœ¬ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„è®¡ç®—æœºå­—ç¬¦ç¼–ç ï¼š</p>
<ol>
<li>
<p><strong>ASCII ç¼–ç ï¼ˆAmerican Standard Code for Information Interchangeï¼‰ï¼š</strong> ASCII æ˜¯æœ€æ—©çš„å­—ç¬¦ç¼–ç æ ‡å‡†ï¼Œå®ƒä½¿ç”¨ 7 ä½äºŒè¿›åˆ¶æ•°è¡¨ç¤º 128 ä¸ªå­—ç¬¦ï¼ŒåŒ…æ‹¬è‹±æ–‡å­—æ¯ã€æ•°å­—ã€æ ‡ç‚¹ç¬¦å·å’Œæ§åˆ¶å­—ç¬¦ã€‚ASCII ç¼–ç é€šå¸¸ä½¿ç”¨ä¸€ä¸ªå­—èŠ‚ï¼ˆ8 ä½ï¼‰æ¥è¡¨ç¤ºå­—ç¬¦ï¼Œå…¶ä¸­æœ€é«˜ä½é€šå¸¸ä¸ç”¨äºå­—ç¬¦è¡¨ç¤ºï¼Œè€Œç”¨äºå¥‡å¶æ ¡éªŒã€‚</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><p>å¥‡å¶æ ¡éªŒ</p></summary><div><div class="collapsibleContent_i85q"><p>å­—ç¬¦çš„å¥‡å¶æ ¡éªŒæ˜¯ä¸€ç§é”™è¯¯æ£€æµ‹æŠ€æœ¯ï¼Œç”¨äºç¡®ä¿ä¼ è¾“æˆ–å­˜å‚¨çš„å­—ç¬¦æ•°æ®çš„å‡†ç¡®æ€§ã€‚è¿™ç§æ ¡éªŒæ–¹æ³•é€šè¿‡åœ¨å­—ç¬¦çš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸­æ·»åŠ é¢å¤–çš„ä½æ¥æ£€æµ‹å’Œçº æ­£å¯èƒ½çš„ä¼ è¾“é”™è¯¯ã€‚é€šå¸¸æœ‰ä¸¤ç§ç±»å‹çš„å¥‡å¶æ ¡éªŒï¼šå¥‡æ ¡éªŒå’Œå¶æ ¡éªŒã€‚</p><ol>
<li><strong>å¥‡æ ¡éªŒï¼ˆOdd Parityï¼‰ï¼š</strong> åœ¨å¥‡æ ¡éªŒä¸­ï¼Œæ ¡éªŒä½è¢«è®¾ç½®ä¸ºç¡®ä¿å­—ç¬¦çš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸­æœ‰å¥‡æ•°ä¸ª&quot;1&quot;ä½ã€‚å¦‚æœå­—ç¬¦çš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸­å·²ç»æœ‰å¥‡æ•°ä¸ª&quot;1&quot;ä½ï¼Œæ ¡éªŒä½åˆ™è¢«è®¾ç½®ä¸º&quot;1&quot;ï¼Œä»¥ä½¿æ•´ä¸ªå­—ç¬¦ï¼ˆåŒ…æ‹¬æ ¡éªŒä½ï¼‰ä¸­æœ‰å¥‡æ•°ä¸ª&quot;1&quot;ä½ã€‚å¦‚æœå­—ç¬¦çš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸­æœ‰å¶æ•°ä¸ª&quot;1&quot;ä½ï¼Œæ ¡éªŒä½åˆ™è¢«è®¾ç½®ä¸º&quot;0&quot;ï¼Œä»¥ç¡®ä¿æ•´ä¸ªå­—ç¬¦ä¸­æœ‰å¥‡æ•°ä¸ª&quot;1&quot;ä½ã€‚</li>
</ol><p>ä¾‹å¦‚ï¼Œè€ƒè™‘  å­—ç¬¦ &quot;1100101&quot;ï¼Œå®ƒæœ‰å¶æ•°ä¸ª&quot;1&quot;ä½ï¼Œå› æ­¤åœ¨å¥‡æ ¡éªŒä¸­ï¼Œæ ¡éªŒä½å°†è¢«è®¾ç½®ä¸º &quot;1&quot;ï¼Œä»¥ç¡®ä¿æ•´ä¸ªå­—ç¬¦ä¸­æœ‰å¥‡æ•°ä¸ª&quot;1&quot;ä½ï¼Œå˜ä¸º &quot;11100101&quot;ã€‚</p><ol start="2">
<li><strong>å¶æ ¡éªŒï¼ˆEven Parityï¼‰ï¼š</strong> åœ¨å¶æ ¡éªŒä¸­ï¼Œæ ¡éªŒä½è¢«è®¾ç½®ä¸ºç¡®ä¿å­—ç¬¦çš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸­æœ‰å¶æ•°ä¸ª&quot;1&quot;ä½ã€‚å¦‚æœå­—ç¬¦çš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸­å·²ç»æœ‰å¶æ•°ä¸ª&quot;1&quot;ä½ï¼Œæ ¡éªŒä½åˆ™è¢«è®¾ç½®ä¸º&quot;1&quot;ï¼Œä»¥ä½¿æ•´ä¸ªå­—ç¬¦ï¼ˆåŒ…æ‹¬æ ¡éªŒä½ï¼‰ä¸­æœ‰å¶æ•°ä¸ª&quot;1&quot;ä½ã€‚å¦‚æœå­—ç¬¦çš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸­æœ‰å¥‡æ•°ä¸ª&quot;1&quot;ä½ï¼Œæ ¡éªŒä½åˆ™è¢«è®¾ç½®ä¸º&quot;0&quot;ï¼Œä»¥ç¡®ä¿æ•´ä¸ªå­—ç¬¦ä¸­æœ‰å¶æ•°ä¸ª&quot;1&quot;ä½ã€‚</li>
</ol><p>ä¾‹å¦‚ï¼Œè€ƒè™‘å­—ç¬¦ &quot;1100100&quot;ï¼Œå®ƒæœ‰å¶æ•°ä¸ª&quot;1&quot;ä½ï¼Œå› æ­¤åœ¨å¶æ ¡éªŒä¸­ï¼Œæ ¡éªŒä½å°†è¢«è®¾ç½®ä¸º &quot;1&quot;ï¼Œä»¥ç¡®ä¿æ•´ä¸ªå­—ç¬¦ä¸­æœ‰å¶æ•°ä¸ª&quot;1&quot;ä½ï¼Œå˜ä¸º &quot;11100100&quot;ã€‚</p><p>å¥‡æ ¡éªŒå’Œå¶æ ¡éªŒé€šå¸¸ç”¨äºä¸²è¡Œé€šä¿¡å’Œå­˜å‚¨ç³»ç»Ÿä¸­ï¼Œä»¥æ£€æµ‹å’Œçº æ­£æ•°æ®ä¼ è¾“ä¸­çš„ä½é”™è¯¯ã€‚é€šè¿‡æ£€æŸ¥æ ¡éªŒä½ï¼Œæ¥æ”¶æ–¹å¯ä»¥ç¡®å®šæ•°æ®æ˜¯å¦åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­å‘ç”Ÿäº†é”™è¯¯ã€‚å¦‚æœæ ¡éªŒå¤±è´¥ï¼Œæ¥æ”¶æ–¹å¯ä»¥è¯·æ±‚é‡æ–°ä¼ è¾“æ•°æ®æˆ–é‡‡å–å…¶ä»–çº æ­£æªæ–½ï¼Œä»¥ç¡®ä¿æ•°æ®çš„å®Œæ•´æ€§ã€‚è¿™ç§å¥‡å¶æ ¡éªŒæ–¹æ³•æ˜¯ä¸€ç§ç®€å•è€Œæœ‰æ•ˆçš„é”™è¯¯æ£€æµ‹æŠ€æœ¯ï¼Œå°¤å…¶é€‚ç”¨äºä¼ è¾“æˆ–å­˜å‚¨è¾ƒå°çš„æ•°æ®å—ã€‚</p></div></div></details>
</li>
<li>
<p><strong>ISO-8859 ç¼–ç ï¼š</strong> ISO-8859 æ˜¯ä¸€ç³»åˆ—å­—ç¬¦ç¼–ç æ ‡å‡†ï¼Œæ¯ä¸ªæ ‡å‡†ç”¨äºæ”¯æŒä¸åŒçš„å­—ç¬¦é›†ï¼Œä¾‹å¦‚ ISO-8859-1 ç”¨äºæ”¯æŒæ‹‰ä¸å­—æ¯å­—ç¬¦é›†ã€‚è¿™äº›ç¼–ç æ ‡å‡†é€šå¸¸ä½¿ç”¨ 8 ä½å­—èŠ‚æ¥è¡¨ç¤ºå­—ç¬¦ã€‚</p>
</li>
<li>
<p><strong>UTF-8 ç¼–ç ï¼ˆUnicode Transformation Format 8-bitï¼‰ï¼š</strong> UTF-8 æ˜¯ä¸€ç§å¯å˜é•¿åº¦å­—ç¬¦ç¼–ç ï¼Œç”¨äºè¡¨ç¤º Unicode å­—ç¬¦é›†ä¸­çš„å­—ç¬¦ã€‚å®ƒå¯ä»¥è¡¨ç¤ºå‡ ä¹æ‰€æœ‰ä¸–ç•Œä¸Šçš„å­—ç¬¦ï¼Œå¹¶ä¸”åœ¨å¤„ç†è‹±æ–‡å­—æ¯ç­‰å¸¸è§å­—ç¬¦æ—¶éå¸¸èŠ‚çœç©ºé—´ã€‚UTF-8 ä½¿ç”¨ 1 åˆ° 4 ä¸ªå­—èŠ‚æ¥è¡¨ç¤ºå­—ç¬¦ï¼Œ å…·ä½“å–å†³äºå­—ç¬¦çš„ Unicode ç ç‚¹ã€‚</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Details</summary><div><div class="collapsibleContent_i85q"><p></p><summary>Unicode ç ç‚¹</summary>
Unicode ç ç‚¹æ˜¯ Unicode å­—ç¬¦é›†ä¸­çš„æ¯ä¸ªå­—ç¬¦æ‰€åˆ†é…çš„å”¯ä¸€æ•°å­—æ ‡è¯†ã€‚æ¯ä¸ªå­—ç¬¦éƒ½ç”±ä¸€ä¸ªæ•´æ•°å€¼æ¥è¡¨ç¤ºï¼Œè¿™ä¸ªæ•´æ•°å€¼å°±æ˜¯ Unicode ç ç‚¹ã€‚Unicode å­—ç¬¦é›†ä¸­çš„æ¯ä¸ªå­—ç¬¦ï¼ŒåŒ…æ‹¬å­—æ¯ã€æ•°å­—ã€ç¬¦å·ã€è¡¨æƒ…ç¬¦å·ç­‰ï¼Œéƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„ Unicode ç ç‚¹ï¼Œç”¨æ¥æ ‡è¯†å’ŒåŒºåˆ†å®ƒä»¬ã€‚<p></p><p>Unicode ç ç‚¹é€šå¸¸ä»¥&quot;U+&quot;ï¼ˆæˆ–&quot;U-&quot;ï¼‰åè·Ÿä¸€ä¸ªæˆ–å¤šä¸ªåå…­è¿›åˆ¶æ•°å­—è¡¨ç¤ºã€‚ä¾‹å¦‚ï¼Œæ‹‰ä¸å­—æ¯ &quot;A&quot; çš„ Unicode ç ç‚¹æ˜¯ U+0041ï¼Œå¸Œè…Šå­—æ¯ &quot;Î©&quot; çš„ Unicode ç ç‚¹æ˜¯ U+03A9ï¼Œè¡¨æƒ…ç¬¦å· &quot;ğŸ˜€&quot; çš„ Unicode ç ç‚¹æ˜¯ U+1F600ã€‚</p><p>Unicode å­—ç¬¦é›†åŒ…å«äº†æ•°ç™¾ä¸‡ä¸ªä¸åŒçš„å­—ç¬¦ï¼Œæ¯ä¸ªå­—ç¬¦éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„ç ç‚¹ï¼Œä»¥æ”¯æŒä¸–ç•Œä¸Šå‡ ä¹æ‰€æœ‰çš„ä¹¦å†™ç³»ç»Ÿå’Œç¬¦å·ã€‚Unicode ç ç‚¹çš„èŒƒå›´ä» U+0000 åˆ° U+10FFFFï¼Œå› æ­¤å¯ä»¥è¡¨ç¤ºå¹¿æ³›çš„å­—ç¬¦é›†ï¼ŒåŒ…æ‹¬ä¸–ç•Œå„ç§è¯­è¨€ã€æ•°å­¦ç¬¦å·ã€è´§å¸ç¬¦å·ã€è¡¨æƒ…ç¬¦å·ç­‰ç­‰ã€‚</p><p>é€šè¿‡ä½¿ç”¨ Unicode ç ç‚¹ï¼Œè®¡ç®—æœºç³»ç»Ÿèƒ½å¤Ÿå¤„ç†å¤šè¯­è¨€æ–‡æœ¬å’Œå¤æ‚å­—ç¬¦é›†ï¼Œç¡®ä¿æ–‡æœ¬åœ¨ä¸åŒç³»ç»Ÿå’Œåº”ç”¨ä¹‹é—´çš„äº’æ“ä½œæ€§ï¼ŒåŒæ—¶å‡å°‘å­—ç¬¦ç¼–ç å’Œå­—ç¬¦é›†çš„æ··æ·†å’Œå†²çªã€‚è¿™ä½¿å¾— Unicode æˆä¸ºå…¨çƒæ ‡å‡†ï¼Œç”¨äºåœ¨è®¡ç®—æœºç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºä¸­è¡¨ç¤ºæ–‡æœ¬æ•°æ®ã€‚</p></div></div></details>
</li>
<li>
<p><strong>UTF-16 ç¼–ç ï¼ˆUnicode Transformation Format 16-bitï¼‰ï¼š</strong> UTF-16 ä¹Ÿç”¨äºè¡¨ç¤º Unicode å­—ç¬¦ï¼Œå®ƒä½¿ç”¨ 16 ä½ç¼–ç å•å…ƒæ¥è¡¨ç¤ºå¤§å¤šæ•°å­—ç¬¦ï¼Œä½†å¯¹äºä¸€äº›ç‰¹æ®Šå­—ç¬¦ï¼Œéœ€è¦ä½¿ç”¨ 32 ä½ç¼–ç å•å…ƒï¼ˆä»£ç†å¯¹ï¼‰ã€‚UTF-16 é€šå¸¸ç”¨äº Windows æ“ä½œç³»ç»Ÿå’Œä¸€äº›ç¼–ç¨‹ç¯å¢ƒã€‚</p>
</li>
<li>
<p><strong>UTF-32 ç¼–ç ï¼ˆUnicode Transformation Format 32-bitï¼‰ï¼š</strong> UTF-32 ä½¿ç”¨å›ºå®šçš„ 32 ä½ç¼–ç å•å…ƒæ¥è¡¨ç¤ºæ¯ä¸ªå­—ç¬¦ï¼Œå› æ­¤ä¸æ¶‰åŠå¯  å˜é•¿åº¦ç¼–ç ã€‚å®ƒé€šå¸¸ç”¨äºæŸäº›ç‰¹æ®Šåº”ç”¨ä¸­ï¼Œä»¥ç®€åŒ–æ–‡æœ¬å¤„ç†ã€‚</p>
</li>
</ol>
<p>è¿™äº›æ˜¯ä¸€äº›å¸¸è§çš„å­—ç¬¦ç¼–ç æ ‡å‡†ï¼Œæ¯ä¸ªæ ‡å‡†éƒ½æœ‰å…¶ç‰¹å®šçš„ç”¨é€”å’Œé€‚ç”¨æ€§ã€‚åœ¨æ–‡æœ¬å¤„ç†å’Œç¼–ç¨‹ä¸­ï¼Œäº†è§£å’Œæ­£ç¡®ä½¿ç”¨é€‚å½“çš„å­—ç¬¦ç¼–ç éå¸¸é‡è¦ï¼Œä»¥ç¡®ä¿æ–‡æœ¬æ•°æ®çš„æ­£ç¡®æ€§å’Œä¸€è‡´æ€§ã€‚</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>æ ‡ç­¾ï¼š</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/my-website/blog/tags/ç¼–ç¨‹">ç¼–ç¨‹</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/my-website/blog/tags/ç¼–ç ">ç¼–ç </a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/my-website/blog/tags/è®¡ç®—æœºé€šè¯†">è®¡ç®—æœºé€šè¯†</a></li></ul></div><div class="col text--right col--3"><a aria-label="é˜…è¯» è®¡ç®—æœºä¸­çš„å­—ç¬¦ç¼–ç  çš„å…¨æ–‡" href="/my-website/blog/2023/10/27/character-encoding"><b>é˜…è¯»æ›´å¤š</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="Webpackå·¥å…·é“¾å­¦ä¹ è®°å½•"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/my-website/blog/2023/10/27/webpack-target">Webpack å­¦ä¹ è·¯çº¿å’Œç›®æ ‡</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2023-10-27T00:00:00.000Z" itemprop="datePublished">2023å¹´10æœˆ27æ—¥</time> Â· <!-- -->é˜…è¯»éœ€ 3 åˆ†é’Ÿ</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/hbche" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/hbche.png" alt="Hanbin Che" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/hbche" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Hanbin Che</span></a></div><small class="avatar__subtitle" itemprop="description">Front End Engineer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>å­¦ä¹  Webpack çš„å®ç°éœ€è¦ä¸€æ­¥ä¸€æ­¥åœ°äº†è§£å®ƒçš„æ ¸å¿ƒæ¦‚å¿µå’Œå·¥ä½œåŸç†ã€‚Webpack æ˜¯ä¸€ä¸ªå¤æ‚ä½†åŠŸèƒ½å¼ºå¤§çš„æ„å»ºå·¥å…·ï¼Œç”¨äºå¤„ç†å’Œæ‰“åŒ…å‰ç«¯é¡¹ç›®çš„å„ç§èµ„æºï¼Œå¦‚ JavaScriptã€CSSã€å›¾ç‰‡ç­‰ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„å­¦ä¹  Webpack çš„å®ç°çš„æ­¥éª¤ï¼š</p>
<ol>
<li>
<p><strong>å®‰è£… Webpack</strong>ï¼š</p>
<p>é¦–å…ˆï¼Œç¡®ä¿åœ¨ä½ çš„é¡¹ç›®ä¸­å®‰è£… Webpackã€‚ä½ å¯ä»¥ä½¿ç”¨ npm æˆ– yarn æ¥è¿›è¡Œå®‰è£…ã€‚ä»¥ä¸‹æ˜¯å®‰è£… Webpack çš„å‘½ä»¤ï¼š</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">npm</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"> webpack webpack-cli --save-dev</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p><strong>åˆ›å»º Webpack é…ç½®æ–‡ä»¶</strong>ï¼š</p>
<p>åœ¨é¡¹ç›®æ ¹ç›®å½•  ä¸­åˆ›å»ºä¸€ä¸ªåä¸º <code>webpack.config.js</code> çš„ Webpack é…ç½®æ–‡ä»¶ã€‚è¿™ä¸ªæ–‡ä»¶å°†åŒ…å« Webpack çš„æ„å»ºå’Œæ‰“åŒ…é…ç½®ã€‚</p>
</li>
<li>
<p><strong>äº†è§£ Webpack æ ¸å¿ƒæ¦‚å¿µ</strong>ï¼š</p>
<ul>
<li><strong>å…¥å£æ–‡ä»¶ï¼ˆEntryï¼‰</strong>ï¼šæŒ‡å®š Webpack å¼€å§‹æ„å»ºçš„å…¥å£æ–‡ä»¶ï¼Œé€šå¸¸æ˜¯ä½ åº”ç”¨ç¨‹åºçš„ä¸» JavaScript æ–‡ä»¶ã€‚</li>
<li><strong>è¾“å‡ºï¼ˆOutputï¼‰</strong>ï¼šæŒ‡å®š Webpack æ„å»ºåç”Ÿæˆçš„æ–‡ä»¶çš„è¾“å‡ºç›®å½•å’Œæ–‡ä»¶åã€‚</li>
<li><strong>Loader</strong>ï¼šç”¨äºå¤„ç†ä¸åŒç±»å‹çš„æ–‡ä»¶ï¼Œä¾‹å¦‚å°† ES6 è½¬æ¢ä¸º ES5ï¼Œå°† Sass ç¼–è¯‘ä¸º CSS ç­‰ã€‚</li>
<li><strong>Plugin</strong>ï¼šç”¨äºæ‰§è¡Œæ„å»ºè¿‡ç¨‹ä¸­çš„å„ç§ä»»åŠ¡ï¼Œå¦‚ä»£ç å‹ç¼©ã€èµ„æºä¼˜åŒ–ç­‰ã€‚</li>
<li><strong>æ¨¡å—ï¼ˆModuleï¼‰</strong>ï¼šWebpack å°†æ‰€æœ‰æ–‡ä»¶è§†ä¸ºæ¨¡å—ï¼ŒåŒ…æ‹¬ JavaScriptã€CSSã€å›¾ç‰‡ç­‰ï¼Œä½ å¯ä»¥ä½¿ç”¨ Loader å’Œ Plugin æ¥å¤„ç†è¿™äº›æ¨¡å—ã€‚</li>
<li><strong>Chunk</strong>ï¼šWebpack å°†æ¨¡å—åˆ†å‰²ä¸ºå—ï¼Œå¯ä»¥é€šè¿‡ä»£ç åˆ†å‰²å’Œæ‡’åŠ è½½æ¥ä¼˜åŒ–åº”ç”¨ç¨‹åºæ€§èƒ½ã€‚</li>
</ul>
</li>
<li>
<p><strong>é…ç½® Webpack</strong>ï¼š</p>
<p>åœ¨ <code>webpack.config.js</code> ä¸­é…ç½® Webpackï¼Œå®šä¹‰å…¥å£æ–‡ä»¶ã€è¾“å‡ºç›®å½•ã€Loader å’Œ Plugin ç­‰ã€‚å­¦ä¹ å¦‚ä½•é…ç½® Webpack æ˜¯ Webpack å­¦ä¹ çš„æ ¸å¿ƒã€‚</p>
</li>
<li>
<p><strong>ç¼–å†™ Loader å’Œ Plugin</strong>ï¼š</p>
<p>å¦‚æœä½ çš„é¡¹ç›®éœ€è¦ç‰¹å®šçš„è½¬æ¢æˆ–ä¼˜åŒ–ï¼Œä½ å¯èƒ½éœ€è¦ç¼–å†™è‡ªå®šä¹‰ Loader å’Œ Pluginã€‚äº†è§£å¦‚ä½•ç¼–å†™å®ƒä»¬ï¼Œä»¥æ»¡è¶³é¡¹ç›®çš„éœ€æ±‚ã€‚</p>
</li>
<li>
<p><strong>è¿è¡Œ Webpack</strong>ï¼š</p>
<p>ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·è¿è¡Œ Webpackï¼Œå¹¶æŒ‡å®šé…ç½®æ–‡ä»¶çš„è·¯å¾„ã€‚é€šå¸¸ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">npx webpack </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--config</span><span class="token plain"> webpack.config.js</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p><strong>è°ƒè¯•å’Œä¼˜åŒ–</strong>ï¼š</p>
<p>å­¦ä¹ å¦‚ä½•ä½¿ç”¨ Webpack çš„è°ƒè¯•å·¥å…·ï¼Œäº†è§£å¦‚ä½•åˆ†ææ„å»ºç»“æœï¼Œä»¥åŠå¦‚ä½•ä¼˜åŒ–æ„å»ºè¿‡ç¨‹å’Œè¾“å‡ºæ–‡ä»¶ã€‚</p>
</li>
<li>
<p><strong>å­¦ä¹  Webpack æ’ä»¶å’Œç¤¾åŒºèµ„æº</strong>ï¼š</p>
<p>æ¢ç´¢ Webpack çš„ç”Ÿæ€ç³»ç»Ÿï¼Œäº†è§£å¯ä»¥åŠ é€Ÿå¼€å‘æµç¨‹å’Œæé«˜æ€§èƒ½çš„æ’ä»¶å’Œå·¥å…·ã€‚</p>
</li>
<li>
<p><strong>å®é™…é¡¹ç›®å®è·µ</strong>ï¼š</p>
<p>æœ€å¥½çš„å­¦ä¹ æ˜¯é€šè¿‡å®é™…é¡¹ç›®å®è·µã€‚åˆ›å»ºä¸€ä¸ªå°å‹é¡¹ç›®ï¼Œå¹¶ä½¿ç”¨ Webpack æ¥æ„å»ºå’Œæ‰“åŒ…ä½ çš„åº”ç”¨ç¨‹åºã€‚</p>
</li>
<li>
<p><strong>å­¦ä¹ æ–‡æ¡£å’Œæ•™ç¨‹</strong>ï¼š</p>
<p>é˜…è¯» Webpack çš„å®˜æ–¹æ–‡æ¡£å’Œæ•™ç¨‹ï¼Œä»¥æ·±å…¥äº†è§£ Webpack çš„å„ä¸ªæ–¹é¢ã€‚</p>
</li>
</ol>
<p>Webpack çš„å­¦ä¹ è¿‡ç¨‹å¯èƒ½éœ€è¦ä¸€äº›æ—¶é—´ï¼Œä½†å®ƒæ˜¯å‰ç«¯å¼€å‘ä¸­éå¸¸é‡è¦çš„å·¥å…·ä¹‹ä¸€ã€‚é€æ­¥äº†è§£å’Œå®è·µï¼Œä½ å°†èƒ½å¤Ÿæ›´å¥½åœ°æŒæ¡ Webpackï¼Œå¹¶æœ‰æ•ˆåœ°æ„å»ºå’Œç®¡ç†å‰ç«¯é¡¹ç›®ã€‚</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>æ ‡ç­¾ï¼š</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/my-website/blog/tags/å‰ç«¯">å‰ç«¯</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/my-website/blog/tags/å·¥å…·">å·¥å…·</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/my-website/blog/tags/webpack">Webpack</a></li></ul></div></footer></article><nav class="pagination-nav" aria-label="åšæ–‡åˆ—è¡¨åˆ†é¡µå¯¼èˆª"><a class="pagination-nav__link pagination-nav__link--next" href="/my-website/blog/page/2"><div class="pagination-nav__label">è¾ƒæ—§çš„åšæ–‡</div></a></nav></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2025 hbche, Inc. Built with <a href="https://www.docusaurus.cn/" target="_blank" rel="noopener noreferrer">Docusaurus</a>.</div></div></div></footer></div>
</body>
</html>
"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[1098],{1706:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>c});var l=s(74848),t=s(28453);const r={title:"useShallow \u269b\ufe0f",description:"\u5982\u4f55memorize\u72b6\u6001\u9009\u62e9\u5668",authors:{name:"Hanbin Che",title:"Front End Engineer",url:"https://github.com/hbche",image_url:"https://github.com/hbche.png"},tags:["\u524d\u7aef","\u72b6\u6001\u7ba1\u7406","zustand","\u7ffb\u8bd1"],sidebar_position:28,last_update:{date:new Date("2025-01-17T00:00:00.000Z"),author:"hbche"}},a=void 0,i={id:"hooks/use-shallow",title:"useShallow \u269b\ufe0f",description:"\u5982\u4f55memorize\u72b6\u6001\u9009\u62e9\u5668",source:"@site/tutorial/zustand/hooks/use-shallow.md",sourceDirName:"hooks",slug:"/hooks/use-shallow",permalink:"/my-website/zustand/hooks/use-shallow",draft:!1,unlisted:!1,tags:[{label:"\u524d\u7aef",permalink:"/my-website/zustand/tags/\u524d\u7aef"},{label:"\u72b6\u6001\u7ba1\u7406",permalink:"/my-website/zustand/tags/\u72b6\u6001\u7ba1\u7406"},{label:"zustand",permalink:"/my-website/zustand/tags/zustand"},{label:"\u7ffb\u8bd1",permalink:"/my-website/zustand/tags/\u7ffb\u8bd1"}],version:"current",lastUpdatedBy:"hbche",lastUpdatedAt:1737072e3,formattedLastUpdatedAt:"2025\u5e741\u670817\u65e5",sidebarPosition:28,frontMatter:{title:"useShallow \u269b\ufe0f",description:"\u5982\u4f55memorize\u72b6\u6001\u9009\u62e9\u5668",authors:{name:"Hanbin Che",title:"Front End Engineer",url:"https://github.com/hbche",image_url:"https://github.com/hbche.png"},tags:["\u524d\u7aef","\u72b6\u6001\u7ba1\u7406","zustand","\u7ffb\u8bd1"],sidebar_position:28,last_update:{date:"2025-01-17T00:00:00.000Z",author:"hbche"}},sidebar:"tutorialSidebar",previous:{title:"hooks",permalink:"/my-website/zustand/category/hooks"},next:{title:"useStore \u269b\ufe0f",permalink:"/my-website/zustand/hooks/use-store"}},o={},c=[{value:"\u7c7b\u578b",id:"\u7c7b\u578b",level:2},{value:"\u7b7e\u540d",id:"\u7b7e\u540d",level:3},{value:"\u53c2\u8003",id:"\u53c2\u8003",level:2},{value:"<code>useShallow(selectorFn)</code>",id:"useshallowselectorfn",level:3},{value:"\u53c2\u6570",id:"\u53c2\u6570",level:4},{value:"\u8fd4\u56de\u503c",id:"\u8fd4\u56de\u503c",level:4},{value:"\u7528\u6cd5",id:"\u7528\u6cd5",level:2},{value:"\u5199\u4e00\u4e2a\u7f13\u5b58\u5316\u7684\u9009\u62e9\u5668",id:"\u5199\u4e00\u4e2a\u7f13\u5b58\u5316\u7684\u9009\u62e9\u5668",level:3},{value:"\u6545\u969c\u6392\u9664",id:"\u6545\u969c\u6392\u9664",level:2}];function d(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"useShallow"})," \u662f\u4e00\u4e2a\u4f18\u5316\u91cd\u590d\u6e32\u67d3\u7684 React Hook\u3002"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-js",children:"const memoizedSelector = useShallow(selector);\n"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"#%E7%B1%BB%E5%9E%8B",children:"\u7c7b\u578b"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#%E7%AD%BE%E5%90%8D",children:"\u7b7e\u540d"})}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"#%E5%8F%82%E8%80%83",children:"\u53c2\u8003"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"#useshallowselectorfn",children:(0,l.jsx)(n.code,{children:"useShallow(selectorFn)"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#%E5%8F%82%E6%95%B0",children:"\u53c2\u6570"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#%E8%BF%94%E5%9B%9E%E5%80%BC",children:"\u8fd4\u56de\u503c"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"#%E7%94%A8%E6%B3%95",children:"\u7528\u6cd5"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#%E5%86%99%E4%B8%80%E4%B8%AA%E7%BC%93%E5%AD%98%E5%8C%96%E7%9A%84%E9%80%89%E6%8B%A9%E5%99%A8",children:"\u5199\u4e00\u4e2a\u7f13\u5b58\u5316\u7684\u9009\u62e9\u5668"})}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#%E6%95%85%E9%9A%9C%E6%8E%92%E9%99%A4",children:"\u6545\u969c\u6392\u9664"})}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"\u7c7b\u578b",children:"\u7c7b\u578b"}),"\n",(0,l.jsx)(n.h3,{id:"\u7b7e\u540d",children:"\u7b7e\u540d"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"useShallow<T, U = T>(selectorFn: (state: T) => U): (state: T) => U\n"})}),"\n",(0,l.jsx)(n.h2,{id:"\u53c2\u8003",children:"\u53c2\u8003"}),"\n",(0,l.jsx)(n.h3,{id:"useshallowselectorfn",children:(0,l.jsx)(n.code,{children:"useShallow(selectorFn)"})}),"\n",(0,l.jsx)(n.h4,{id:"\u53c2\u6570",children:"\u53c2\u6570"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"selectorFn"}),": \u57fa\u4e8e\u5f53\u524d state \u8fd4\u56de\u6570\u636e\u7684\u4e00\u4e2a\u51fd\u6570"]}),"\n"]}),"\n",(0,l.jsx)(n.h4,{id:"\u8fd4\u56de\u503c",children:"\u8fd4\u56de\u503c"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"useShallow"})," \u8fd4\u56de\u4e00\u4e2a\u88ab\u7f13\u5b58\u7684\u7248\u672c\uff0c\u8be5 selector \u51fd\u6570\u4f7f\u7528\u6d45\u6bd4\u8f83\u8fdb\u884c\u6362\u5b58\u3002"]}),"\n",(0,l.jsx)(n.h2,{id:"\u7528\u6cd5",children:"\u7528\u6cd5"}),"\n",(0,l.jsx)(n.h3,{id:"\u5199\u4e00\u4e2a\u7f13\u5b58\u5316\u7684\u9009\u62e9\u5668",children:"\u5199\u4e00\u4e2a\u7f13\u5b58\u5316\u7684\u9009\u62e9\u5668"}),"\n",(0,l.jsxs)(n.p,{children:["\u9996\u5148\uff0c\u6211\u4eec\u9700\u8981\u521b\u5efa\u4e00\u4e2a store \u6765\u4fdd\u5b58\u5c0f\u718a\u5bb6\u65cf\u7684\u72b6\u6001\u3002\u5728\u8fd9\u4e2a store \u4e2d\uff0c\u6211\u4eec\u5b9a\u4e49\u4e86\u4e09\n\u4e2a\u5c5e\u6027\uff1a",(0,l.jsx)(n.code,{children:"papaBear"}),"\u3001",(0,l.jsx)(n.code,{children:"mamaBear"})," \u548c ",(0,l.jsx)(n.code,{children:"babyBear"}),"\uff0c\u6bcf\u4e00\u4e2a\u5206\u522b\u4ee3\u8868\u5c0f\u718a\u5bb6\u5ead\u7684\u4e0d\u540c\u6210\u5458\u548c\n\u5404\u79cd\u5bf9\u5e94\u7684\u71d5\u9ea6\u76d8\u5c3a\u5bf8\u3002"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-tsx",children:"import { create } from 'zustand';\n\ninterface BearState {\n  papaBear: string;\n  mamaBear: string;\n  babyBear: string;\n  tinyBear?: string;\n}\n\nexport const useBearMealsStore = create<BearState>(() => ({\n  papaBear: 'large porridge-pot',\n  mamaBear: 'middle-size porridge pot',\n  babyBear: 'A little, small, wee pot',\n}));\n"})}),"\n",(0,l.jsxs)(n.p,{children:["\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u5c06\u521b\u5efa\u4e00\u4e2a ",(0,l.jsx)(n.code,{children:"BearNames"})," \u7684\u7ec4\u4ef6\uff0c\u68c0\u7d22\u6211\u4eec\u72b6\u6001\u7684\u952e\uff08\u5c0f\u718a\u5bb6\u65cf\u7684\u6210\u5458\uff09\u5e76\n\u5c55\u793a\u4ed6\u4eec\u3002"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-tsx",children:"import { useBearMealsStore } from './use-bear-meals-store';\n\nexport function BearNames() {\n  const names = useBearMealsStore((state) => Object.keys(state));\n\n  return <div>{names.join(', ')}</div>;\n}\n"})}),"\n",(0,l.jsxs)(n.p,{children:["\u63a5\u7740\uff0c\u6211\u4eec\u5c06\u521b\u5efa\u4e00\u4e2a ",(0,l.jsx)(n.code,{children:"UpdateBabyBearMeal"})," \u7684\u7ec4\u4ef6\uff0c\u5b9a\u671f\u5730\u66f4\u65b0\u718a\u5b9d\u5b9d\u7684\u81b3\u98df\u3002"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-tsx",children:"import { useEffect } from 'react';\nimport { useBearMealsStore } from './use-bear-meals-store';\n\nconst meals = [\n  'A tiny, little, wee bowl',\n  'A small, petite, tiny pot',\n  'A wee, itty-bitty, small bowl',\n  'A little, petite, tiny dish',\n  'A tiny, small, wee vessel',\n  'A small, little, wee cauldron',\n  'A little, tiny, small cup',\n  'A wee, small, little jar',\n  'A tiny, wee, small pan',\n  'A small, wee, little crock',\n];\n\nexport function UpdateBabyBearMeal() {\n  useEffect(() => {\n    const timer = setInterval(() => {\n      useBearMealsStore.setState({\n        tinyBear: meals[Math.floor(Math.random() * (meals.length - 1))],\n      });\n    }, 1000);\n\n    return () => {\n      clearInterval(timer);\n    };\n  }, []);\n\n  return null;\n}\n"})}),"\n",(0,l.jsxs)(n.p,{children:["\u6700\u540e\uff0c\u6211\u4eec\u5c06\u4e24\u4e2a\u7ec4\u4ef6\u653e\u5165 ",(0,l.jsx)(n.code,{children:"App"})," \u7ec4\u4ef6\u4e0b\uff0c\u80fd\u591f\u5728\u754c\u9762\u4e0a\u770b\u5230\u4ed6\u4eec\u3002"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-tsx",children:"export default function App() {\n  return (\n    <>\n      <UpdateTinyBearPorridge />\n      <BearNames />\n    </>\n  );\n}\n"})}),"\n",(0,l.jsxs)(n.p,{children:["\u4e00\u5207\u770b\u7740\u5f88\u7f8e\u597d\uff0c\u4f46\u662f\u8fd9\u91cc\u6709\u4e00\u4e2a\u5c0f\u95ee\u9898\uff1a",(0,l.jsx)(n.code,{children:"BearNames"})," \u7ec4\u4ef6\u5373\u4f7f\u5728 ",(0,l.jsx)(n.code,{children:"names"})," \u6ca1\u6709\u53d8\u5316\u7684\n\u60c5\u51b5\u4e0b\u4ecd\u7136\u4f1a\u91cd\u590d\u6e32\u67d3\u3002\u5bfc\u81f4\u8fd9\u4e2a\u7684\u539f\u56e0\u662f\u7ec4\u4ef6\u5728\u72b6\u6001\u7684\u6bcf\u4e00\u90e8\u5206\u53d1\u751f\u6539\u53d8\u65f6\u90fd\u4f1a\u91cd\u65b0\u6e32\u67d3\n\uff0c\u5373\u4f7f\u6211\u4eec\u5173\u5fc3\u7684\u6307\u5b9a\u90e8\u5206\u6ca1\u6709\u53d1\u751f\u6539\u53d8\u3002"]}),"\n",(0,l.jsxs)(n.p,{children:["\u4fee\u590d\u8fd9\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u9700\u8981\u4f7f\u7528 ",(0,l.jsx)(n.code,{children:"useShallow"})," \u6765\u786e\u4fdd\u6211\u4eec\u7ec4\u4ef6\u53ea\u5728\u72b6\u6001\u7684\u5b9e\u9645 key \u53d1\u751f\u53d8\n\u5316\u65f6\u624d\u91cd\u65b0\u6e32\u67d3\u3002"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-tsx",children:"export function BearNames() {\n  const names = useBearMealsStore(useShallow((state) => Object.keys(state)));\n\n  return <div>{names.join(', ')}</div>;\n}\n"})}),"\n",(0,l.jsxs)(n.p,{children:["\u4f7f\u7528 ",(0,l.jsx)(n.code,{children:"useShallow"})," \uff0c\u6211\u4eec\u4f18\u5316\u4e86\u7ec4\u4ef6\u91cd\u65b0\u6e32\u67d3\u7684\u8fc7\u7a0b\uff0c\u786e\u4fdd\u7ec4\u4ef6\u53ea\u5728\u5fc5\u8981\u7684\u65f6\u5019\u91cd\u65b0\u6e32\u67d3\n\uff0c\u4ece\u800c\u63d0\u5347\u6574\u4f53\u6027\u80fd\u3002"]}),"\n",(0,l.jsx)(n.h2,{id:"\u6545\u969c\u6392\u9664",children:"\u6545\u969c\u6392\u9664"})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(d,{...e})}):d(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>i});var l=s(96540);const t={},r=l.createContext(t);function a(e){const n=l.useContext(r);return l.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),l.createElement(r.Provider,{value:n},e.children)}}}]);
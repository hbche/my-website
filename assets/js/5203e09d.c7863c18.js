"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[33],{75260:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>u,frontMatter:()=>a,metadata:()=>i,toc:()=>l});var n=s(74848),r=s(28453);const a={title:"\u81ea\u52a8\u751f\u6210\u9009\u62e9\u5668",description:"\u81ea\u52a8\u751f\u6210\u9009\u62e9\u5668",authors:{name:"Hanbin Che",title:"Front End Engineer",url:"https://github.com/hbche",image_url:"https://github.com/hbche.png"},tags:["\u524d\u7aef","\u72b6\u6001\u7ba1\u7406","zustand","\u7ffb\u8bd1"],sidebar_position:6,last_update:{date:new Date("2025-01-15T00:00:00.000Z"),author:"hbche"}},o=void 0,i={id:"guides/auto-generating-selectors",title:"\u81ea\u52a8\u751f\u6210\u9009\u62e9\u5668",description:"\u81ea\u52a8\u751f\u6210\u9009\u62e9\u5668",source:"@site/tutorial/zustand/guides/auto-generating-selectors.md",sourceDirName:"guides",slug:"/guides/auto-generating-selectors",permalink:"/my-website/zustand/guides/auto-generating-selectors",draft:!1,unlisted:!1,tags:[{label:"\u524d\u7aef",permalink:"/my-website/zustand/tags/\u524d\u7aef"},{label:"\u72b6\u6001\u7ba1\u7406",permalink:"/my-website/zustand/tags/\u72b6\u6001\u7ba1\u7406"},{label:"zustand",permalink:"/my-website/zustand/tags/zustand"},{label:"\u7ffb\u8bd1",permalink:"/my-website/zustand/tags/\u7ffb\u8bd1"}],version:"current",lastUpdatedBy:"hbche",lastUpdatedAt:1736899200,formattedLastUpdatedAt:"2025\u5e741\u670815\u65e5",sidebarPosition:6,frontMatter:{title:"\u81ea\u52a8\u751f\u6210\u9009\u62e9\u5668",description:"\u81ea\u52a8\u751f\u6210\u9009\u62e9\u5668",authors:{name:"Hanbin Che",title:"Front End Engineer",url:"https://github.com/hbche",image_url:"https://github.com/hbche.png"},tags:["\u524d\u7aef","\u72b6\u6001\u7ba1\u7406","zustand","\u7ffb\u8bd1"],sidebar_position:6,last_update:{date:"2025-01-15T00:00:00.000Z",author:"hbche"}},sidebar:"tutorialSidebar",previous:{title:"\u53d7Flux\u542f\u53d1\u7684\u5b9e\u8df5",permalink:"/my-website/zustand/guides/flex-inspired-practice"},next:{title:"\u4e0d\u5e26 store actions \u7684\u5b9e\u8df5\u65b9\u5f0f",permalink:"/my-website/zustand/guides/practice-with-no-store-actions"}},c={},l=[{value:"\u521b\u5efa\u4e00\u4e2a createSelectors \u65b9\u6cd5",id:"\u521b\u5efa\u4e00\u4e2a-createselectors-\u65b9\u6cd5",level:3},{value:"\u539f\u751f store",id:"\u539f\u751f-store",level:3},{value:"\u4e09\u65b9\u5e93",id:"\u4e09\u65b9\u5e93",level:3}];function d(e){const t={a:"a",code:"code",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.p,{children:"\u6211\u4eec\u5efa\u8bae\u5728\u4f7f\u7528 store \u4e2d\u7684\u5c5e\u6027\u6216\u52a8\u4f5c\u65f6\u4f7f\u7528\u9009\u62e9\u5668\u3002\u6211\u4eec\u53ef\u4ee5\u50cf\u8fd9\u6837\u8bbf\u95ee store \u4e2d\u7684\u503c\n\uff1a"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-ts",children:"const bears = useBearStore((state) => state.bears);\n"})}),"\n",(0,n.jsx)(t.p,{children:"\u7136\u800c\uff0c\u5199\u8fd9\u4e9b\u53ef\u80fd\u4f1a\u5f88\u4e4f\u5473\u3002\u5982\u679c\u6211\u4eec\u4e5f\u8fd9\u6837\u89c9\u5f97\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u81ea\u52a8\u751f\u6210\u9009\u62e9\u5668\u3002"}),"\n",(0,n.jsx)(t.h3,{id:"\u521b\u5efa\u4e00\u4e2a-createselectors-\u65b9\u6cd5",children:"\u521b\u5efa\u4e00\u4e2a createSelectors \u65b9\u6cd5"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-ts",children:"import { StoreApi, UseBoundStore } from 'zustand';\n\ntype WithSelectors<S> = S extends { getState: () => infer T }\n  ? S & { use: { [K in keyof T]: () => T[K] } }\n  : never;\n\nfunction createSelectors<S extends UseBoundStore<StoreApi<object>>>(_store: S) {\n  let store = _store as WithSelectors<S>;\n  store.use = {};\n  for (let k of Object.keys(store.getState())) {\n    (store.use as any)[k] = () => store((s) => s[k as keyof typeof s]);\n  }\n\n  return store;\n}\n"})}),"\n",(0,n.jsx)(t.p,{children:"\u5982\u679c\u6211\u4eec\u6b63\u597d\u6709\u4e2a\u50cf\u4e0b\u9762\u8fd9\u6837\u7684 store\uff1a"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-ts",children:"  bears: number;\n  increase: (by: number) => void;\n  increment: () => void;\n}\n\nconst useBearStoreBase = create<BearState>((set) => ({\n  bears: 0,\n  increase: (by: number) => {\n    set((state) => ({ bears: state.bears + by }));\n  },\n  increment: () => {\n    set((state) => ({ bears: state.bears + 1 }));\n  },\n}));\n"})}),"\n",(0,n.jsx)(t.p,{children:"\u5c06\u6211\u4eec\u7684 store \u4f5c\u4e3a\u53c2\u6570\u8c03\u7528 createStores \u51fd\u6570\uff1a"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-ts",children:"const useBearStore = createSelectors(useBearStoreBase);\n"})}),"\n",(0,n.jsx)(t.p,{children:"\u73b0\u5728 selector \u81ea\u52a8\u751f\u6210\u4e86\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u8bbf\u95ee\u4e86\uff1a"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-ts",children:"const bears = useBearStore.use.bears();\nconst increment = useBearStore.use.increment();\n"})}),"\n",(0,n.jsx)(t.h3,{id:"\u539f\u751f-store",children:"\u539f\u751f store"}),"\n",(0,n.jsx)(t.p,{children:"\u5982\u679c\u6211\u4eec\u4f7f\u7528\u7528\u4e00\u4e2a\u539f\u751f store \uff0c\u6211\u4eec\u7684 createSelectors \u5b9e\u73b0\u5982\u4e0b\uff1a"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-ts",children:"import { StoreApi, useStore } from 'zustand';\n\ntype WithSelectors<S> = S extends { getState: () => infer T }\n  ? S & { use: { [K in keyof T]: () => T[K] } }\n  : never;\n\nfunction createSelectors<S extends StoreApi<object>>(_store: S) {\n  let store = _store as WithSelectors<S>;\n  store.use = {};\n  for (let k of Object.keys(store.getState())) {\n    (store.use as any)[k] = () =>\n      useStore(_store, (s) => s[k as keyof typeof s]);\n  }\n\n  return store;\n}\n"})}),"\n",(0,n.jsx)(t.p,{children:"\u4f7f\u7528\u65b9\u5f0f\u4e0e React store \u76f8\u540c\u3002\u6211\u4eec\u6709\u4e2a store \u5982\u4e0b\uff1a"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-ts",children:"interface BearState {\n  bears: number;\n  increase: (by: number) => void;\n  increment: () => void;\n}\n\nconst store = createStore<BearState>((set) => ({\n  bears: 0,\n  increase: (by: number) => {\n    set((state) => ({ bears: state.bears + by }));\n  },\n  increment: () => {\n    set((state) => ({ bears: state.bears + 1 }));\n  },\n}));\n"})}),"\n",(0,n.jsx)(t.p,{children:"\u5c06\u6211\u4eec\u7684\u653e\u4ed6\u5e94\u7528\u5230\u6211\u4eec\u7684 store \u4e0a\u6765\uff1a"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-ts",children:"const useBearStore = createSelectors(store);\n"})}),"\n",(0,n.jsx)(t.p,{children:"\u73b0\u5728 selector \u81ea\u52a8\u751f\u6210\u4e86\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u8bbf\u95ee\u4e86\uff1a"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-ts",children:"const bears = useBearStore.use.bears();\nconst increment = useBearStore.use.increment();\n"})}),"\n",(0,n.jsx)(t.h3,{id:"\u4e09\u65b9\u5e93",children:"\u4e09\u65b9\u5e93"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"https://github.com/Albert-Gao/auto-zustand-selectors-hook",children:"auto-zustand-selectors-hook"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"https://github.com/dai-shi/react-hooks-global-state",children:"react-hooks-global-state"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"https://github.com/udecode/zustand-x",children:"zustood"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"https://github.com/DawidWraga/davstack",children:"@davstack/store"})}),"\n"]})]})}function u(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},28453:(e,t,s)=>{s.d(t,{R:()=>o,x:()=>i});var n=s(96540);const r={},a=n.createContext(r);function o(e){const t=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),n.createElement(a.Provider,{value:t},e.children)}}}]);
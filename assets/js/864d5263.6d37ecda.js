"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[1513],{36543:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>u,frontMatter:()=>r,metadata:()=>o,toc:()=>d});var s=n(74848),a=n(28453);const r={title:"\u5982\u4f55\u91cd\u7f6e\u72b6\u6001",description:"\u5982\u4f55\u91cd\u7f6e\u72b6\u6001",authors:{name:"Hanbin Che",title:"Front End Engineer",url:"https://github.com/hbche",image_url:"https://github.com/hbche.png"},tags:["\u524d\u7aef","\u72b6\u6001\u7ba1\u7406","zustand","\u7ffb\u8bd1"],sidebar_position:13,last_update:{date:new Date("2025-01-16T00:00:00.000Z"),author:"hbche"}},i=void 0,o={id:"guides/how-to-reset-state",title:"\u5982\u4f55\u91cd\u7f6e\u72b6\u6001",description:"\u5982\u4f55\u91cd\u7f6e\u72b6\u6001",source:"@site/tutorial/zustand/guides/how-to-reset-state.md",sourceDirName:"guides",slug:"/guides/how-to-reset-state",permalink:"/my-website/zustand/guides/how-to-reset-state",draft:!1,unlisted:!1,tags:[{label:"\u524d\u7aef",permalink:"/my-website/zustand/tags/\u524d\u7aef"},{label:"\u72b6\u6001\u7ba1\u7406",permalink:"/my-website/zustand/tags/\u72b6\u6001\u7ba1\u7406"},{label:"zustand",permalink:"/my-website/zustand/tags/zustand"},{label:"\u7ffb\u8bd1",permalink:"/my-website/zustand/tags/\u7ffb\u8bd1"}],version:"current",lastUpdatedBy:"hbche",lastUpdatedAt:1736985600,formattedLastUpdatedAt:"2025\u5e741\u670816\u65e5",sidebarPosition:13,frontMatter:{title:"\u5982\u4f55\u91cd\u7f6e\u72b6\u6001",description:"\u5982\u4f55\u91cd\u7f6e\u72b6\u6001",authors:{name:"Hanbin Che",title:"Front End Engineer",url:"https://github.com/hbche",image_url:"https://github.com/hbche.png"},tags:["\u524d\u7aef","\u72b6\u6001\u7ba1\u7406","zustand","\u7ffb\u8bd1"],sidebar_position:13,last_update:{date:"2025-01-16T00:00:00.000Z",author:"hbche"}},sidebar:"tutorialSidebar",previous:{title:"\u5c06URL\u8fde\u63a5\u5230\u72b6\u6001",permalink:"/my-website/zustand/guides/connect-to-state-with-url-hash"},next:{title:"\u4f7f\u7528 props \u521d\u59cb\u5316\u72b6\u6001",permalink:"/my-website/zustand/guides/initialize-state-with-props"}},c={},d=[];function l(e){const t={code:"code",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.p,{children:"\u4ee5\u4e0b\u6a21\u5f0f\u53ef\u7528\u4e8e\u5c06\u72b6\u6001\u91cd\u7f6e\u4e3a\u5176\u521d\u59cb\u503c\u3002"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",children:"import { StateCreator, create } from 'zustand';\n\ninterface State {\n  salmon: number;\n  tuna: number;\n}\n\ninterface Action {\n  addSalmon: (qty: number) => void;\n  addTuna: (qty: number) => void;\n  reset: (qty: number) => void;\n}\n\nconst initialState: State = {\n  salmon: 0,\n  tuna: 0,\n};\n\nconst useSlice: StateCreator<State & Action, [], [], State> = create<\n  State & Action\n>()((set, get) => ({\n  ...initialState,\n  addSalmon: (qty) => set({ salmon: get().salmon + qty }),\n  addTuna: (qty) => set({ tuna: get().tuna + qty }),\n  reset: () => set({ ...initialState }),\n}));\n"})}),"\n",(0,s.jsx)(t.p,{children:"\u4e00\u6b21\u91cd\u7f6e\u591a\u4e2a store\uff1a"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",children:"import { create as _create } from 'zustand';\nimport type { StateCreator } from 'zustand';\n\nconst storeResetFns = new Set<() => void>();\n\nconst resetAllStores = () => {\n  storeResetFns.forEach((resetFn) => {\n    resetFn();\n  });\n};\n\nexport const create = (<T extends unknown>() => {\n  return (stateCreator: StateCreator<T>) => {\n    const store = _create(stateCreator);\n    const initialState = store.getState();\n    storeResetFns.add(() => {\n      store.setState(initialState, true);\n    });\n    return store;\n  };\n}) as typeof _create;\n"})}),"\n",(0,s.jsx)(t.p,{children:"\u4f7f\u7528\u5207\u7247\u6a21\u5f0f\u91cd\u7f6e\u7ed1\u5b9a\u7684\u5b58\u50a8"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",children:"import create from 'zustand';\nimport type { StateCreator } from 'zustand';\n\nconst sliceResetFns = new Set<() => void>();\n\nexport const resetAllSlices = () => {\n  sliceResetFns.forEach((resetFn) => {\n    resetFn();\n  });\n};\n\nconst initialBearState = { bears: 0 };\n\ninterface BearSlice {\n  bears: number;\n  addBear: () => void;\n  eatFish: () => void;\n}\n\nconst createBearSlice: StateCreator<\n  BearSlice & FishSlice,\n  [],\n  [],\n  BearSlice\n> = (set) => {\n  sliceResetFns.add(() => set(initialBearState));\n  return {\n    ...initialBearState,\n    addBear: () => set((state) => ({ bears: state.bears + 1 })),\n    eatFish: () => set((state) => ({ fishes: state.fishes - 1 })),\n  };\n};\n\nconst initialStateFish = { fishes: 0 };\n\ninterface FishSlice {\n  fishes: number;\n  addFish: () => void;\n}\n\nconst createFishSlice: StateCreator<\n  BearSlice & FishSlice,\n  [],\n  [],\n  FishSlice\n> = (set) => {\n  sliceResetFns.add(() => set(initialStateFish));\n  return {\n    ...initialStateFish,\n    addFish: () => set((state) => ({ fishes: state.fishes + 1 })),\n  };\n};\n\nconst useBoundStore = create<BearSlice & FishSlice>()((...a) => ({\n  ...createBearSlice(...a),\n  ...createFishSlice(...a),\n}));\n\nexport default useBoundStore;\n"})})]})}function u(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>o});var s=n(96540);const a={},r=s.createContext(a);function i(e){const t=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),s.createElement(r.Provider,{value:t},e.children)}}}]);
---
title: Rust é€šç”¨ç¼–ç¨‹æ¦‚å¿µ - æ•°æ®ç±»å‹
authors:
  name: Hanbin Che
  title: Front End Engineer
  url: https://github.com/hbche
  image_url: https://github.com/hbche.png
description: è®°å½• Rust å­¦ä¹ è¿‡ç¨‹
tags: ['rust', 'æ•°æ®ç±»å‹', 'é€šç”¨ç¼–ç¨‹æ¦‚å¿µ']
date: 2023-10-08
---

Rust æ˜¯ä¸€ç§**é™æ€ç±»å‹**(statically typed)çš„è¯­è¨€ï¼Œè¿™æ„å‘³ç€å®ƒå¿…é¡»åœ¨ç¼–è¯‘æœŸé—´å°±è¦çŸ¥é“æ‰€æœ‰å˜é‡çš„ç±»å‹ã€‚ç¼–è¯‘å™¨é€šå¸¸å¯ä»¥æ ¹æ®å€¼å’Œä½¿ç”¨æ–¹å¼æ¨å¯¼å‡ºæˆ‘ä»¬æƒ³è¦ä½¿ç”¨çš„ç±»å‹ã€‚åœ¨ç±»å‹å¯èƒ½æ˜¯å¤šç§æƒ…å†µæ—¶ï¼Œä¾‹å¦‚æˆ‘ä»¬ä½¿ç”¨ `parse` å°† `String` è½¬æ¢æˆæ•°å€¼ç±»å‹æ—¶ï¼Œå¿…é¡»åŠ ä¸Šä¸€ä¸ªç±»å‹æ ‡æ³¨ï¼š

```rust
let guess: u32 = "42".parse().expect("Not a number");
```

å¦‚æœä¸æ·»åŠ ç±»å‹æ ‡æ³¨çš„è¯ï¼ŒRust å°†æ˜¾ç¤ºå¦‚ä¸‹é”™è¯¯

```
error[E0282]: type annotations needed
 --> src\main.rs:2:9
  |
2 |     let guess = "42".parse().expect("Not a number");
  |         ^^^^^
  |
help: consider giving `guess` an explicit type
  |
2 |     let guess: /* Type */ = "42".parse().expect("Not a number");
  |              ++++++++++++

For more information about this error, try `rustc --explain E0282`.
error: could not compile `guessing` (bin "guessing") due to previous error
```

å¸®åŠ©ä¿¡æ¯ä¸­ç»™å‡ºäº†ä¿®æ”¹å»ºè®® `consider giving 'guess' an explicit type`[è€ƒè™‘ç»™ guess ä¸€ä¸ªæ˜ç¡®çš„ç±»å‹]

<!--truncate-->

## æ ‡é‡ç±»å‹

æ ‡é‡ï¼ˆscalarï¼‰ç±»å‹è¡¨ç¤ºå•ä¸ªå€¼ã€‚Rust æœ‰ 4 ä¸ªåŸºæœ¬çš„æ ‡é‡ç±»å‹ï¼šæ•´å‹ã€æµ®ç‚¹å‹ã€å¸ƒå°”å‹å’Œå­—ç¬¦ã€‚ä½ å¯èƒ½ä»å…¶ä»–è¯­è¨€äº†è§£è¿‡è¿™äº›ç±»å‹ã€‚ä¸‹é¢æˆ‘ä»¬æ·±å…¥äº†è§£å®ƒä»¬åœ¨ Rust ä¸­çš„ç”¨æ³•ã€‚

### æ•´æ•°ç±»å‹

æ•´æ•°ï¼ˆintegerï¼‰æ˜¯æ²¡æœ‰å°æ•°éƒ¨åˆ†çš„æ•°å­—ã€‚ä¾‹å¦‚ `u32`ï¼Œæ­¤ç±»å‹å£°æ˜è¡¨æ˜å®ƒå…³è”çš„å€¼åº”è¯¥æ˜¯å ç”¨ 32 ä½ç©ºé—´çš„æ— ç¬¦å·æ•´å‹ï¼ˆæœ‰ç¬¦å·æ•´å‹ä»¥ i å¼€å§‹ï¼Œi æ˜¯è‹±æ–‡å•è¯ integer çš„é¦–å­—æ¯ï¼Œä¸ä¹‹ç›¸åçš„æ˜¯ uï¼Œä»£è¡¨æ— ç¬¦å· unsigned ç±»å‹ï¼‰ã€‚ä¸‹è¡¨æ˜¾ç¤ºäº† Rust ä¸­å†…ç½®çš„æ•´æ•°ç±»å‹ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™äº›å®šä¹‰å½¢å¼ä¸­çš„ä»»ä½•ä¸€ä¸ªæ¥å£°æ˜æ•´æ•°å€¼çš„ç±»å‹ã€‚

| é•¿åº¦   | æœ‰ç¬¦å·ç±»å‹ | æ— ç¬¦å·ç±»å‹ |
| ------ | ---------- | ---------- |
| 8 ä½   | i8         | u8         |
| 16 ä½  | i16        | u16        |
| 32 ä½  | i32        | u32        |
| 64 ä½  | i64        | u64        |
| 128 ä½ | i128       | u128       |
| arch   | isize      | usize      |

æœ‰ç¬¦å·å’Œæ— ç¬¦å·è¡¨ç¤ºæ•°å­—èƒ½å¦å–è´Ÿæ•°â€”â€”ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªæ•°æ˜¯å¦å¯èƒ½æ˜¯è´Ÿæ•°ï¼ˆæœ‰ç¬¦å·ç±»å‹ï¼‰ï¼Œæˆ–ä¸€ç›´ä¸ºæ­£è€Œä¸éœ€è¦å¸¦ä¸Šç¬¦å·ï¼ˆæ— ç¬¦å·ç±»å‹ï¼‰ã€‚

æ¯ä¸ªæœ‰ç¬¦å·ç±»å‹è§„å®šçš„æ•°å­—èŒƒå›´æ˜¯ -(2n - 1) ~ 2n - 1 - 1ï¼Œå…¶ä¸­ n æ˜¯è¯¥å®šä¹‰å½¢å¼çš„ä½é•¿åº¦ã€‚æ‰€ä»¥ i8 å¯å­˜å‚¨æ•°å­—èŒƒå›´æ˜¯ -(27) ~ 27 - 1ï¼Œå³ -128 ~ 127ã€‚æ— ç¬¦å·ç±»å‹å¯ä»¥å­˜å‚¨çš„æ•°å­—èŒƒå›´æ˜¯ 0 ~ 2n - 1ï¼Œæ‰€ä»¥ u8 èƒ½å¤Ÿå­˜å‚¨çš„æ•°å­—ä¸º 0 ~ 28 - 1ï¼Œå³ 0 ~ 255ã€‚

æ­¤å¤–ï¼Œ`isize` å’Œ `usize` ç±»å‹å–å†³äºç¨‹åºè¿è¡Œçš„è®¡ç®—æœºä½“ç³»ç»“æ„ï¼Œåœ¨è¡¨ä¸­è¡¨ç¤ºä¸ºâ€œarchâ€ï¼šè‹¥ä½¿ç”¨ 64 ä½æ¶æ„ç³»ç»Ÿåˆ™ä¸º 64 ä½ï¼Œè‹¥ä½¿ç”¨ 32 ä½æ¶æ„ç³»ç»Ÿåˆ™ä¸º 32 ä½ã€‚

å¯æŒ‰ä¸‹è¡¨ä¸­æ‰€ç¤ºçš„ä»»æ„å½¢å¼æ¥ç¼–å†™æ•´å‹çš„å­—é¢é‡ã€‚æ³¨æ„ï¼Œå¯èƒ½å±äºå¤šç§æ•°å­—ç±»å‹çš„æ•°å­—å­—é¢é‡å…è®¸ä½¿ç”¨ç±»å‹åç¼€æ¥æŒ‡å®šç±»å‹ï¼Œä¾‹å¦‚ `57u8`ã€‚æ•°å­—å­—é¢é‡è¿˜å¯ä»¥ä½¿ç”¨ `_` ä½œä¸ºå¯è§†åˆ†éš”ç¬¦ä»¥æ–¹ä¾¿è¯»æ•°ï¼Œå¦‚ `1_000`ï¼Œæ­¤å€¼å’Œ `1000` ç›¸åŒã€‚

| æ•°å­—å­—é¢é‡         | ç¤ºä¾‹          |
| ------------------ | ------------- |
| åè¿›åˆ¶             | `98_222`      |
| åå…­è¿›åˆ¶           | `0xff`        |
| å…«è¿›åˆ¶             | `0o77`        |
| äºŒè¿›åˆ¶             | `0b1111_0000` |
| å­—èŠ‚ (ä»…é™äº `u8`) | `b'A'`        |

é‚£ä¹ˆè¯¥ä½¿ç”¨å“ªç§ç±»å‹çš„æ•´å‹å‘¢ï¼Ÿå¦‚æœä¸ç¡®å®šï¼Œ**Rust çš„é»˜è®¤å½¢å¼é€šå¸¸æ˜¯ä¸ªä¸é”™çš„é€‰æ‹©ï¼Œæ•´å‹é»˜è®¤æ˜¯ `i32`**ã€‚`isize` å’Œ `usize` çš„ä¸»è¦åº”ç”¨åœºæ™¯æ˜¯ç”¨ä½œæŸäº›é›†åˆçš„ç´¢å¼•ã€‚

:::caution

#### æ•´å‹æº¢å‡º

æ¯”æ–¹è¯´æœ‰ä¸€ä¸ª `u8` ç±»å‹çš„å˜é‡ ï¼Œå®ƒå¯ä»¥å­˜æ”¾ä» `0` åˆ° `255` çš„å€¼ã€‚é‚£ä¹ˆå½“ä½ å°†å…¶ä¿®æ”¹ä¸ºèŒƒå›´ä¹‹å¤–çš„å€¼ï¼Œæ¯”å¦‚ `256`ï¼Œåˆ™ä¼šå‘ç”Ÿ**æ•´å‹æº¢å‡º**ï¼ˆinteger overflowï¼‰ï¼Œè¿™ä¼šå¯¼è‡´ä¸¤ç§è¡Œä¸ºçš„å…¶ä¸­ä¸€ç§ã€‚å½“åœ¨è°ƒè¯•ï¼ˆdebugï¼‰æ¨¡å¼ç¼–è¯‘æ—¶ï¼ŒRust ä¼šæ£€æŸ¥æ•´å‹æº¢å‡ºï¼Œè‹¥å­˜åœ¨è¿™äº›é—®é¢˜åˆ™ä½¿ç¨‹åºåœ¨ç¼–è¯‘æ—¶ panicã€‚Rust ä½¿ç”¨ panic è¿™ä¸ªæœ¯è¯­æ¥è¡¨æ˜ç¨‹åºå› é”™è¯¯è€Œé€€å‡ºã€‚

åœ¨å½“ä½¿ç”¨ --release å‚æ•°è¿›è¡Œå‘å¸ƒï¼ˆreleaseï¼‰æ¨¡å¼æ„å»ºæ—¶ï¼ŒRust **ä¸**æ£€æµ‹ä¼šå¯¼è‡´ panic çš„æ•´å‹æº¢å‡ºã€‚ç›¸åå½“æ£€æµ‹åˆ°æ•´å‹æº¢å‡ºæ—¶ï¼ŒRust ä¼šè¿›è¡Œä¸€ç§è¢«ç§°ä¸ºäºŒè¿›åˆ¶è¡¥ç åŒ…è£¹ï¼ˆtwoâ€™s complement wrappingï¼‰çš„æ“ä½œã€‚ç®€è€Œè¨€ä¹‹ï¼Œå¤§äºè¯¥ç±»å‹æœ€å¤§å€¼çš„æ•°å€¼ä¼šè¢«â€œåŒ…è£¹â€æˆè¯¥ç±»å‹èƒ½å¤Ÿæ”¯æŒçš„å¯¹åº”æ•°å­—çš„æœ€å°å€¼ã€‚æ¯”å¦‚åœ¨ u8 çš„æƒ…å†µä¸‹ï¼Œ256 å˜æˆ 0ï¼Œ257 å˜æˆ 1ï¼Œä¾æ­¤ç±»æ¨ã€‚ç¨‹åºä¸ä¼š `panic`ï¼Œä½†æ˜¯è¯¥å˜é‡çš„å€¼å¯èƒ½ä¸æ˜¯ä½ æœŸæœ›çš„å€¼ã€‚ä¾èµ–æ•´å‹æº¢å‡ºåŒ…è£¹çš„è¡Œä¸ºä¸æ˜¯ä¸€ç§æ­£ç¡®çš„åšæ³•ã€‚

è¦æ˜¾å¼å¤„ç†æº¢å‡ºçš„å¯èƒ½æ€§ï¼Œå¯ä»¥ä½¿ç”¨æ ‡å‡†åº“é’ˆå¯¹åŸå§‹æ•°å­—ç±»å‹æä¾›çš„ä»¥ä¸‹ä¸€ç³»åˆ—æ–¹æ³•ï¼š

- ä½¿ç”¨ `wrapping_*` æ–¹æ³•åœ¨æ‰€æœ‰æ¨¡å¼ä¸‹è¿›è¡ŒåŒ…è£¹ï¼Œä¾‹å¦‚ wrapping_add
- å¦‚æœä½¿ç”¨ `checked_*` æ–¹æ³•æ—¶å‘ç”Ÿæº¢å‡ºï¼Œåˆ™è¿”å› None å€¼
- ä½¿ç”¨ `overflowing_*` æ–¹æ³•è¿”å›è¯¥å€¼å’Œä¸€ä¸ªæŒ‡ç¤ºæ˜¯å¦å­˜åœ¨æº¢å‡ºçš„å¸ƒå°”å€¼
- ä½¿ç”¨ `saturating_*` æ–¹æ³•ä½¿å€¼è¾¾åˆ°æœ€å°å€¼æˆ–æœ€å¤§å€¼

:::

### æµ®ç‚¹ç±»å‹

**æµ®ç‚¹æ•°**ï¼ˆfloating-point numberï¼‰æ˜¯å¸¦æœ‰å°æ•°ç‚¹çš„æ•°å­—ï¼Œåœ¨ Rust ä¸­æµ®ç‚¹ç±»å‹ï¼ˆç®€ç§°æµ®ç‚¹å‹ï¼‰æ•°å­—ä¹Ÿæœ‰ä¸¤ç§åŸºæœ¬ç±»å‹ã€‚Rust çš„æµ®ç‚¹å‹æ˜¯ `f32` å’Œ `f64`ï¼Œå®ƒä»¬çš„å¤§å°åˆ†åˆ«ä¸º `32` ä½å’Œ `64` ä½ã€‚é»˜è®¤æµ®ç‚¹ç±»å‹æ˜¯ `f64`ï¼Œå› ä¸ºåœ¨ç°ä»£çš„ CPU ä¸­å®ƒçš„é€Ÿåº¦ä¸ `f32` çš„å‡ ä¹ç›¸åŒï¼Œä½†ç²¾åº¦æ›´é«˜ã€‚**æ‰€æœ‰æµ®ç‚¹å‹éƒ½æ˜¯æœ‰ç¬¦å·çš„ã€‚**

ä¸‹é¢æ˜¯ä¸€ä¸ªæ¼”ç¤ºæµ®ç‚¹æ•°çš„ç¤ºä¾‹:

```rust
fn main() {
    let x = 2.0; // f64

    ley y: f32 = 3.0; // f32
}
```

æµ®ç‚¹æ•°æŒ‰ç…§ IEEE-754 æ ‡å‡†è¡¨ç¤ºã€‚`f32` ç±»å‹æ˜¯å•ç²¾åº¦æµ®ç‚¹å‹ï¼Œ`f64` ä¸ºåŒç²¾åº¦æµ®ç‚¹å‹ã€‚

### æ•°å­—è¿ç®—

Rust çš„æ‰€æœ‰æ•°å­—ç±»å‹éƒ½æ”¯æŒåŸºæœ¬æ•°å­¦è¿ç®—ï¼šåŠ æ³•ã€å‡æ³•ã€ä¹˜æ³•ã€é™¤æ³•å’Œå–æ¨¡è¿ç®—ã€‚**æ•´æ•°é™¤æ³•ä¼šå‘ä¸‹å–æ•´ã€‚**ä¸‹é¢ä»£ç æ¼”ç¤ºäº†å„ä½¿ç”¨ä¸€æ¡ let è¯­å¥æ¥è¯´æ˜ç›¸åº”æ•°å­—è¿ç®—çš„ç”¨æ³•ï¼š

```rust
fn main() {
    let sum = 5 + 10;

    let difference = 95.5 - 4.3;

    let product = 4 * 30;

    let quotient = 56.7 / 32.2;
    let floored = 2 / 3; // Results in 0

    let remainder = 43 % 5;

    println!(
        "sum: {}, difference: {}, product: {}, quotient: {}, floored: {}, remainder: {}",
        sum, difference, product, quotient, floored, remainder
    );
}
```

è¾“å‡º:

```
sum: 15, difference: 91.2, product: 120, quotient: 1.7608695652173911, floored: 0, remainder: 3
```

### å¸ƒå°”ç±»å‹

å’Œå¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€ä¸€æ ·ï¼ŒRust ä¸­çš„å¸ƒå°”ç±»å‹ä¹Ÿæœ‰ä¸¤ä¸ªå¯èƒ½çš„å€¼ï¼š`true` å’Œ `false`ã€‚å¸ƒå°”å€¼çš„å¤§å°ä¸º 1 ä¸ªå­—èŠ‚ã€‚Rust ä¸­çš„å¸ƒå°”ç±»å‹ä½¿ç”¨ `bool` å£°æ˜ã€‚ä¾‹å¦‚ï¼š

```rust
fn main() {
    let t = true;

    let f: bool = false;
}
```

### å­—ç¬¦ç±»å‹

Rust çš„ `char`ï¼ˆå­—ç¬¦ï¼‰ç±»å‹æ˜¯è¯¥è¯­è¨€æœ€åŸºæœ¬çš„å­—æ¯ç±»å‹ï¼Œä¸‹é¢æ˜¯ä¸€äº›å£°æ˜ `char` å€¼çš„ä¾‹å­ï¼š

```rust
fn main() {
    let c = 'z';
    let z = 'â„¤';
    let heart_eyed_cat = 'ğŸ˜»';
    println!("c: {}, z: {}, heart_eyed_cat: {}", c, z, heart_eyed_cat);
}
```

è¾“å‡º:

```
country: z, province: â„¤, heart_eyed_cat: ğŸ˜»
```

:::caution
æ³¨æ„ï¼Œæˆ‘ä»¬å£°æ˜çš„ `char` å­—é¢é‡é‡‡ç”¨å•å¼•å·æ‹¬èµ·æ¥ [åŒå¼•å·ä¹Ÿå¯ä»¥]ï¼Œè¿™ä¸ **å­—ç¬¦ä¸²** å­—é¢é‡ä¸åŒï¼Œå­—ç¬¦ä¸²å­—é¢é‡æ˜¯ç”¨åŒå¼•å·æ‹¬èµ·æ¥ã€‚Rust çš„å­—ç¬¦ç±»å‹å¤§å°ä¸º 4 ä¸ªå­—èŠ‚ï¼Œè¡¨ç¤ºçš„æ˜¯ä¸€ä¸ª Unicode æ ‡é‡å€¼ï¼Œè¿™æ„å‘³ç€å®ƒå¯ä»¥è¡¨ç¤ºçš„è¿œè¿œä¸æ­¢æ˜¯ ASCIIã€‚æ ‡éŸ³å­—æ¯ï¼Œä¸­æ–‡/æ—¥æ–‡/éŸ©æ–‡çš„æ–‡å­—ï¼Œemojiï¼Œè¿˜æœ‰é›¶å®½ç©ºæ ¼(zero width space)åœ¨ Rust ä¸­éƒ½æ˜¯åˆæ³•çš„å­—ç¬¦ç±»å‹ã€‚Unicode å€¼çš„èŒƒå›´ä¸º `U+0000 ~ U+D7FF` å’Œ `U+E000~U+10FFFF`ã€‚ä¸è¿‡â€œå­—ç¬¦â€å¹¶ä¸æ˜¯ Unicode ä¸­çš„ä¸€ä¸ªæ¦‚å¿µï¼Œæ‰€ä»¥äººåœ¨ç›´è§‰ä¸Šå¯¹â€œå­—ç¬¦â€çš„ç†è§£å’Œ Rust çš„å­—ç¬¦æ¦‚å¿µå¹¶ä¸ä¸€è‡´ã€‚
:::

å­—ç¬¦ä¸²ç¤ºä¾‹:

```rust
fn main() {
    let country = "China";
    let province = "Hubei";
    let heart_eyed_cat = "ğŸ˜»";

    println!(
        "country: {}, province: {}, heart_eyed_cat: {}",
        country, province, heart_eyed_cat
    );
}
```

è¾“å‡º:

```
country: China, province: Hubei, heart_eyed_cat: ğŸ˜»
```

:::caution

å­—ç¬¦ä¸²å¸¸é‡åªèƒ½ä½¿ç”¨åŒå¼•å·`"`åŒ…è£¹ï¼Œä¸èƒ½ç”¨å•å¼•å·`'`åŒ…è£¹ï¼Œå¦åˆ™ Rust ç¼–è¯‘å™¨ä¼šæŠ¥é”™ã€‚

```
error: character literal may only contain one codepoint
 --> src\main.rs:2:19
  |
2 |     let country = 'China';
  |                   ^^^^^^^
  |
help: if you meant to write a `str` literal, use double quotes
  |
2 |     let country = "China";
  |                   ~~~~~~~
error: character literal may only contain one codepoint
 --> src\main.rs:3:20
  |
3 |     let province = 'Hubei';
  |                    ^^^^^^^
  |
help: if you meant to write a `str` literal, use double quotes
  |
3 |     let province = "Hubei";
  |                    ~~~~~~~

error: could not compile `guessing` (bin "guessing") due to 2 previous errors
```

ä¸Šè¿°æç¤ºä¸­ `if you meant to write a 'str' literal, use double quotes` å·²ç»ç»™å‡ºäº†å¾ˆæ˜ç¡®çš„æç¤ºäº† `å¦‚æœä½ æƒ³å†™ä¸€ä¸ª' str 'å­—é¢å€¼ï¼Œè¯·ä½¿ç”¨åŒå¼•å·`ï¼Œå¹¶ç»™å‡ºäº†æ­£ç¡®çš„æ ¼å¼ã€‚

:::

## å¤åˆç±»å‹

**å¤åˆç±»å‹**ï¼ˆcompound typeï¼‰å¯ä»¥å°†å¤šä¸ªå€¼ç»„åˆæˆä¸€ä¸ªç±»å‹ã€‚Rust æœ‰ä¸¤ç§åŸºæœ¬çš„å¤åˆç±»å‹ï¼šå…ƒç»„ï¼ˆtupleï¼‰å’Œæ•°ç»„ï¼ˆarrayï¼‰ã€‚

### å…ƒç»„ç±»å‹

å…ƒç»„æ˜¯å°†å¤šç§ç±»å‹çš„å¤šä¸ªå€¼ç»„åˆåˆ°ä¸€ä¸ªå¤åˆç±»å‹ä¸­çš„ä¸€ç§åŸºæœ¬æ–¹å¼ã€‚å…ƒç»„çš„é•¿åº¦æ˜¯å›ºå®šçš„ï¼šå£°æ˜åï¼Œå®ƒä»¬å°±æ— æ³•å¢é•¿æˆ–ç¼©å°ã€‚

æˆ‘ä»¬é€šè¿‡åœ¨å°æ‹¬å·å†…å†™å…¥ä»¥é€—å·åˆ†éš”çš„å€¼åˆ—è¡¨æ¥åˆ›å»ºä¸€ä¸ªå…ƒç»„ã€‚å…ƒç»„ä¸­çš„æ¯ä¸ªä½ç½®éƒ½æœ‰ä¸€ä¸ªç±»å‹ï¼Œå¹¶ä¸”å…ƒç»„ä¸­ä¸åŒå€¼çš„ç±»å‹ä¸è¦æ±‚æ˜¯ç›¸åŒçš„ã€‚æˆ‘ä»¬åœ¨ä¸‹é¢ç¤ºä¾‹ä¸­æ·»åŠ äº†å¯é€‰çš„ç±»å‹æ ‡æ³¨ï¼š

```rust
fn main() {
    let tup: (i32, f64, u8) = (500, 6.4, 1);
}
```

å˜é‡ tup ç»‘å®šåˆ°æ•´ä¸ªå…ƒç»„ï¼Œå› ä¸ºå…ƒç»„è¢«è®¤ä½œæ˜¯å•ä¸ªå¤åˆå…ƒç´ ã€‚ æƒ³ä»å…ƒç»„ä¸­è·å–ä¸ªåˆ«å€¼ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ¨¡å¼åŒ¹é…æ¥è§£æ„ï¼ˆdestructureï¼‰å…ƒç»„çš„ä¸€ä¸ªå€¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```rust
fn main() {
    let tup: (i32, f64, u8) = (500, 6.4, 1);
    let (x, y, z) = tup;
    println!("The value of tup is: ({}, {}, {})", x, y, z);
}
```

è¾“å‡º:

```
The value of tup is: (500, 6.4, 1)
```

è¯¥ç¨‹åºé¦–å…ˆåˆ›å»ºä¸€ä¸ªå…ƒç»„å¹¶å°†å…¶ç»‘å®šåˆ°å˜é‡ tup ä¸Šã€‚ ç„¶åå®ƒå€ŸåŠ© let æ¥ä½¿ç”¨ä¸€ä¸ªæ¨¡å¼åŒ¹é… tupï¼Œå¹¶å°†å®ƒåˆ†è§£æˆä¸‰ä¸ªå•ç‹¬çš„å˜é‡ xã€y å’Œ zã€‚ è¿™è¿‡ç¨‹ç§°ä¸ºè§£æ„ï¼ˆdestructuringï¼‰ï¼Œå› ä¸ºå®ƒå°†å•ä¸ªå…ƒç»„åˆ†ä¸ºä¸‰éƒ¨åˆ†ã€‚æœ€åï¼Œç¨‹åºæ‰“å°å‡º y å€¼ï¼Œä¸º 6.4ã€‚

é™¤äº†é€šè¿‡æ¨¡å¼åŒ¹é…è¿›è¡Œè§£æ„å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå¥ç‚¹ï¼ˆ.ï¼‰è¿ä¸Šè¦è®¿é—®çš„å€¼çš„ç´¢å¼•æ¥ç›´æ¥è®¿é—®å…ƒç»„å…ƒç´ ã€‚ä¾‹å¦‚ï¼š

```rust
fn main() {
    let tup: (i32, f64, u8) = (500, 6.4, 1);
    println!("The value of tup is: ({}, {}, {})", tup.0, tup.1, tup.2);
}
```

è¾“å‡º:

```
The value of tup is: (500, 6.4, 1)
```

å’Œå¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€ä¸€æ ·ï¼Œå…ƒç»„ä¸­çš„ç¬¬ä¸€ä¸ªç´¢å¼•ä¸º 0ã€‚

æ²¡æœ‰ä»»ä½•å€¼çš„å…ƒç»„ () æ˜¯ä¸€ç§ç‰¹æ®Šçš„ç±»å‹ï¼Œåªæœ‰ä¸€ä¸ªå€¼ï¼Œä¹Ÿå†™æˆ ()ã€‚è¯¥ç±»å‹è¢«ç§°ä¸ºå•å…ƒç±»å‹ï¼ˆunit typeï¼‰ï¼Œè¯¥å€¼è¢«ç§°ä¸ºå•å…ƒå€¼ï¼ˆunit valueï¼‰ã€‚å¦‚æœè¡¨è¾¾å¼ä¸è¿”å›ä»»ä½•å…¶ä»–å€¼ï¼Œå°±éšå¼åœ°è¿”å›å•å…ƒå€¼ã€‚

### æ•°ç»„ç±»å‹

å°†å¤šä¸ªå€¼ç»„åˆåœ¨ä¸€èµ·çš„å¦ä¸€ç§æ–¹å¼å°±æ˜¯ä½¿ç”¨æ•°ç»„ï¼ˆarrayï¼‰ã€‚ä¸å…ƒç»„ä¸åŒï¼Œæ•°ç»„çš„æ¯ä¸ªå…ƒç´ å¿…é¡»å…·æœ‰ç›¸åŒçš„ç±»å‹ã€‚ä¸æŸäº›å…¶ä»–è¯­è¨€ä¸­çš„æ•°ç»„ä¸åŒï¼ŒRust ä¸­çš„æ•°ç»„å…·æœ‰å›ºå®šé•¿åº¦ã€‚

æˆ‘ä»¬åœ¨æ–¹æ‹¬å·å†…ä»¥é€—å·åˆ†éš”çš„åˆ—è¡¨å½¢å¼å°†å€¼å†™åˆ°æ•°ç»„ä¸­ï¼š

```rust
fn main() {
    let a = [1, 2, 3, 4, 5];
}
```

å½“ä½ å¸Œæœ›å°†æ•°æ®åˆ†é…åˆ°æ ˆï¼ˆstackï¼‰è€Œä¸æ˜¯å †ï¼ˆheapï¼‰æ—¶ï¼Œæˆ–è€…å½“ä½ å¸Œæœ›ç¡®ä¿å§‹ç»ˆå…·æœ‰å›ºå®šæ•°é‡çš„å…ƒç´ æ—¶ï¼Œæ•°ç»„ç‰¹åˆ«æœ‰ç”¨ã€‚ä½†å®ƒä»¬ä¸åƒ vectorï¼ˆè¯‘æ³¨ï¼šä¸­æ–‡å­—é¢ç¿»è¯‘ä¸ºâ€œå‘é‡â€ï¼Œåœ¨ Rust ä¸­æ„ä¹‰ä¸ºâ€œåŠ¨æ€æ•°ç»„ï¼Œå¯å˜æ•°ç»„â€ï¼‰ç±»å‹é‚£ä¹ˆçµæ´»ã€‚vector ç±»å‹ç±»ä¼¼äºæ ‡å‡†åº“ä¸­æä¾›çš„é›†åˆç±»å‹ï¼Œå…¶å¤§å°å…è®¸å¢é•¿æˆ–ç¼©å°ã€‚å¦‚æœä¸ç¡®å®šæ˜¯ä½¿ç”¨æ•°ç»„è¿˜æ˜¯ vectorï¼Œé‚£å°±åº”è¯¥ä½¿ç”¨ä¸€ä¸ª vectorã€‚

ä¸è¿‡å½“ä½ æ˜ç¡®å…ƒç´ æ•°é‡ä¸éœ€è¦æ”¹å˜æ—¶ï¼Œæ•°ç»„ä¼šæ›´æœ‰ç”¨ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ åœ¨ç¨‹åºä¸­ä½¿ç”¨æœˆä»½çš„åç§°ï¼Œä½ å¾ˆå¯èƒ½å¸Œæœ›ä½¿ç”¨çš„æ˜¯æ•°ç»„è€Œä¸æ˜¯ vectorï¼Œå› ä¸ºä½ çŸ¥é“å®ƒå§‹ç»ˆåŒ…å« 12 ä¸ªå…ƒç´ ï¼š

```rust
let months = ["January", "February", "March", "April", "May", "June", "July",
              "August", "September", "October", "November", "December"];
```

ä½¿ç”¨æ–¹æ‹¬å·ç¼–å†™æ•°ç»„çš„ç±»å‹ï¼Œå…¶ä¸­åŒ…å«æ¯ä¸ªå…ƒç´ çš„ç±»å‹ã€åˆ†å·ï¼Œç„¶åæ˜¯æ•°ç»„ä¸­çš„å…ƒç´ æ•°ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```rust
let a: [i32; 5] = [1, 2, 3, 4, 5];
```

è¿™é‡Œï¼Œ`i32` æ˜¯æ¯ä¸ªå…ƒç´ çš„ç±»å‹ã€‚åˆ†å·ä¹‹åï¼Œæ•°å­— `5` è¡¨æ˜è¯¥æ•°ç»„åŒ…å« 5 ä¸ªå…ƒç´ ã€‚

ä»¥è¿™ç§æ–¹å¼ç¼–å†™æ•°ç»„çš„ç±»å‹çœ‹èµ·æ¥ç±»ä¼¼äºåˆå§‹åŒ–æ•°ç»„çš„å¦ä¸€ç§è¯­æ³•ï¼šå¦‚æœè¦ä¸ºæ¯ä¸ªå…ƒç´ åˆ›å»ºåŒ…å«ç›¸åŒå€¼çš„æ•°ç»„ï¼Œå¯ä»¥æŒ‡å®šåˆå§‹å€¼ï¼Œåè·Ÿåˆ†å·ï¼Œç„¶ååœ¨æ–¹æ‹¬å·ä¸­æŒ‡å®šæ•°ç»„çš„é•¿åº¦ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```rust
fn main() {
    let a: [i32; 5] = [3; 5];
    println!(
        "The value of a is: [{}, {}, {}, {}, {}]",
        a[0], a[1], a[2], a[3], a[4]
    );
}
```

å˜é‡åä¸º `a` çš„æ•°ç»„å°†åŒ…å« `5` ä¸ªå…ƒç´ ï¼Œè¿™äº›å…ƒç´ çš„å€¼åˆå§‹åŒ–ä¸º `3`ã€‚è¿™ç§å†™æ³•ä¸ `let a = [3, 3, 3, 3, 3];` æ•ˆæœç›¸åŒï¼Œä½†æ›´ç®€æ´ã€‚

:::caution

#### å…ƒç»„ç´¢å¼• vs æ•°ç»„ç´¢å¼•

```rust
fn main() {
    let a = [3; 5];
    println!(
        "The value of a is: [{}, {}, {}, {}, {}]",
        a.0, a.1, a.2, a.3, a.4
    );
}
```

å¦‚æœä¸Šè¿°æ•°ç»„ä½¿ç”¨çš„æ˜¯ç‚¹å·å¼•ç”¨æŒ‡å®šç´¢å¼•çš„æ•°æ®ï¼Œå°†ä¼šæŠ¥å¦‚ä¸‹é”™è¯¯:

```
error[E0609]: no field `0` on type `[{integer}; 5]`
 --> src\main.rs:5:11
  |
5 |         a.0, a.1, a.2, a.3, a.4
  |         --^
  |         |
  |         help: instead of using tuple indexing, use array indexing: `a[0]`

error[E0609]: no field `1` on type `[{integer}; 5]`
 --> src\main.rs:5:16
  |
5 |         a.0, a.1, a.2, a.3, a.4
  |              --^
  |              |
  |              help: instead of using tuple indexing, use array indexing: `a[1]`

error[E0609]: no field `2` on type `[{integer}; 5]`
 --> src\main.rs:5:21
  |
5 |         a.0, a.1, a.2, a.3, a.4
  |                   --^
  |                   |
  |                   help: instead of using tuple indexing, use array indexing: `a[2]`

error[E0609]: no field `3` on type `[{integer}; 5]`
 --> src\main.rs:5:26
  |
5 |         a.0, a.1, a.2, a.3, a.4
  |                        |
  |                        help: instead of using tuple indexing, use array indexing: `a[3]`

error[E0609]: no field `4` on type `[{integer}; 5]`
 --> src\main.rs:5:31
  |
5 |         a.0, a.1, a.2, a.3, a.4
  |                             --^
  |                             |
  |                             help: instead of using tuple indexing, use array indexing: `a[4]`

For more information about this error, try `rustc --explain E0609`.
error: could not compile `guessing` (bin "guessing") due to 5 previous errors
```

å¸®åŠ©æç¤ºç»™çš„ä¹Ÿå¾ˆæ¸…æ™°ï¼Œæç¤ºæˆ‘ä»¬ä½¿ç”¨æ•°ç»„ç´¢å¼• `a[0]` æ›¿æ¢å…ƒç»„ç´¢å¼• `a.0`ã€‚

:::

#### è®¿é—®æ•°ç»„å…ƒç´ 

æ•°ç»„æ˜¯å¯ä»¥åœ¨æ ˆä¸Šåˆ†é…çš„å·²çŸ¥å›ºå®šå¤§å°çš„å•ä¸ªå†…å­˜å—ã€‚å¯ä»¥ä½¿ç”¨ç´¢å¼•è®¿é—®æ•°ç»„çš„å…ƒç´ ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```rust
fn main() {
    let a = [1, 2, 3, 4, 5];

    let first = a[0];
    let second = a[1];
}
```

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œåä¸º `first` çš„å˜é‡å°†è·å¾—å€¼ `1`ï¼Œå› ä¸ºå®ƒæ˜¯æ•°ç»„ä¸­ç´¢å¼• `[0]` å¤„çš„å€¼ã€‚åä¸º second çš„å˜é‡å°†ä»æ•°ç»„ä¸­çš„ç´¢å¼• `[1]` ä¸­è·å–å¾— `2`ã€‚

#### æ— æ•ˆçš„æ•°ç»„å…ƒç´ è®¿é—®

```rust
use std::io;

fn main() {
    let a = [1, 3, 5, 7, 9];
    println!("Please enter an array index.");
    let mut index = String::new();

    io::stdin()
        .read_line(&mut index)
        .expect("Failed to read line");
    let index: usize = index
        .trim()
        .parse()
        .expect("Index entered was not a number");

    let element = a[index];
    println!(
        "The value of the element at index {} is: {}",
        index, element
    );
}
```

æ­¤ä»£ç ç¼–è¯‘æˆåŠŸã€‚å¦‚æœä½¿ç”¨ cargo run æ¥è¿è¡Œæ­¤ä»£ç å¹¶è¾“å…¥ 0ã€1ã€2ã€3 æˆ– 4ï¼Œåˆ™ç¨‹åºå°†æ‰“å°æ•°ç»„å¯¹åº”ç´¢å¼•çš„å€¼ã€‚å¦‚æœè¾“å…¥çš„æ˜¯è¶…å‡ºæ•°ç»„æœ«å°¾çš„æ•°å­—ï¼Œä¾‹å¦‚ 5ï¼Œåˆ™ä¼šçœ‹åˆ°ç±»ä¼¼ä»¥ä¸‹çš„è¾“å‡ºï¼š

```
    Finished dev [unoptimized + debuginfo] target(s) in 0.02s
     Running `target\debug\guessing.exe`
Please enter an array index.
5
thread 'main' panicked at 'index out of bounds: the len is 5 but the index is 5', src\main.rs:16:19
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
error: process didn't exit successfully: `target\debug\guessing.exe` (exit code: 101)
```

è¯¥ç¨‹åºåœ¨ç´¢å¼•æ“ä½œä¸­ä½¿ç”¨æ— æ•ˆå€¼æ—¶å¯¼è‡´**è¿è¡Œæ—¶**ï¼ˆruntimeï¼‰é”™è¯¯ã€‚ç¨‹åºé€€å‡ºå¹¶æ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯ï¼Œæœªæ‰§è¡Œåé¢çš„ println! è¯­å¥ã€‚å½“ä½ å°è¯•ä½¿ç”¨ç´¢å¼•è®¿é—®å…ƒç´ æ—¶ï¼ŒRust å°†æ£€æŸ¥ä½ æŒ‡å®šçš„ç´¢å¼•æ˜¯å¦å°äºæ•°ç»„é•¿åº¦ã€‚å¦‚æœç´¢å¼•å¤§äºæˆ–ç­‰äºæ•°ç»„é•¿åº¦ï¼ŒRust ä¼šå‡ºç° `panic`ã€‚è¿™ç§æ£€æŸ¥å¿…é¡»åœ¨è¿è¡Œæ—¶è¿›è¡Œï¼Œå°¤å…¶æ˜¯åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå› ä¸ºç¼–è¯‘å™¨å¯èƒ½æ— æ³•çŸ¥é“ç”¨æˆ·ä¹‹åè¿è¡Œä»£ç æ—¶å°†è¾“å…¥ä»€ä¹ˆå€¼ã€‚

è¿™æ˜¯ Rust åœ¨å®‰å…¨åŸåˆ™å®è·µä¸­çš„ç¬¬ä¸€ä¸ªä¾‹å­ã€‚åœ¨å¾ˆå¤šä½çº§è¯­è¨€ä¸­ï¼Œå¹¶ä¸è¿›è¡Œè¿™ç§æ£€æŸ¥ï¼Œè€Œä¸”åœ¨ä½ ä½¿ç”¨ä¸æ­£ç¡®çš„ç´¢å¼•æ—¶ï¼Œå¯ä»¥è®¿é—®æ— æ•ˆçš„å†…å­˜ã€‚Rust é€šè¿‡ç«‹å³é€€å‡ºæ¥çš„æ–¹å¼é˜²æ­¢è¿™ç§é”™è¯¯ï¼Œè€Œä¸æ˜¯å…è®¸å†…å­˜è®¿é—®å¹¶ç»§ç»­è¿è¡Œç¨‹åºã€‚
